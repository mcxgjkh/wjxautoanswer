# 问卷星自动答题器

![版本](https://img.shields.io/badge/版本-8.0.1-blue)
![许可证](https://img.shields.io/badge/许可证-AGPLv3-green)

**问卷星自动答题器** 是一款基于 Electron 的跨平台桌面应用程序，专为问卷星平台（也兼容其他的）设计，提供智能题库管理、题目文本匹配、图片URL识别、正确率控制及多档速度调节等功能。本项目仅用于学习研究，请勿用于非法用途。

---

## 📋 功能特性

- ✅ **题库管理**  
  - 创建、编辑、删除题库（支持自定义基础信息题数、起始题号）  
  - 批量导入/导出题库（JSON / CSV 格式）  
  - 自动容量扩展（每100行扩展一次，最大1000题）  

- ✅ **智能题目匹配**  
  - **传统题号匹配**：根据元素ID定位题目  
  - **题目文本匹配**：通过题目内容自动映射到对应题号，从主题库获取答案（支持包含匹配、模糊匹配）  
  - **图片URL匹配**：自动识别题目中的图片，与答案库中的URL进行匹配  

- ✅ **正确率控制（去一法）**  
  - 设定目标正确率（0%~100%）  
  - 自动计算需要正确的题数，故意答错多余题目  

- ✅ **多档答题速度**  
  - 刘子轩速度（5秒）、极速、快速、标准、适中、自然、慢速、极慢、随机  

- ✅ **链接历史记录**  
  - 自动保存访问过的问卷后缀，支持标题备注与快速选择  

- ✅ **Electron集成**  
  - 独立窗口加载问卷，自动注入答题脚本  
  - 快捷键支持（F12 / Ctrl+Shift+I 打开开发者工具）  
  - 跨平台（Windows / macOS / Linux）  

---

## 🛠 技术栈

- **Electron** 28.0.0+  
- **HTML5 / CSS3**  
- **Vanilla JavaScript**（无前端框架）  
- **electron-builder** 打包工具  

---

## 📦 安装与运行

### 前置要求

- [Node.js](https://nodejs.org/) **16.0 或更高版本**  
- npm（通常随Node.js一起安装）  

### 获取源码

```bash
git clone https://github.com/mcxgjkh/wjxautoanswer.git
cd wjxautoanswer
```
或者直接下载 ZIP 并解压。

### 安装依赖
```bash
npm install
```
注：项目中已使用 electron 和 electron-builder，若手动安装请执行：

```bash
npm install electron --save-dev
npm install electron-builder --save-dev
```
### 启动开发版本

```bash
npm start
```
该命令会启动主窗口 index.html，并开启开发者工具（若 NODE_ENV=development）。

## 🔨 构建与打包
本项目使用 electron-builder 进行打包，支持 Windows平台。

### Windows 打包
执行根目录下的 build.bat 脚本：

```batch
build.bat
```
打包后的可执行文件及安装包将生成在 dist/ 目录下。

## 📖 使用说明
### 1. 配置问卷
在“问卷配置”中输入问卷链接后缀（如 wRSroLM.aspx）

可从历史记录中快速选择已保存的链接

### 2. 管理题库
主题库：存储题目答案（支持多答案格式，自动添加字母选项）

题目匹配库：存储题目文本，用于定位题号（答案从主题库获取）

创建/编辑题库
填写题库名称、描述

设置“基础信息填写题数”（如姓名、班级）及“起始题目编号”

在编辑区逐行输入答案（主题库）或题目文本（匹配库）

保存后自动存储至浏览器本地存储（localStorage）

导入/导出
支持 JSON 格式导入导出

导出时可选择 CSV 格式，便于 Excel 编辑

### 3. 设置答题参数
正确率：通过滑块调整期望的正确百分比

速度：选择预定义的速度档位

### 4. 启动答题
点击 “打开问卷页面”，程序将自动加载目标问卷并注入脚本

待页面加载完成后，点击问卷窗口右下角的 “开始答题” 按钮

答题过程中实时显示进度，完成后弹出确认提交对话框

## ⚖️ 许可证
本项目遵循 GNU Affero General Public License v3.0 (AGPL-3.0)。

您可以在遵守以下条款的前提下自由使用、修改和分发本软件：

必须公开源代码：若您通过网络提供本软件的服务（包括但不限于 SaaS、Web 服务），必须向所有用户公开完整的、修改后的源代码。

保留版权声明：不得移除或修改文件中的版权与许可证声明。

相同方式共享：衍生作品必须同样采用 AGPL-3.0 许可证。

完整的许可证文本请参见项目根目录下的 LICENSE 文件，或访问 https://www.gnu.org/licenses/agpl-3.0.html。

## 🤝 贡献指南
欢迎提交 Issue 和 Pull Request。

Fork 本仓库

创建您的特性分支 (git checkout -b feature/AmazingFeature)

提交您的修改 (git commit -m 'Add some AmazingFeature')

推送到分支 (git push origin feature/AmazingFeature)

打开 Pull Request

请确保代码风格与现有项目保持一致，并在提交前充分测试。

## 📮 联系与支持
作者：MCXGJKH

项目主页：https://github.com/mcxgjkh/wjxautoanswer/

如有问题，请通过 GitHub Issues 反馈

注意：本程序仅用于学习和研究，请勿将其用于任何违反问卷星用户协议或法律法规的行为。开发者不承担任何因非法使用导致的责任。

# 更新日志

所有对本项目的显著修改都将记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，  
版本号遵循 [语义化版本 2.0.0](https://semver.org/lang/zh-CN/)。

---

## [8.0.1] - 2026-02-12

### ✨ 新增

- **题目文本匹配独立模块**  
  - 完全复用主题库管理逻辑，支持增、删、改、查、导入/导出  
  - 存储结构：`{ name, description, basicInfoCount, startQuestionNum, answers }`，其中 `answers` 键为题号，值为单元素数组（题目文本）  
  - 编辑器支持基础信息题数及起始编号设置，基础信息答案可单独填写（仅作记录）  
  - 预览区域显示统计信息及前8条题目文本  

- **默认题库保护**  
  - 首次运行或无本地存储时自动创建默认题库（`2026理化生实验操作模拟考试-化学题库`）  
  - 默认题库不可删除，与主题库行为一致  

- **复选框智能状态管理**  
  - 无题库时自动禁用“启用题目匹配”复选框并强制取消勾选  
  - 有题库时恢复启用，默认始终为未勾选状态（不记忆历史开启状态）  
  - 复选框状态与 `window.matchEnabled` 全局变量严格同步  

- **构建脚本**  
  - 新增 `build.bat`，支持一键打包 Windows x64 可执行程序  

### 🔧 修复

- **Electron 主进程注入**  
  - 将 `matchEnabled` 和 `matchBank` 正确注入问卷窗口的 `window` 对象，解决配置未传递问题  

- **答题机器人匹配逻辑**  
  - 修正 `matchQuestionText` 返回值为**题号**而非答案文本  
  - 题目文本匹配成功后**立即返回**，不再执行传统题号匹配，防止覆盖错误答案  
  - 增强文本清理：移除题号、题型标识、括号内容等，提高匹配率  

- **题库导入**  
  - 移除 Electron 原生对话框导入逻辑，统一使用纯前端文件选择器，导入成功率 100%  
  - 导入后自动更新复选框状态  

- **模态框关闭**  
  - 删除重复的 `matchBankInfoModal` 定义，修复点“✕”无法关闭的问题  

- **新建题库默认值**  
  - 基础信息题数默认显示 `2`，起始编号默认显示 `3`（与主题库一致）  

### 🎨 优化

- **统一配色**  
  - 题目匹配库预览条目左边框色改为主题库蓝色（`#667eea`）  
  - 编辑器提示文字改为蓝色系，与整体风格协调  

- **删除确认**  
  - 删除最后一个题库时弹出明确警告，禁止删除  
  - 无题库时点击删除按钮直接提示“没有题目匹配库可删除”  

- **性能**  
  - 优化题库存储结构，减少序列化开销  
  - 答题循环中避免重复查询 DOM，提升执行效率  

---

## [8.0.0] - 2026-01-28

### ✨ 新增

- 重构题库管理模块，支持多题库切换与本地存储  
- 增加图片URL匹配功能  
- 添加正确率控制（去一法）  
- 集成 Electron，实现独立窗口加载问卷  

### 🔧 修复

- 修复基础信息题无法自动填写的问题  
- 修复极端速度下选项点击可能失效的问题  

### 🎨 优化

- 全面升级 UI 至毛玻璃设计  
- 优化历史记录交互，支持标题备注与快速选择  

---

## [7.4.1] - 2026-01-15

### ✨ 新增

- 支持主题库管理、传统题号匹配、速度选择  
- 基础 Electron 窗口通信  

---

[8.0.1]: https://github.com/mcxgjkh/wjxautoanswer/releases/tag/V8.0.1