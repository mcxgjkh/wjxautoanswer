<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é—®å·æ˜Ÿè‡ªåŠ¨ç­”é¢˜å™¨ V8.0.2</title>
    <style>
        /* ç¾åŒ–æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 5px;
            border: 2px solid rgba(0, 0, 0, 0.3);
        }
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            border: 2px solid rgba(0, 0, 0, 0.5);
        }
        ::-webkit-scrollbar-corner {
            background: rgba(0, 0, 0, 0.3);
        }
        .status-panel::-webkit-scrollbar-track,
        .bank-preview::-webkit-scrollbar-track,
        .bank-editor textarea::-webkit-scrollbar-track,
        .modal-body::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 1200px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 36px;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .header .subtitle {
            color: #8a8aff;
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .header .version {
            color: #666;
            font-size: 14px;
        }
        
        .config-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .config-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 25px;
        }
        
        .config-section h2 {
            font-size: 24px;
            margin-bottom: 20px;
            color: #8a8aff;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .config-section h2 i {
            font-size: 20px;
        }
        
        /* é—®å·é“¾æ¥è¾“å…¥æ ·å¼ */
        .url-input {
            margin-bottom: 20px;
        }
        .url-prefix {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            color: #ccc;
            font-size: 14px;
        }
        .url-prefix .prefix {
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 10px;
            border-radius: 5px;
            margin-right: 10px;
            font-family: 'Consolas', monospace;
        }
        .url-input-field {
            display: flex;
            gap: 10px;
        }
        .url-input-field input {
            flex: 1;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            font-family: 'Consolas', monospace;
        }
        .url-input-field input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        /* é“¾æ¥å†å²æŒ‰é’®æ ·å¼ */
        .history-btn {
            background: linear-gradient(135deg, #2196F3 0%, #0D47A1 100%);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 15px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            transition: all 0.3s ease;
        }
        .history-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.3);
        }
        .history-btn:active {
            transform: translateY(0);
        }
        
        /* å†å²è®°å½•æ¨¡æ€æ¡†æ ·å¼ */
        .history-modal .modal-content {
            max-width: 700px;
        }
        .history-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        .history-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        .history-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(102, 126, 234, 0.3);
        }
        .history-item.selected {
            background: rgba(102, 126, 234, 0.15);
            border-color: #667eea;
        }
        .history-info {
            flex: 1;
            margin-right: 15px;
        }
        .history-title {
            font-weight: bold;
            font-size: 16px;
            color: #8a8aff;
            margin-bottom: 5px;
        }
        .history-url {
            font-family: 'Consolas', monospace;
            font-size: 12px;
            color: #aaa;
            word-break: break-all;
        }
        .history-date {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        .history-actions {
            display: flex;
            gap: 8px;
        }
        .history-action-btn {
            background: none;
            border: none;
            color: #ccc;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.2s ease;
        }
        .history-action-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        .history-action-btn.delete:hover {
            color: #f44336;
        }
        .history-action-btn.select:hover {
            color: #4CAF50;
        }
        .history-empty {
            text-align: center;
            padding: 30px;
            color: #666;
            font-size: 16px;
        }
        .history-empty i {
            font-size: 48px;
            margin-bottom: 15px;
            display: block;
        }
        
        /* æ­£ç¡®ç‡æ§åˆ¶æ ·å¼ */
        .accuracy-control {
            margin-bottom: 20px;
        }
        .accuracy-slider-container {
            position: relative;
            margin: 20px 0;
        }
        .accuracy-slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            outline: none;
        }
        .accuracy-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.8);
        }
        .accuracy-ticks {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 12px;
            color: #ccc;
        }
        .accuracy-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        .accuracy-value {
            font-size: 28px;
            font-weight: bold;
            color: #667eea;
            text-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }
        .accuracy-info {
            color: #ccc;
            font-size: 12px;
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
        }
        
        /* é¢˜åº“ç®¡ç†æ ·å¼ï¼ˆå…¬ç”¨ï¼‰ */
        .bank-manager {
            margin-bottom: 20px;
        }
        .bank-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        .bank-select {
            flex: 1;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 14px;
        }
        .bank-select option {
            background: #1a1a2e;
            color: white;
        }
        .bank-buttons {
            display: flex;
            gap: 10px;
        }
        .bank-btn {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background-color: transparent;
            border: none;
            font-size: 22px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        .bank-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px 2px rgba(33, 118, 255, 0.4);
        }
        .bank-btn.edit {
            width: 39px;
            height: 39px;
            background-color: #296f3e;
        }
        .bank-btn.edit svg {
            width: 24px;
            height: 24px;
            transition: transform 0.3s ease;
        }
        .bank-btn.import {
            width: 39px;
            height: 39px;
            background-color: #603189;
        }
        .bank-btn.import svg {
            width: 24px;
            height: 24px;
        }
        .bank-btn.export {
            width: 39px;
            height: 39px;
            background-color: #98b64b;
        }
        .bank-btn.export svg {
            width: 24px;
            height: 24px;
        }
        .bank-btn.delete:hover {
            box-shadow: 0 5px 15px 2px rgba(244, 67, 54, 0.4);
        }
        .bank-btn.edit:hover {
            box-shadow: 0 5px 15px 2px rgba(33, 150, 243, 0.4);
        }
        .bank-btn.info {
            width: 24px;
            height: 24px;
            font-size: 16px;
        }
        .bank-preview {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .bank-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .bank-stats {
            color: #8a8aff;
            font-size: 14px;
        }
        .bank-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }
        .bank-item {
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            font-size: 13px;
            font-family: 'Consolas', monospace;
            border-left: 3px solid #667eea;
            word-break: break-word;
        }
        
        /* é€Ÿåº¦é€‰æ‹©æ ·å¼ */
        .speed-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .speed-option {
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        .speed-option:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            background: rgba(102, 126, 234, 0.1);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }
        .speed-option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }
        .speed-name {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 5px;
        }
        .speed-desc {
            font-size: 12px;
            opacity: 0.8;
        }
        
        /* æ¨¡æ€æ¡†é€šç”¨æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 1000px;
            max-height: 85vh;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .modal-header h3 {
            color: #8a8aff;
            font-size: 22px;
        }
        .close-modal {
            background: none;
            border: none;
            color: #ccc;
            font-size: 28px;
            cursor: pointer;
            transition: color 0.3s ease;
            padding: 0;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .close-modal:hover {
            color: #f44336;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
        }
        .modal-body {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        .bank-editor {
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        .bank-name-input {
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 16px;
        }
        .bank-name-input:focus {
            outline: none;
            border-color: #667eea;
        }
        .bank-description {
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            min-height: 60px;
            resize: vertical;
        }
        .bank-description:focus {
            outline: none;
            border-color: #667eea;
        }
        .bank-info-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        .info-input {
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 14px;
        }
        .info-input:focus {
            outline: none;
            border-color: #667eea;
        }
        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 300px;
        }
        .editor-container-basic {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 50px;
        }
        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            color: #ccc;
            font-size: 14px;
        }
        .editor-header span {
            background: rgba(255, 255, 255, 0.1);
            padding: 5px 10px;
            border-radius: 5px;
        }
        .bank-editor textarea {
            flex: 1;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: none;
        }
        .bank-editor textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        .editor-info {
            color: #ccc;
            font-size: 12px;
            margin-top: 10px;
            text-align: right;
        }
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 20px;
        }
        
        /* æ§åˆ¶é¢æ¿æ ·å¼ */
        .control-panel {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        .btn {
            flex: 1;
            padding: 18px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .btn-open {
            background: linear-gradient(135deg, #2196F3 0%, #0D47A1 100%);
            color: white;
        }
        .btn-open:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(33, 150, 243, 0.3);
        }
        .btn-start {
            background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%);
            color: white;
        }
        .btn-start:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(76, 175, 80, 0.3);
        }
        .btn-stop {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
            color: white;
        }
        .btn-stop:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(244, 67, 54, 0.3);
        }
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        /* çŠ¶æ€é¢æ¿æ ·å¼ */
        .status-panel {
            margin-top: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 20px;
            max-height: 200px;
            overflow-y: auto;
        }
        .status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .status-header h3 {
            color: #8a8aff;
            font-size: 18px;
        }
        .status-content {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.5;
        }
        .log {
            margin: 5px 0;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }
        .log.info { color: #2196F3; }
        .log.success { color: #4CAF50; }
        .log.warning { color: #FF9800; }
        .log.error { color: #f44336; }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #666;
            font-size: 12px;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ========== é¢˜ç›®åŒ¹é…ç‹¬ç«‹æ ·å¼ï¼ˆç»Ÿä¸€é…è‰²ï¼‰ ========== */
        .match-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255,255,255,0.05);
            padding: 8px 16px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .match-toggle:hover {
            background: rgba(102,126,234,0.15);
            border-color: #667eea;
        }
        .match-toggle input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: #667eea;
            margin: 0;
        }
        /* é¢„è§ˆæ¡ç›®è¾¹æ¡†é¢œè‰²æ”¹ä¸ºä¸ä¸»é¢˜åº“ä¸€è‡´çš„è“è‰² */
        #matchBankItems .bank-item {
            border-left-color: #667eea !important;
        }
        /* ç¼–è¾‘å™¨æç¤ºé¢œè‰²æ”¹ä¸ºè“è‰²ç³» */
        .match-editor-tip {
            color: #667eea;
            font-size: 12px;
            margin-top: 8px;
            background: rgba(102,126,234,0.1);
            padding: 8px 12px;
            border-radius: 6px;
        }
        /* ========== é¢˜ç›®åŒ¹é…ç‹¬ç«‹æ ·å¼ç»“æŸ ========== */
        
        @media (max-width: 1024px) {
            .config-panel { grid-template-columns: 1fr; }
            .bank-info-row { grid-template-columns: 1fr; }
        }
        @media (max-width: 768px) {
            .container { padding: 20px; }
            .speed-options { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); }
            .control-panel { flex-direction: column; }
            .header h1 { font-size: 28px; }
            .bank-buttons { flex-direction: row; flex-wrap: wrap; }
            .bank-btn svg { width: 44px; height: 44px; }
            .bank-btn:hover { transform: scale(1.1); box-shadow: 0 4px 12px 2px rgba(28, 92, 255, 0.3); }
            .bank-btn:active { transform: scale(0.95); }
            .bank-btn:hover svg { transform: scale(1.1); }
            .bank-btn.edit:hover { box-shadow: 0 5px 15px 2px rgba(33, 150, 243, 0.4); }
            .bank-btn.delete:hover { box-shadow: 0 5px 15px 2px rgba(244, 67, 54, 0.4); }
            .bank-items { grid-template-columns: 1fr; }
            .bank-btn.import:hover { box-shadow: 0 5px 15px rgba(46, 56, 255, 0.4); }
            .bank-btn.export:hover { box-shadow: 0 5px 15px rgba(49, 114, 254, 0.4); }
            .bank-btn.info { width: 32px; height: 32px; }
            .bank-btn.info:hover { box-shadow: 0 5px 15px rgba(96, 125, 139, 0.4); }
            .history-btn { padding: 10px 12px; font-size: 12px; }
            .history-item { flex-direction: column; align-items: flex-start; }
            .history-actions { margin-top: 10px; align-self: flex-end; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>é—®å·æ˜Ÿè‡ªåŠ¨ç­”é¢˜å™¨</h1>
            <div class="subtitle">V8.0.2 æ™ºèƒ½è¯†åˆ« | é¢˜åº“ç®¡ç†ç‰ˆ</div>
            <div class="version">Design By MCXGJKH</div>
        </div>
        
        <div class="config-panel">
            <!-- å·¦ä¾§ï¼šé—®å·é…ç½® + æ­£ç¡®ç‡æ§åˆ¶ -->
            <div class="config-section">
                <h2>ğŸ”— é—®å·é…ç½®</h2>
                <div class="url-input">
                    <div class="url-prefix">
                        <span class="prefix">https://ks.wjx.com/vm/</span>
                        <span style="color: #8a8aff; font-size: 12px; margin-left: auto;">é“¾æ¥å†å²: <span id="historyCount">0</span> æ¡</span>
                    </div>
                    <div class="url-input-field">
                        <input type="text" id="urlSuffix" placeholder="wRSroLM.aspx" value="wRSroLM.aspx">
                        <button class="history-btn" id="historyBtn" title="ç®¡ç†é“¾æ¥å†å²">
                            <span>ğŸ“‹ å†å²</span>
                        </button>
                    </div>
                    <div style="font-size: 12px; color: #666; margin-top: 5px;">
                        å½“å‰é“¾æ¥æ ‡é¢˜: <span id="currentUrlTitle">ç†åŒ–ç”Ÿæ¨¡æ‹Ÿ-åŒ–å­¦</span>
                    </div>
                </div>
                
                <h2>âœ”ï¸ æ­£ç¡®ç‡æ§åˆ¶</h2>
                <div class="accuracy-control">
                    <div class="accuracy-slider-container">
                        <input type="range" min="0" max="100" value="100" class="accuracy-slider" id="accuracySlider">
                        <div class="accuracy-ticks">
                            <span>0%</span><span>25%</span><span>50%</span><span>75%</span><span>100%</span>
                        </div>
                    </div>
                    <div class="accuracy-display">
                        <span>è®¾å®šæ­£ç¡®ç‡:</span>
                        <span class="accuracy-value" id="accuracyValue">100%</span>
                    </div>
                    <div class="accuracy-info">
                        <strong>å»ä¸€æ³•è®¡ç®—è§„åˆ™ï¼š</strong><br>
                        æ­£ç¡®é¢˜æ•° = ceil(æœ‰æ•ˆé¢˜ç›®æ•° Ã— æ­£ç¡®ç‡%)<br>
                        æœ‰æ•ˆé¢˜ç›®æ•° = æ€»é¢˜ç›®æ•° - åŸºç¡€ä¿¡æ¯å¡«å†™é¢˜æ•°<br>
                        å®é™…æ­£ç¡®ç‡ â‰¥ è®¾å®šæ­£ç¡®ç‡
                    </div>
                </div>
            </div>

            <!-- å³ä¾§ï¼šé¢˜ç›®åŒ¹é… + é¢˜åº“ç®¡ç† + é€Ÿåº¦é€‰æ‹© -->
            <div class="config-section">
                <!-- é¢˜ç›®åŒ¹é…ç‹¬ç«‹æ¨¡å—ï¼ˆå®Œæ•´å¢åˆ æ”¹æŸ¥ã€å¯¼å…¥å¯¼å‡ºï¼‰ -->
                <h2>ğŸ“„ é¢˜ç›®åŒ¹é…</h2>
                
                <!-- å¯ç”¨å¼€å…³ -->
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <label class="match-toggle">
                            <input type="checkbox" id="enableQuestionMatch">
                            <span>å¯ç”¨é¢˜ç›®åŒ¹é…ï¼ˆæŒ‰é¢˜ç›®æ–‡æœ¬å®šä½é¢˜å·ï¼‰</span>
                        </label>
                    </div>
                </div>
                
                <!-- é¢˜åº“ç®¡ç†å¡ç‰‡ï¼ˆå®Œå…¨å¤ç”¨â€œé¢˜åº“ç®¡ç†â€äº¤äº’é£æ ¼ï¼‰ -->
                <div class="bank-manager" style="margin-top: 5px;">
                    <div class="bank-selector" style="display: flex; gap: 15px; margin-bottom: 15px; align-items: center;">
                        <select class="bank-select" id="matchBankSelect" style="flex: 1;">
                            <!-- åŠ¨æ€ç”Ÿæˆé¢˜ç›®åŒ¹é…é¢˜åº“åˆ—è¡¨ -->
                        </select>
                        <div class="bank-buttons" style="display: flex; gap: 10px;">
                            <button class="bank-btn" id="addMatchBankBtn" title="æ–°å»ºé¢˜ç›®åŒ¹é…é¢˜åº“">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="44" height="44" viewBox="0 0 24 24" version="1.1">
                                    <title>æ–°å»ºé¢˜ç›®åŒ¹é…é¢˜åº“</title>
                                    <desc>Created with Sketch.</desc>
                                    <g id="___Public/ic_public_list_add_light" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <path d="M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z" id="___æ¤­åœ†å½¢" fill="#0A59F7"/>
                                        <path d="M12.75,17.25 C12.75,17.6642136 12.4142136,18 12,18 C11.5857864,18 11.25,17.6642136 11.25,17.25 L11.25,12.749 L6.75,12.75 C6.33578644,12.75 6,12.4142136 6,12 C6,11.5857864 6.33578644,11.25 6.75,11.25 L11.25,11.249 L11.25,6.75 C11.25,6.33578644 11.5857864,6 12,6 C12.4142136,6 12.75,6.33578644 12.75,6.75 L12.75,17.25 Z M13.75,11.25 L17.25,11.25 C17.6642136,11.25 18,11.5857864 18,12 C18,12.4142136 17.6642136,12.75 17.25,12.75 L13.75,12.75 L13.75,11.25 Z" id="___å½¢çŠ¶" fill="#FFFFFF"/>
                                    </g>
                                </svg>
                            </button>
                            <button class="bank-btn edit" id="editMatchBankBtn" title="ç¼–è¾‘å½“å‰é¢˜åº“">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24" version="1.1">
                                    <title>ç¼–è¾‘å½“å‰é¢˜åº“</title>
                                    <defs>
                                        <path d="M16.8722296,2 C17.8721999,2 18.5147251,2.05839169 19.0012003,2.17117304 L17.6599443,3.51379911 C17.4862664,3.50652642 17.2928183,3.5022817 17.0753381,3.50070655 L7.02453833,3.50017541 L6.82305804,3.501658 C5.6550816,3.5151767 5.20981608,3.61305534 4.75370688,3.8569852 C4.36325774,4.06579969 4.06579969,4.36325774 3.8569852,4.75370688 C3.59290159,5.24750032 3.5,5.72858421 3.5,7.1277704 L3.50017541,16.9754617 L3.501658,17.176942 C3.5151767,18.3449184 3.61305534,18.7901839 3.8569852,19.2462931 C4.06579969,19.6367423 4.36325774,19.9342003 4.75370688,20.1430148 C5.22281064,20.3938942 5.68044405,20.4902819 6.92466189,20.4992935 L16.8722296,20.5 C18.2714158,20.5 18.7524997,20.4070984 19.2462931,20.1430148 C19.6367423,19.9342003 19.9342003,19.6367423 20.1430148,19.2462931 C20.3938942,18.7771894 20.4902819,18.319556 20.4992935,17.0753381 L20.5,16.8722296 L20.5,7.1277704 C20.5,6.82616011 20.4956832,6.56721095 20.4862654,6.34159954 L21.8289375,4.9992768 C21.9416465,5.48569497 22,6.12812696 22,7.1277704 L22,16.8722296 L21.9989932,17.0937657 C21.9842401,18.674381 21.8076257,19.3015622 21.487765,19.91208 L21.4657346,19.9536914 C21.1337211,20.5745027 20.6538954,21.0680807 20.0458564,21.4148264 L19.9536914,21.4657346 C19.3018396,21.8143488 18.6552671,22 16.8722296,22 L7.1277704,22 L6.90623426,21.9989932 C5.32561899,21.9842401 4.69843783,21.8076257 4.08791999,21.487765 L4.04630859,21.4657346 C3.42549731,21.1337211 2.93191931,20.6538954 2.58517358,20.0458564 L2.53426541,19.9536914 C2.18565122,19.3018396 2,18.6552671 2,16.8722296 L2,7.1277704 C2,5.38266989 2.17783521,4.72618864 2.51223497,4.08791999 L2.53426541,4.04630859 C2.86627892,3.42549731 3.34610464,2.93191931 3.9541436,2.58517358 L4.04630859,2.53426541 C4.69816044,2.18565122 5.34473292,2 7.1277704,2 L16.8722296,2 Z M22.2300776,1.76992245 C22.6206018,2.16044674 22.6206018,2.79361172 22.2300776,3.18413601 L12.684136,12.7300776 C12.2936117,13.1206018 11.6604467,13.1206018 11.2699224,12.7300776 C10.8793982,12.3395533 10.8793982,11.7063883 11.2699224,11.315864 L20.815864,1.76992245 C21.2063883,1.37939815 21.8395533,1.37939815 22.2300776,1.76992245 Z" id="_____path-1"/>
                                    </defs>
                                    <g id="_____Public/ic_public_edit" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <mask id="_____mask-2" fill="white">
                                            <use xlink:href="#_____path-1"/>
                                        </mask>
                                        <use id="_____å½¢çŠ¶ç»“åˆ" fill="#ffffff" fill-rule="nonzero" xlink:href="#_____path-1"/>
                                    </g>
                                </svg>
                            </button>
                            <button class="bank-btn delete" id="deleteMatchBankBtn" title="åˆ é™¤å½“å‰é¢˜åº“">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="44" height="44" viewBox="0 0 24 24" version="1.1">
                                    <title>åˆ é™¤å½“å‰é¢˜åº“</title>
                                    <desc>Created with Sketch.</desc>
                                    <g id="___Public/ic_public_list_deleted" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <circle id="___colorError" fill="#E84026" cx="12" cy="12" r="11"/>
                                        <path d="M8.81801948,16.2426407 C8.52512627,16.5355339 8.05025253,16.5355339 7.75735931,16.2426407 C7.46446609,15.9497475 7.46446609,15.4748737 7.75735931,15.1819805 L10.9400469,11.9992929 L7.75735931,8.81801948 C7.46446609,8.52512627 7.46446609,8.05025253 7.75735931,7.75735931 C8.05025253,7.46446609 8.52512627,7.46446609 8.81801948,7.75735931 L12.0007071,10.9386327 L15.1819805,7.75735931 C15.4748737,7.46446609 15.9497475,7.46446609 16.2426407,7.75735931 C16.5355339,8.05025253 16.5355339,8.52512627 16.2426407,8.81801948 L8.81801948,16.2426407 Z M13.767767,12.7071068 L16.2426407,15.1819805 C16.5355339,15.4748737 16.5355339,15.9497475 16.2426407,16.2426407 C15.9497475,16.5355339 15.4748737,16.5355339 15.1819805,16.2426407 L12.7071068,13.767767 L13.767767,12.7071068 Z" id="___å½¢çŠ¶" fill="#FFFFFF"/>
                                    </g>
                                </svg>
                            </button>
                            <button class="bank-btn import" id="importMatchBankBtn" title="å¯¼å…¥é¢˜åº“">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1">
                                    <title>å¯¼å…¥é¢˜åº“</title>
                                    <g id="___ic_gallery_move_in_10" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <path d="M9.80582194,12.4707394 C10.4919646,11.8294422 11.5682572,11.8433835 12.2374369,12.5125631 L12.2374369,12.5125631 L14.7803301,15.0554564 L14.8105907,15.0875175 C15.0728497,15.382037 15.0627628,15.8336838 14.7803301,16.1161165 C14.4874369,16.4090097 14.0125631,16.4090097 13.7196699,16.1161165 L13.7196699,16.1161165 L11.748,14.1457864 L11.7484143,22.0857864 C11.7484143,22.5 11.4126279,22.8357864 10.9984143,22.8357864 C10.5842008,22.8357864 10.2484143,22.5 10.2484143,22.0857864 L10.2484143,22.0857864 L10.248,14.1487864 L8.28033009,16.1161165 L8.2482689,16.1463772 C7.95374943,16.4086362 7.50210266,16.3985493 7.21966991,16.1161165 C6.9267767,15.8232233 6.9267767,15.3483496 7.21966991,15.0554564 L7.21966991,15.0554564 L9.76256313,12.5125631 Z M16.0132009,5.06756757 L16.2245442,5.06864828 L16.4235832,5.07188219 L16.610921,5.07725701 L16.7871609,5.08476043 L16.952906,5.09438012 L17.1087593,5.10610379 C17.436161,5.13377548 17.6981555,5.17617598 17.9223487,5.23274189 L18.0232389,5.25985301 C18.0396401,5.26453848 18.0558427,5.26930726 18.0718594,5.27415909 L18.1658281,5.30426462 L18.2559364,5.33635102 L18.3427875,5.370406 L18.4269844,5.40641724 C18.4408295,5.41258145 18.4545892,5.41882666 18.468276,5.42515261 L18.5496226,5.46407517 L18.5898283,5.48425928 L18.6696816,5.52606546 C18.6829536,5.53319242 18.6962156,5.54039883 18.70948,5.54768445 C19.2798504,5.86096612 19.7274804,6.32069423 20.0325178,6.90648002 L20.0741537,6.98829002 C20.0809381,7.0019543 20.0876449,7.01564183 20.0942739,7.0293655 L20.133111,7.11224457 L20.1518251,7.15420301 L20.1878366,7.23954487 L20.205131,7.28308314 L20.2382898,7.37228151 L20.2695318,7.46482519 L20.2988451,7.56133361 L20.3127747,7.61126816 L20.3391724,7.71488512 C20.390013,7.92742588 20.4291013,8.17304656 20.4560058,8.47404676 L20.4684408,8.62926507 L20.4788331,8.79433272 C20.4803943,8.82269919 20.4818699,8.85150186 20.4832596,8.88075363 L20.4905655,9.06175676 L20.4957989,9.25415783 L20.4989477,9.45857626 L20.5,9.67563151 L20.5,16.8919361 L20.4989477,17.1089913 L20.4957989,17.3134097 L20.4905655,17.5058108 L20.4832596,17.6868139 L20.473893,17.8570386 L20.4624779,18.0171041 C20.4355344,18.3533545 20.3942497,18.62243 20.3391724,18.8526824 L20.3127747,18.9562994 L20.2988451,19.006234 L20.2695318,19.1027424 L20.2382898,19.1952861 L20.205131,19.2844844 L20.1700674,19.3709569 C20.1640654,19.3851763 20.1579846,19.3993078 20.1518251,19.4133646 L20.1139268,19.4969097 C20.1074539,19.5107186 20.1009028,19.5244784 20.0942739,19.5382021 L20.0535678,19.6202136 C20.0466284,19.6338443 20.0396117,19.6474646 20.0325178,19.6610875 C19.7274804,20.2468733 19.2798504,20.7066014 18.70948,21.0198831 L18.6298229,21.0626443 L18.6098473,21.0730362 L18.5091303,21.1231951 C18.4955767,21.1296823 18.4819628,21.136089 18.468276,21.142415 L18.38518,21.1793997 C18.3711514,21.1854017 18.3570247,21.1913224 18.3427875,21.1971616 L18.2559364,21.2312165 L18.1658281,21.263303 L18.0718594,21.2934085 L18.0232389,21.3077146 L17.9223487,21.3348257 C17.7154011,21.3870404 17.4762441,21.4271851 17.183165,21.4548168 L17.0320314,21.4675878 L16.8713076,21.4782611 L16.7871609,21.4828071 L16.610921,21.4903106 L16.4235832,21.4956854 L16.2245442,21.4989193 L16.0132009,21.5 L12.748,21.5 L12.747,19.959 L16.1110218,19.9592782 L16.2959116,19.9578034 L16.4671632,19.9547896 L16.6256139,19.9501701 L16.7721008,19.9438779 L16.9074611,19.9358462 L17.032532,19.9260081 L17.1481507,19.9142968 C17.1666793,19.9121851 17.184849,19.9099926 17.2026772,19.9077179 L17.3056874,19.8930714 L17.4013385,19.8763846 L17.4904676,19.8575906 C17.5766148,19.8377206 17.6542349,19.8145896 17.7270953,19.7878966 L17.7985086,19.7600051 L17.867586,19.7296721 L17.9351646,19.6968307 L18.0020817,19.6614141 C18.3110494,19.4917105 18.5445603,19.2518885 18.709798,18.9345704 L18.7442825,18.8658447 L18.7762597,18.7964396 L18.8057944,18.7254953 L18.8329519,18.6521519 C18.8589425,18.5773223 18.8814648,18.4976044 18.9008119,18.4091289 L18.9191113,18.3175909 L18.935359,18.2193546 L18.94962,18.1135603 C18.9518349,18.0952503 18.9539697,18.0765896 18.9560259,18.0575602 L18.9674289,17.9388166 L18.9770081,17.8103654 L18.9848284,17.6713467 L18.9909551,17.5209008 L18.995453,17.3581676 L18.9983875,17.1822876 L18.9998235,16.9924007 L18.9998235,9.57516684 L18.9983875,9.38527999 L18.995453,9.20939992 L18.9909551,9.04666682 L18.9848284,8.89622084 L18.9770081,8.75720216 L18.9674289,8.62875094 L18.9560259,8.51000736 C18.9539697,8.49097797 18.9518349,8.47231723 18.94962,8.45400724 L18.935359,8.34821293 L18.9191113,8.24997668 L18.9008119,8.15843866 C18.8814648,8.06996315 18.8589425,7.99024523 18.8329519,7.91541567 L18.8057944,7.84207227 L18.7762597,7.77112793 L18.7442825,7.70172285 L18.709798,7.63299718 C18.5445603,7.31567904 18.3110494,7.07585703 18.0020817,6.90615343 L17.9351646,6.87073684 L17.867586,6.83789547 L17.7985086,6.80756248 L17.7270953,6.77967099 C17.6542349,6.75297797 17.5766148,6.72984693 17.4904676,6.709977 L17.4013385,6.69118297 L17.3056874,6.67449616 L17.2026772,6.65984971 L17.1481507,6.65327073 L17.032532,6.64155946 L16.9074611,6.63172141 L16.7721008,6.62368971 L16.6256139,6.61739751 L16.4671632,6.61277796 L16.2959116,6.60976418 L16.1110218,6.60828933 L5.38897824,6.60828933 L5.19886103,6.60983053 L4.94044884,6.61522674 L4.78468461,6.62098685 L4.64106334,6.62856215 L4.50867177,6.63802558 C4.48749158,6.63976421 4.46674125,6.64158456 4.44640173,6.64348813 L4.32914234,6.65592051 C4.2915977,6.66040566 4.25554415,6.66523588 4.22082948,6.67042334 L4.12054988,6.68706956 L4.02739027,6.70593211 L3.94043739,6.72708392 L3.85877796,6.75059792 C3.80589988,6.76707753 3.75594193,6.78518055 3.70768641,6.80500423 L3.63642775,6.8360424 L3.56680947,6.86973449 L3.49791831,6.90615343 C3.18895065,7.07585703 2.95543974,7.31567904 2.79020203,7.63299718 L2.75571745,7.70172285 L2.72374033,7.77112793 L2.69420557,7.84207227 L2.66704807,7.91541567 C2.6410575,7.99024523 2.61853517,8.06996315 2.59918813,8.15843866 L2.58088868,8.24997668 L2.564641,8.34821293 L2.55037998,8.45400724 C2.54816509,8.47231723 2.54603025,8.49097797 2.54397413,8.51000736 L2.53257105,8.62875094 L2.5229919,8.75720216 L2.51517156,8.89622084 L2.50904495,9.04666682 L2.50454696,9.20939992 L2.50161249,9.38527999 L2.50017645,9.57516684 L2.50017645,16.9924007 L2.50161249,17.1822876 L2.50454696,17.3581676 L2.50904495,17.5209008 L2.51517156,17.6713467 L2.5229919,17.8103654 L2.53257105,17.9388166 L2.54397413,18.0575602 C2.54603025,18.0765896 2.54816509,18.0952503 2.55037998,18.1135603 L2.564641,18.2193546 L2.58088868,18.3175909 L2.59918813,18.4091289 C2.61853517,18.4976044 2.6410575,18.5773223 2.66704807,18.6521519 L2.69420557,18.7254953 L2.72374033,18.7964396 L2.75571745,18.8658447 L2.79020203,18.9345704 C2.95543974,19.2518885 3.18895065,19.4917105 3.49791831,19.6614141 L3.56483541,19.6968307 L3.63241404,19.7296721 L3.70149142,19.7600051 L3.77290473,19.7878966 C3.84576509,19.8145896 3.92338517,19.8377206 4.00953238,19.8575906 L4.09866151,19.8763846 L4.19431259,19.8930714 L4.29732284,19.9077179 C4.31515099,19.9099926 4.33332065,19.9121851 4.35184927,19.9142968 L4.46746802,19.9260081 L4.59253894,19.9358462 L4.72789924,19.9438779 L4.87438611,19.9501701 L5.03283677,19.9547896 L5.20408841,19.9578034 L5.38897824,19.9592782 L9.248,19.959 L9.248,21.5 L5.4867991,21.5 L5.27545584,21.4989193 L5.07641683,21.4956854 L4.88907895,21.4903106 L4.71283906,21.4828071 L4.54709404,21.4731874 L4.39124074,21.4614638 C4.06383903,21.4337921 3.80184451,21.3913916 3.5776513,21.3348257 L3.47676111,21.3077146 L3.42814062,21.2934085 L3.3341719,21.263303 L3.24406358,21.2312165 L3.15721253,21.1971616 L3.07301562,21.1611503 C3.05917047,21.1549861 3.04541078,21.1487409 3.03172398,21.142415 L2.9503774,21.1034924 L2.91017167,21.0833083 L2.83031837,21.0415021 L2.79052002,21.0198831 C2.22014965,20.7066014 1.77251964,20.2468733 1.46748223,19.6610875 L1.42584629,19.5792775 C1.41906187,19.5656133 1.41235507,19.5519257 1.40572614,19.5382021 L1.36688895,19.455323 L1.34817491,19.4133646 L1.31216344,19.3280227 L1.294869,19.2844844 L1.2617102,19.1952861 L1.23046818,19.1027424 L1.20115491,19.006234 L1.1872253,18.9562994 L1.16082763,18.8526824 C1.10998702,18.6401417 1.07089871,18.394521 1.04399417,18.0935208 L1.03155921,17.9383025 L1.02116686,17.7732348 C1.01960569,17.7448684 1.01813012,17.7160657 1.01674041,17.6868139 L1.00943446,17.5058108 L1.00420108,17.3134097 L1.00105227,17.1089913 L1,16.8919361 L1.00026332,9.56548557 L1.00236536,9.35482616 L1.00420108,9.25415783 L1.00943446,9.06175676 L1.01674041,8.88075363 L1.02610696,8.71052901 L1.03752211,8.55046346 C1.0644656,8.21421306 1.1057503,7.94513761 1.16082763,7.71488512 L1.1872253,7.61126816 L1.20115491,7.56133361 L1.23046818,7.46482519 L1.2617102,7.37228151 L1.294869,7.28308314 L1.32993257,7.19661063 C1.33593457,7.18239129 1.34201543,7.16825972 1.34817491,7.15420301 L1.38607319,7.07065787 L1.39584117,7.04997973 L1.44643216,6.947354 C1.45337156,6.9337233 1.46038834,6.92010294 1.46748223,6.90648002 C1.77251964,6.32069423 2.22014965,5.86096612 2.79052002,5.54768445 L2.87017712,5.50492322 L2.99086971,5.44437244 C3.00442328,5.43788526 3.01803719,5.43147856 3.03172398,5.42515261 L3.11482,5.38816785 C3.12884863,5.38216589 3.14297529,5.37624519 3.15721253,5.370406 L3.24406358,5.33635102 L3.3341719,5.30426462 L3.42814062,5.27415909 C3.44415728,5.26930726 3.46035992,5.26453848 3.47676111,5.25985301 L3.5776513,5.23274189 C3.78459888,5.18052721 4.02375586,5.14038246 4.31683501,5.11275077 L4.46796862,5.09997973 L4.62869239,5.08930651 C4.65631237,5.08770314 4.68435707,5.08618769 4.71283906,5.08476043 L4.88907895,5.07725701 L5.07641683,5.07188219 L5.27545584,5.06864828 L5.4867991,5.06756757 L16.0132009,5.06756757 Z M16.7126566,2.50024502 L16.9488443,2.50220182 L17.1739926,2.50610692 L17.3885365,2.51195144 L17.592911,2.51972649 L17.7875512,2.5294232 L17.9728921,2.54103269 L18.1493689,2.55454609 L18.3174165,2.5699545 L18.47747,2.58724907 L18.6299644,2.60642089 C18.6795844,2.61312339 18.728017,2.62013729 18.7753348,2.6274611 L18.9140163,2.65036082 L18.9809847,2.66250522 L19.1104484,2.68817755 C19.1315468,2.69260963 19.1524119,2.69711826 19.1730526,2.70170327 L19.2942775,2.73012824 C19.3140572,2.73501798 19.3336307,2.73998372 19.353007,2.74502527 L19.4669719,2.7761829 L19.5223161,2.79244127 L19.6299999,2.82631158 L19.7340401,2.86197925 L19.8348717,2.89943539 L19.9329298,2.93867113 C19.9490659,2.94535823 19.9651045,2.95211911 19.9810548,2.95895358 L20.0757683,3.00084207 L20.168796,3.04448796 L20.2605729,3.08988238 L20.4421143,3.18588127 C21.2569291,3.6334265 21.8964005,4.29018095 22.3321682,5.12701779 L22.3797471,5.22004624 L22.4256408,5.31346571 L22.4698407,5.40772301 L22.512338,5.50326496 L22.5531241,5.60053836 L22.5921905,5.69999001 C22.6112923,5.75033487 22.6297459,5.80166412 22.6475465,5.85422911 L22.6822756,5.96108118 L22.7152546,6.07167534 L22.7464748,6.18645839 C22.7565875,6.22546721 22.7664056,6.26524863 22.7759278,6.30587715 L22.8036047,6.4303784 C22.8080691,6.45157698 22.812459,6.47300594 22.8167745,6.4946746 L22.8417712,6.62763738 C22.8457878,6.65030206 22.8497295,6.67322505 22.853596,6.69641567 L22.8758931,6.83884529 C22.8794587,6.86314363 22.8829488,6.88772821 22.8863633,6.91260833 L22.9059413,7.06551012 C22.9090525,7.09160967 22.9120878,7.11802338 22.915047,7.14476057 L22.9318864,7.30913983 L22.9468893,7.48172925 L22.9600471,7.66297565 L22.9713511,7.85332582 L22.9807926,8.05322657 L22.9883631,8.26312472 L22.9940538,8.48346707 L22.9978561,8.71470042 L22.9997614,8.95727159 L23,13.6660736 L22.9989932,13.8935972 L22.9959799,14.108982 L22.9909705,14.3127699 L22.9839756,14.5055033 L22.9750056,14.6877241 L22.964071,14.8599746 L22.9511823,15.0227968 C22.9465615,15.0755597 22.9416169,15.1268416 22.93635,15.1767329 L22.9195846,15.3223249 L22.9008965,15.4601151 C22.8812506,15.5941851 22.8587365,15.7173654 22.8334014,15.8320956 L22.8071277,15.9440995 L22.7932889,15.9981583 L22.7642139,16.1027286 L22.7332844,16.2030207 L22.700511,16.299577 L22.6659041,16.3929394 L22.6479163,16.4385923 L22.6105789,16.5281804 L22.5714342,16.61593 L22.5304927,16.7023832 L22.487765,16.7880822 L22.4657346,16.8308182 C22.2201441,17.3024437 21.8936771,17.7025712 21.4942661,18.0230539 C21.4960887,17.9505884 21.497533,17.8756872 21.4985008,17.7985782 L21.5,17.5502309 L21.5,9.01733666 L21.4985008,8.76898935 L21.4984144,8.74192331 L21.4955434,8.52963215 L21.4911629,8.32874285 L21.4852228,8.13870228 L21.477673,7.95895731 L21.4732788,7.87277283 L21.4632206,7.70743416 C21.4614011,7.68063582 21.4595092,7.65420884 21.4575441,7.6281417 L21.4448649,7.47596481 L21.4303757,7.33187102 L21.4140266,7.19530722 L21.3957674,7.06572029 L21.375548,6.94255708 L21.3533185,6.8252645 L21.3290287,6.71328939 C21.324806,6.69503927 21.3204953,6.67698767 21.3160956,6.65912305 L21.2886216,6.55408707 C21.2838618,6.53692433 21.279011,6.51992554 21.2740681,6.50307916 L21.2432972,6.40373778 C21.2273508,6.35488943 21.2105567,6.30720545 21.1928867,6.26037471 L21.1563706,6.1677587 L21.1174688,6.07686487 C21.1107836,6.06182868 21.1039969,6.04684121 21.0971076,6.03189092 L21.0545335,5.94254325 L21.0094484,5.85353495 C20.7134804,5.28516576 20.2881281,4.84831742 19.734716,4.54435025 L19.64805,4.49804672 L19.5610536,4.4543219 L19.4731882,4.41312436 C19.4584416,4.40646585 19.4436364,4.3999105 19.4287613,4.39345725 L19.3385825,4.35595422 C19.2929842,4.33780668 19.246555,4.32055866 19.1989922,4.30418125 L19.102265,4.27257866 C19.085862,4.26750217 19.0693105,4.26252028 19.0525994,4.2576319 L18.9503276,4.22941532 C18.9329331,4.22489674 18.9153565,4.22046954 18.8975866,4.21613265 L18.7885583,4.19118638 L18.6743523,4.16835606 L18.5544302,4.14759026 L18.4282535,4.12883756 L18.2952835,4.11204655 L18.1549816,4.09716581 L18.0068094,4.08414391 L17.8502282,4.07292945 C17.8234007,4.07120813 17.7962003,4.06955999 17.7686159,4.06798394 L17.5984115,4.05938421 L17.4184516,4.05246338 L17.2281978,4.04717001 L17.0271115,4.04345269 L16.894733,4.04206378 C16.8560284,4.04155436 16.8167527,4.04117489 16.7768869,4.04092211 L4.8458278,4.04054054 C4.6827364,4.04054054 4.52925026,4.04248559 4.38417877,4.04657982 C4.67638696,3.66396601 5.03476921,3.34660895 5.4541436,3.10098908 L5.58791999,3.02607916 L5.67136368,2.98219664 L5.7555418,2.94014866 L5.84098221,2.899946 L5.92821276,2.86159943 L5.97266429,2.84312555 L6.06356978,2.80758332 L6.15758506,2.77392411 L6.25523798,2.7421587 L6.35705641,2.71229786 L6.40969263,2.69808502 L6.51874904,2.67110123 C6.63046004,2.6450814 6.75039875,2.62195882 6.88094054,2.60178197 L7.01510466,2.58258883 L7.15686536,2.56537028 L7.23075937,2.55750485 L7.38490466,2.54326839 L7.54796616,2.53103346 L7.63300545,2.52566993 L7.81043101,2.51645748 L7.99809242,2.50927349 L8.19651756,2.50412873 L8.40623426,2.50103398 L8.6277704,2.5 L16.7126566,2.50024502 Z" id="___å½¢çŠ¶ç»“åˆ" fill="#ffffff" fill-rule="nonzero"/>
                                    </g>
                                </svg>
                            </button>
                            <button class="bank-btn export" id="exportMatchBankBtn" title="å¯¼å‡ºé¢˜åº“">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1">
                                    <title>å¯¼å‡ºå½“å‰é¢˜åº“</title>
                                    <g id="___ic_gallery_move_out" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <path d="M10.9984143,12 C11.4126279,12 11.7484143,12.3357864 11.7484143,12.75 L11.748,20.69 L13.7196699,18.7196699 C14.0125631,18.4267767 14.4874369,18.4267767 14.7803301,18.7196699 C15.0627628,19.0021027 15.0728497,19.4537494 14.8105907,19.7482689 L14.7803301,19.7803301 L12.2374369,22.3232233 C11.5682572,22.992403 10.4919646,23.0063442 9.80582194,22.365047 L9.76256313,22.3232233 L7.21966991,19.7803301 C6.9267767,19.4874369 6.9267767,19.0125631 7.21966991,18.7196699 C7.50210266,18.4372372 7.95374943,18.4271503 8.2482689,18.6894093 L8.28033009,18.7196699 L10.248,20.687 L10.2484143,12.75 C10.2484143,12.3357864 10.5842008,12 10.9984143,12 Z M16.0132009,5.06756757 L16.2245442,5.06864828 L16.4235832,5.07188219 L16.610921,5.07725701 L16.7871609,5.08476043 L16.952906,5.09438012 L17.1087593,5.10610379 C17.436161,5.13377548 17.6981555,5.17617598 17.9223487,5.23274189 L18.0232389,5.25985301 C18.0396401,5.26453848 18.0558427,5.26930726 18.0718594,5.27415909 L18.1658281,5.30426462 L18.2559364,5.33635102 L18.3427875,5.370406 L18.4269844,5.40641724 C18.4408295,5.41258145 18.4545892,5.41882666 18.468276,5.42515261 L18.5496226,5.46407517 L18.5898283,5.48425928 L18.6696816,5.52606546 C18.6829536,5.53319242 18.6962156,5.54039883 18.70948,5.54768445 C19.2798504,5.86096612 19.7274804,6.32069423 20.0325178,6.90648002 L20.0741537,6.98829002 C20.0809381,7.0019543 20.0876449,7.01564183 20.0942739,7.0293655 L20.133111,7.11224457 L20.1518251,7.15420301 L20.1878366,7.23954487 L20.205131,7.28308314 L20.2382898,7.37228151 L20.2695318,7.46482519 L20.2988451,7.56133361 L20.3127747,7.61126816 L20.3391724,7.71488512 C20.390013,7.92742588 20.4291013,8.17304656 20.4560058,8.47404676 L20.4684408,8.62926507 L20.4788331,8.79433272 C20.4803943,8.82269919 20.4818699,8.85150186 20.4832596,8.88075363 L20.4905655,9.06175676 L20.4957989,9.25415783 L20.4989477,9.45857626 L20.5,9.67563151 L20.5,16.8919361 L20.4989477,17.1089913 L20.4957989,17.3134097 L20.4905655,17.5058108 L20.4832596,17.6868139 L20.473893,17.8570386 L20.4624779,18.0171041 C20.4355344,18.3533545 20.3942497,18.62243 20.3391724,18.8526824 L20.3127747,18.9562994 L20.2988451,19.006234 L20.2695318,19.1027424 L20.2382898,19.1952861 L20.205131,19.2844844 L20.1700674,19.3709569 C20.1640654,19.3851763 20.1579846,19.3993078 20.1518251,19.4133646 L20.1139268,19.4969097 C20.1074539,19.5107186 20.1009028,19.5244784 20.0942739,19.5382021 L20.0535678,19.6202136 C20.0466284,19.6338443 20.0396117,19.6474646 20.0325178,19.6610875 C19.7274804,20.2468733 19.2798504,20.7066014 18.70948,21.0198831 L18.6298229,21.0626443 L18.6098473,21.0730362 L18.5091303,21.1231951 C18.4955767,21.1296823 18.4819628,21.136089 18.468276,21.142415 L18.38518,21.1793997 C18.3711514,21.1854017 18.3570247,21.1913224 18.3427875,21.1971616 L18.2559364,21.2312165 L18.1658281,21.263303 L18.0718594,21.2934085 L18.0232389,21.3077146 L17.9223487,21.3348257 C17.7154011,21.3870404 17.4762441,21.4271851 17.183165,21.4548168 L17.0320314,21.4675878 L16.8713076,21.4782611 L16.7871609,21.4828071 L16.610921,21.4903106 L16.4235832,21.4956854 L16.2245442,21.4989193 L16.0132009,21.5 L14.478,21.5 L16.019,19.959 L16.1110218,19.9592782 L16.2959116,19.9578034 L16.4671632,19.9547896 L16.6256139,19.9501701 L16.7721008,19.9438779 L16.9074611,19.9358462 L17.032532,19.9260081 L17.1481507,19.9142968 C17.1666793,19.9121851 17.184849,19.9099926 17.2026772,19.9077179 L17.3056874,19.8930714 L17.4013385,19.8763846 L17.4904676,19.8575906 C17.5766148,19.8377206 17.6542349,19.8145896 17.7270953,19.7878966 L17.7985086,19.7600051 L17.867586,19.7296721 L17.9351646,19.6968307 L18.0020817,19.6614141 C18.3110494,19.4917105 18.5445603,19.2518885 18.709798,18.9345704 L18.7442825,18.8658447 L18.7762597,18.7964396 L18.8057944,18.7254953 L18.8329519,18.6521519 C18.8589425,18.5773223 18.8814648,18.4976044 18.9008119,18.4091289 L18.9191113,18.3175909 L18.935359,18.2193546 L18.94962,18.1135603 C18.9518349,18.0952503 18.9539697,18.0765896 18.9560259,18.0575602 L18.9674289,17.9388166 L18.9770081,17.8103654 L18.9848284,17.6713467 L18.9909551,17.5209008 L18.995453,17.3581676 L18.9983875,17.1822876 L18.9998235,16.9924007 L18.9998235,9.57516684 L18.9983875,9.38527999 L18.995453,9.20939992 L18.9909551,9.04666682 L18.9848284,8.89622084 L18.9770081,8.75720216 L18.9674289,8.62875094 L18.9560259,8.51000736 C18.9539697,8.49097797 18.9518349,8.47231723 18.94962,8.45400724 L18.935359,8.34821293 L18.9191113,8.24997668 L18.9008119,8.15843866 C18.8814648,8.06996315 18.8589425,7.99024523 18.8329519,7.91541567 L18.8057944,7.84207227 L18.7762597,7.77112793 L18.7442825,7.70172285 L18.709798,7.63299718 C18.5445603,7.31567904 18.3110494,7.07585703 18.0020817,6.90615343 L17.9351646,6.87073684 L17.867586,6.83789547 L17.7985086,6.80756248 L17.7270953,6.77967099 C17.6542349,6.75297797 17.5766148,6.72984693 17.4904676,6.709977 L17.4013385,6.69118297 L17.3056874,6.67449616 L17.2026772,6.65984971 L17.1481507,6.65327073 L17.032532,6.64155946 L16.9074611,6.63172141 L16.7721008,6.62368971 L16.6256139,6.61739751 L16.4671632,6.61277796 L16.2959116,6.60976418 L16.1110218,6.60828933 L5.38897824,6.60828933 L5.19886103,6.60983053 L4.94044884,6.61522674 L4.78468461,6.62098685 L4.64106334,6.62856215 L4.50867177,6.63802558 C4.48749158,6.63976421 4.46674125,6.64158456 4.44640173,6.64348813 L4.32914234,6.65592051 C4.2915977,6.66040566 4.25554415,6.66523588 4.22082948,6.67042334 L4.12054988,6.68706956 L4.02739027,6.70593211 L3.94043739,6.72708392 L3.85877796,6.75059792 C3.80589988,6.76707753 3.75594193,6.78518055 3.70768641,6.80500423 L3.63642775,6.8360424 L3.56680947,6.86973449 L3.49791831,6.90615343 C3.18895065,7.07585703 2.95543974,7.31567904 2.79020203,7.63299718 L2.75571745,7.70172285 L2.72374033,7.77112793 L2.69420557,7.84207227 L2.66704807,7.91541567 C2.6410575,7.99024523 2.61853517,8.06996315 2.59918813,8.15843866 L2.58088868,8.24997668 L2.564641,8.34821293 L2.55037998,8.45400724 C2.54816509,8.47231723 2.54603025,8.49097797 2.54397413,8.51000736 L2.53257105,8.62875094 L2.5229919,8.75720216 L2.51517156,8.89622084 L2.50904495,9.04666682 L2.50454696,9.20939992 L2.50161249,9.38527999 L2.50017645,9.57516684 L2.50017645,16.9924007 L2.50161249,17.1822876 L2.50454696,17.3581676 L2.50904495,17.5209008 L2.51517156,17.6713467 L2.5229919,17.8103654 L2.53257105,17.9388166 L2.54397413,18.0575602 C2.54603025,18.0765896 2.54816509,18.0952503 2.55037998,18.1135603 L2.564641,18.2193546 L2.58088868,18.3175909 L2.59918813,18.4091289 C2.61853517,18.4976044 2.6410575,18.5773223 2.66704807,18.6521519 L2.69420557,18.7254953 L2.72374033,18.7964396 L2.75571745,18.8658447 L2.79020203,18.9345704 C2.95543974,19.2518885 3.18895065,19.4917105 3.49791831,19.6614141 L3.56483541,19.6968307 L3.63241404,19.7296721 L3.70149142,19.7600051 L3.77290473,19.7878966 C3.84576509,19.8145896 3.92338517,19.8377206 4.00953238,19.8575906 L4.09866151,19.8763846 L4.19431259,19.8930714 L4.29732284,19.9077179 C4.31515099,19.9099926 4.33332065,19.9121851 4.35184927,19.9142968 L4.46746802,19.9260081 L4.59253894,19.9358462 L4.72789924,19.9438779 L4.87438611,19.9501701 L5.03283677,19.9547896 L5.20408841,19.9578034 L5.38897824,19.9592782 L5.98,19.959 L7.521,21.5 L5.4867991,21.5 L5.27545584,21.4989193 L5.07641683,21.4956854 L4.88907895,21.4903106 L4.71283906,21.4828071 L4.54709404,21.4731874 L4.39124074,21.4614638 C4.06383903,21.4337921 3.80184451,21.3913916 3.5776513,21.3348257 L3.47676111,21.3077146 L3.42814062,21.2934085 L3.3341719,21.263303 L3.24406358,21.2312165 L3.15721253,21.1971616 L3.07301562,21.1611503 C3.05917047,21.1549861 3.04541078,21.1487409 3.03172398,21.142415 L2.9503774,21.1034924 L2.91017167,21.0833083 L2.83031837,21.0415021 L2.79052002,21.0198831 C2.22014965,20.7066014 1.77251964,20.2468733 1.46748223,19.6610875 L1.42584629,19.5792775 C1.41906187,19.5656133 1.41235507,19.5519257 1.40572614,19.5382021 L1.36688895,19.455323 L1.34817491,19.4133646 L1.31216344,19.3280227 L1.294869,19.2844844 L1.2617102,19.1952861 L1.23046818,19.1027424 L1.20115491,19.006234 L1.1872253,18.9562994 L1.16082763,18.8526824 C1.10998702,18.6401417 1.07089871,18.394521 1.04399417,18.0935208 L1.03155921,17.9383025 L1.02116686,17.7732348 C1.01960569,17.7448684 1.01813012,17.7160657 1.01674041,17.6868139 L1.00943446,17.5058108 L1.00420108,17.3134097 L1.00105227,17.1089913 L1,16.8919361 L1.00026332,9.56548557 L1.00236536,9.35482616 L1.00420108,9.25415783 L1.00943446,9.06175676 L1.01674041,8.88075363 L1.02610696,8.71052901 L1.03752211,8.55046346 C1.0644656,8.21421306 1.1057503,7.94513761 1.16082763,7.71488512 L1.1872253,7.61126816 L1.20115491,7.56133361 L1.23046818,7.46482519 L1.2617102,7.37228151 L1.294869,7.28308314 L1.32993257,7.19661063 C1.33593457,7.18239129 1.34201543,7.16825972 1.34817491,7.15420301 L1.38607319,7.07065787 L1.39584117,7.04997973 L1.44643216,6.947354 C1.45337156,6.9337233 1.46038834,6.92010294 1.46748223,6.90648002 C1.77251964,6.32069423 2.22014965,5.86096612 2.79052002,5.54768445 L2.87017712,5.50492322 L2.99086971,5.44437244 C3.00442328,5.43788526 3.01803719,5.43147856 3.03172398,5.42515261 L3.11482,5.38816785 C3.12884863,5.38216589 3.14297529,5.37624519 3.15721253,5.370406 L3.24406358,5.33635102 L3.3341719,5.30426462 L3.42814062,5.27415909 C3.44415728,5.26930726 3.46035992,5.26453848 3.47676111,5.25985301 L3.5776513,5.23274189 C3.78459888,5.18052721 4.02375586,5.14038246 4.31683501,5.11275077 L4.46796862,5.09997973 L4.62869239,5.08930651 C4.65631237,5.08770314 4.68435707,5.08618769 4.71283906,5.08476043 L4.88907895,5.07725701 L5.07641683,5.07188219 L5.27545584,5.06864828 L5.4867991,5.06756757 L16.0132009,5.06756757 Z M16.7126566,2.50024502 L16.9488443,2.50220182 L17.1739926,2.50610692 L17.3885365,2.51195144 L17.592911,2.51972649 L17.7875512,2.5294232 L17.9728921,2.54103269 L18.1493689,2.55454609 L18.3174165,2.5699545 L18.47747,2.58724907 L18.6299644,2.60642089 C18.6795844,2.61312339 18.728017,2.62013729 18.7753348,2.6274611 L18.9140163,2.65036082 L18.9809847,2.66250522 L19.1104484,2.68817755 C19.1315468,2.69260963 19.1524119,2.69711826 19.1730526,2.70170327 L19.2942775,2.73012824 C19.3140572,2.73501798 19.3336307,2.73998372 19.353007,2.74502527 L19.4669719,2.7761829 L19.5223161,2.79244127 L19.6299999,2.82631158 L19.7340401,2.86197925 L19.8348717,2.89943539 L19.9329298,2.93867113 C19.9490659,2.94535823 19.9651045,2.95211911 19.9810548,2.95895358 L20.0757683,3.00084207 L20.168796,3.04448796 L20.2605729,3.08988238 L20.4421143,3.18588127 C21.2569291,3.6334265 21.8964005,4.29018095 22.3321682,5.12701779 L22.3797471,5.22004624 L22.4256408,5.31346571 L22.4698407,5.40772301 L22.512338,5.50326496 L22.5531241,5.60053836 L22.5921905,5.69999001 C22.6112923,5.75033487 22.6297459,5.80166412 22.6475465,5.85422911 L22.6822756,5.96108118 L22.7152546,6.07167534 L22.7464748,6.18645839 C22.7565875,6.22546721 22.7664056,6.26524863 22.7759278,6.30587715 L22.8036047,6.4303784 C22.8080691,6.45157698 22.812459,6.47300594 22.8167745,6.4946746 L22.8417712,6.62763738 C22.8457878,6.65030206 22.8497295,6.67322505 22.853596,6.69641567 L22.8758931,6.83884529 C22.8794587,6.86314363 22.8829488,6.88772821 22.8863633,6.91260833 L22.9059413,7.06551012 C22.9090525,7.09160967 22.9120878,7.11802338 22.915047,7.14476057 L22.9318864,7.30913983 L22.9468893,7.48172925 L22.9600471,7.66297565 L22.9713511,7.85332582 L22.9807926,8.05322657 L22.9883631,8.26312472 L22.9940538,8.48346707 L22.9978561,8.71470042 L22.9997614,8.95727159 L23,13.6660736 L22.9989932,13.8935972 L22.9959799,14.108982 L22.9909705,14.3127699 L22.9839756,14.5055033 L22.9750056,14.6877241 L22.964071,14.8599746 L22.9511823,15.0227968 C22.9465615,15.0755597 22.9416169,15.1268416 22.93635,15.1767329 L22.9195846,15.3223249 L22.9008965,15.4601151 C22.8812506,15.5941851 22.8587365,15.7173654 22.8334014,15.8320956 L22.8071277,15.9440995 L22.7932889,15.9981583 L22.7642139,16.1027286 L22.7332844,16.2030207 L22.700511,16.299577 L22.6659041,16.3929394 L22.6479163,16.4385923 L22.6105789,16.5281804 L22.5714342,16.61593 L22.5304927,16.7023832 L22.487765,16.7880822 L22.4657346,16.8308182 C22.2201441,17.3024437 21.8936771,17.7025712 21.4942661,18.0230539 C21.4960887,17.9505884 21.497533,17.8756872 21.4985008,17.7985782 L21.5,17.5502309 L21.5,9.01733666 L21.4985008,8.76898935 L21.4984144,8.74192331 L21.4955434,8.52963215 L21.4911629,8.32874285 L21.4852228,8.13870228 L21.477673,7.95895731 L21.4732788,7.87277283 L21.4632206,7.70743416 C21.4614011,7.68063582 21.4595092,7.65420884 21.4575441,7.6281417 L21.4448649,7.47596481 L21.4303757,7.33187102 L21.4140266,7.19530722 L21.3957674,7.06572029 L21.375548,6.94255708 L21.3533185,6.8252645 L21.3290287,6.71328939 C21.324806,6.69503927 21.3204953,6.67698767 21.3160956,6.65912305 L21.2886216,6.55408707 C21.2838618,6.53692433 21.279011,6.51992554 21.2740681,6.50307916 L21.2432972,6.40373778 C21.2273508,6.35488943 21.2105567,6.30720545 21.1928867,6.26037471 L21.1563706,6.1677587 L21.1174688,6.07686487 C21.1107836,6.06182868 21.1039969,6.04684121 21.0971076,6.03189092 L21.0545335,5.94254325 L21.0094484,5.85353495 C20.7134804,5.28516576 20.2881281,4.84831742 19.734716,4.54435025 L19.64805,4.49804672 L19.5610536,4.4543219 L19.4731882,4.41312436 C19.4584416,4.40646585 19.4436364,4.3999105 19.4287613,4.39345725 L19.3385825,4.35595422 C19.2929842,4.33780668 19.246555,4.32055866 19.1989922,4.30418125 L19.102265,4.27257866 C19.085862,4.26750217 19.0693105,4.26252028 19.0525994,4.2576319 L18.9503276,4.22941532 C18.9329331,4.22489674 18.9153565,4.22046954 18.8975866,4.21613265 L18.7885583,4.19118638 L18.6743523,4.16835606 L18.5544302,4.14759026 L18.4282535,4.12883756 L18.2952835,4.11204655 L18.1549816,4.09716581 L18.0068094,4.08414391 L17.8502282,4.07292945 C17.8234007,4.07120813 17.7962003,4.06955999 17.7686159,4.06798394 L17.5984115,4.05938421 L17.4184516,4.05246338 L17.2281978,4.04717001 L17.0271115,4.04345269 L16.894733,4.04206378 C16.8560284,4.04155436 16.8167527,4.04117489 16.7768869,4.04092211 L4.8458278,4.04054054 C4.6827364,4.04054054 4.52925026,4.04248559 4.38417877,4.04657982 C4.67638696,3.66396601 5.03476921,3.34660895 5.4541436,3.10098908 L5.58791999,3.02607916 L5.67136368,2.98219664 L5.7555418,2.94014866 L5.84098221,2.899946 L5.92821276,2.86159943 L5.97266429,2.84312555 L6.06356978,2.80758332 L6.15758506,2.77392411 L6.25523798,2.7421587 L6.35705641,2.71229786 L6.40969263,2.69808502 L6.51874904,2.67110123 C6.63046004,2.6450814 6.75039875,2.62195882 6.88094054,2.60178197 L7.01510466,2.58258883 L7.15686536,2.56537028 L7.23075937,2.55750485 L7.38490466,2.54326839 L7.54796616,2.53103346 L7.63300545,2.52566993 L7.81043101,2.51645748 L7.99809242,2.50927349 L8.19651756,2.50412873 L8.40623426,2.50103398 L8.6277704,2.5 L16.7126566,2.50024502 Z" id="___å½¢çŠ¶ç»“åˆ" fill="#ffffff" fill-rule="nonzero"/>
                                    </g>
                                </svg>
                            </button>
                            <button class="bank-btn info" id="infoMatchBankBtn" title="é¢˜åº“ä¿¡æ¯">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 24 24" version="1.1">
                                    <title>é¢˜åº“ä¿¡æ¯</title>
                                    <defs>
                                        <path d="M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z M12,2.5 C6.75329488,2.5 2.5,6.75329488 2.5,12 C2.5,17.2467051 6.75329488,21.5 12,21.5 C17.2467051,21.5 21.5,17.2467051 21.5,12 C21.5,6.75329488 17.2467051,2.5 12,2.5 Z M12,9.75 C12.4142136,9.75 12.75,10.0857864 12.75,10.5 L12.75,17.25 C12.75,17.6642136 12.4142136,18 12,18 C11.5857864,18 11.25,17.6642136 11.25,17.25 L11.25,10.5 C11.25,10.0857864 11.5857864,9.75 12,9.75 Z M12,6 C12.6903559,6 13.25,6.55964406 13.25,7.25 C13.25,7.94035594 12.6903559,8.5 12,8.5 C11.3096441,8.5 10.75,7.94035594 10.75,7.25 C10.75,6.55964406 11.3096441,6 12,6 Z" id="_path-1"/>
                                    </defs>
                                    <g id="_Public/ic_public_detail" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <mask id="_mask-2" fill="white">
                                            <use xlink:href="#_path-1"/>
                                        </mask>
                                        <use id="_å½¢çŠ¶ç»“åˆ" fill="#ffffff" fill-rule="nonzero" xlink:href="#_path-1"/>
                                    </g>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- é¢„è§ˆåŒºåŸŸï¼šæ˜¾ç¤ºå½“å‰é¢˜åº“çš„ç»Ÿè®¡ä¿¡æ¯åŠå‰å‡ æ¡é¢˜ç›®æ–‡æœ¬ -->
                    <div class="bank-preview" id="matchBankPreview">
                        <div class="bank-header" style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <div class="bank-stats" id="matchBankStats">é¢˜ç›®åŒ¹é…åº“: 0é¢˜ | æœ‰æ•ˆ: 0é¢˜ | åŸºç¡€ä¿¡æ¯: 0é¢˜</div>
                        </div>
                        <div class="bank-items" id="matchBankItems">
                            <div class="bank-item" style="border-left-color: #ff9800;">æš‚æ— é¢˜ç›®ï¼Œè¯·ç¼–è¾‘æ·»åŠ </div>
                        </div>
                    </div>
                </div>
                
                <!-- åˆ†å‰²çº¿ï¼šé¢˜åº“ç®¡ç†ï¼ˆåŸæœ‰ï¼‰ -->
                <h2 style="margin-top: 30px;">ğŸ’¾ é¢˜åº“ç®¡ç†</h2>
                <div class="bank-manager">
                    <div class="bank-selector">
                        <select class="bank-select" id="bankSelect">
                            <!-- é¢˜åº“é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                        </select>
                        <div class="bank-buttons">
                            <button class="bank-btn" id="addBankBtn" title="æ·»åŠ æ–°é¢˜åº“">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="44" height="44" viewBox="0 0 24 24" version="1.1">
                                    <title>æ·»åŠ æ–°é¢˜åº“</title>
                                    <desc>Created with Sketch.</desc>
                                    <g id="___Public/ic_public_list_add_light" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <path d="M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z" id="___æ¤­åœ†å½¢" fill="#0A59F7"/>
                                        <path d="M12.75,17.25 C12.75,17.6642136 12.4142136,18 12,18 C11.5857864,18 11.25,17.6642136 11.25,17.25 L11.25,12.749 L6.75,12.75 C6.33578644,12.75 6,12.4142136 6,12 C6,11.5857864 6.33578644,11.25 6.75,11.25 L11.25,11.249 L11.25,6.75 C11.25,6.33578644 11.5857864,6 12,6 C12.4142136,6 12.75,6.33578644 12.75,6.75 L12.75,17.25 Z M13.75,11.25 L17.25,11.25 C17.6642136,11.25 18,11.5857864 18,12 C18,12.4142136 17.6642136,12.75 17.25,12.75 L13.75,12.75 L13.75,11.25 Z" id="___å½¢çŠ¶" fill="#FFFFFF"/>
                                    </g>
                                </svg>
                            </button>
                            <button class="bank-btn edit" id="editBankBtn" title="ç¼–è¾‘å½“å‰é¢˜åº“">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24" version="1.1">
                                    <title>ç¼–è¾‘å½“å‰é¢˜åº“</title>
                                    <defs>
                                        <path d="M16.8722296,2 C17.8721999,2 18.5147251,2.05839169 19.0012003,2.17117304 L17.6599443,3.51379911 C17.4862664,3.50652642 17.2928183,3.5022817 17.0753381,3.50070655 L7.02453833,3.50017541 L6.82305804,3.501658 C5.6550816,3.5151767 5.20981608,3.61305534 4.75370688,3.8569852 C4.36325774,4.06579969 4.06579969,4.36325774 3.8569852,4.75370688 C3.59290159,5.24750032 3.5,5.72858421 3.5,7.1277704 L3.50017541,16.9754617 L3.501658,17.176942 C3.5151767,18.3449184 3.61305534,18.7901839 3.8569852,19.2462931 C4.06579969,19.6367423 4.36325774,19.9342003 4.75370688,20.1430148 C5.22281064,20.3938942 5.68044405,20.4902819 6.92466189,20.4992935 L16.8722296,20.5 C18.2714158,20.5 18.7524997,20.4070984 19.2462931,20.1430148 C19.6367423,19.9342003 19.9342003,19.6367423 20.1430148,19.2462931 C20.3938942,18.7771894 20.4902819,18.319556 20.4992935,17.0753381 L20.5,16.8722296 L20.5,7.1277704 C20.5,6.82616011 20.4956832,6.56721095 20.4862654,6.34159954 L21.8289375,4.9992768 C21.9416465,5.48569497 22,6.12812696 22,7.1277704 L22,16.8722296 L21.9989932,17.0937657 C21.9842401,18.674381 21.8076257,19.3015622 21.487765,19.91208 L21.4657346,19.9536914 C21.1337211,20.5745027 20.6538954,21.0680807 20.0458564,21.4148264 L19.9536914,21.4657346 C19.3018396,21.8143488 18.6552671,22 16.8722296,22 L7.1277704,22 L6.90623426,21.9989932 C5.32561899,21.9842401 4.69843783,21.8076257 4.08791999,21.487765 L4.04630859,21.4657346 C3.42549731,21.1337211 2.93191931,20.6538954 2.58517358,20.0458564 L2.53426541,19.9536914 C2.18565122,19.3018396 2,18.6552671 2,16.8722296 L2,7.1277704 C2,5.38266989 2.17783521,4.72618864 2.51223497,4.08791999 L2.53426541,4.04630859 C2.86627892,3.42549731 3.34610464,2.93191931 3.9541436,2.58517358 L4.04630859,2.53426541 C4.69816044,2.18565122 5.34473292,2 7.1277704,2 L16.8722296,2 Z M22.2300776,1.76992245 C22.6206018,2.16044674 22.6206018,2.79361172 22.2300776,3.18413601 L12.684136,12.7300776 C12.2936117,13.1206018 11.6604467,13.1206018 11.2699224,12.7300776 C10.8793982,12.3395533 10.8793982,11.7063883 11.2699224,11.315864 L20.815864,1.76992245 C21.2063883,1.37939815 21.8395533,1.37939815 22.2300776,1.76992245 Z" id="_____path-1"/>
                                    </defs>
                                    <g id="_____Public/ic_public_edit" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <mask id="_____mask-2" fill="white">
                                            <use xlink:href="#_____path-1"/>
                                        </mask>
                                        <use id="_____å½¢çŠ¶ç»“åˆ" fill="#ffffff" fill-rule="nonzero" xlink:href="#_____path-1"/>
                                    </g>
                                </svg>
                            </button>
                            <button class="bank-btn delete" id="deleteBankBtn" title="åˆ é™¤å½“å‰é¢˜åº“">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="44" height="44" viewBox="0 0 24 24" version="1.1">
                                    <title>åˆ é™¤å½“å‰é¢˜åº“</title>
                                    <desc>Created with Sketch.</desc>
                                    <g id="___Public/ic_public_list_deleted" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <circle id="___colorError" fill="#E84026" cx="12" cy="12" r="11"/>
                                        <path d="M8.81801948,16.2426407 C8.52512627,16.5355339 8.05025253,16.5355339 7.75735931,16.2426407 C7.46446609,15.9497475 7.46446609,15.4748737 7.75735931,15.1819805 L10.9400469,11.9992929 L7.75735931,8.81801948 C7.46446609,8.52512627 7.46446609,8.05025253 7.75735931,7.75735931 C8.05025253,7.46446609 8.52512627,7.46446609 8.81801948,7.75735931 L12.0007071,10.9386327 L15.1819805,7.75735931 C15.4748737,7.46446609 15.9497475,7.46446609 16.2426407,7.75735931 C16.5355339,8.05025253 16.5355339,8.52512627 16.2426407,8.81801948 L8.81801948,16.2426407 Z M13.767767,12.7071068 L16.2426407,15.1819805 C16.5355339,15.4748737 16.5355339,15.9497475 16.2426407,16.2426407 C15.9497475,16.5355339 15.4748737,16.5355339 15.1819805,16.2426407 L12.7071068,13.767767 L13.767767,12.7071068 Z" id="___å½¢çŠ¶" fill="#FFFFFF"/>
                                    </g>
                                </svg>
                            </button>
                            <button class="bank-btn import" id="importBankBtn" title="å¯¼å…¥é¢˜åº“">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1">
                                    <title>å¯¼å…¥é¢˜åº“</title>
                                    <g id="___ic_gallery_move_in_10" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <path d="M9.80582194,12.4707394 C10.4919646,11.8294422 11.5682572,11.8433835 12.2374369,12.5125631 L12.2374369,12.5125631 L14.7803301,15.0554564 L14.8105907,15.0875175 C15.0728497,15.382037 15.0627628,15.8336838 14.7803301,16.1161165 C14.4874369,16.4090097 14.0125631,16.4090097 13.7196699,16.1161165 L13.7196699,16.1161165 L11.748,14.1457864 L11.7484143,22.0857864 C11.7484143,22.5 11.4126279,22.8357864 10.9984143,22.8357864 C10.5842008,22.8357864 10.2484143,22.5 10.2484143,22.0857864 L10.2484143,22.0857864 L10.248,14.1487864 L8.28033009,16.1161165 L8.2482689,16.1463772 C7.95374943,16.4086362 7.50210266,16.3985493 7.21966991,16.1161165 C6.9267767,15.8232233 6.9267767,15.3483496 7.21966991,15.0554564 L7.21966991,15.0554564 L9.76256313,12.5125631 Z M16.0132009,5.06756757 L16.2245442,5.06864828 L16.4235832,5.07188219 L16.610921,5.07725701 L16.7871609,5.08476043 L16.952906,5.09438012 L17.1087593,5.10610379 C17.436161,5.13377548 17.6981555,5.17617598 17.9223487,5.23274189 L18.0232389,5.25985301 C18.0396401,5.26453848 18.0558427,5.26930726 18.0718594,5.27415909 L18.1658281,5.30426462 L18.2559364,5.33635102 L18.3427875,5.370406 L18.4269844,5.40641724 C18.4408295,5.41258145 18.4545892,5.41882666 18.468276,5.42515261 L18.5496226,5.46407517 L18.5898283,5.48425928 L18.6696816,5.52606546 C18.6829536,5.53319242 18.6962156,5.54039883 18.70948,5.54768445 C19.2798504,5.86096612 19.7274804,6.32069423 20.0325178,6.90648002 L20.0741537,6.98829002 C20.0809381,7.0019543 20.0876449,7.01564183 20.0942739,7.0293655 L20.133111,7.11224457 L20.1518251,7.15420301 L20.1878366,7.23954487 L20.205131,7.28308314 L20.2382898,7.37228151 L20.2695318,7.46482519 L20.2988451,7.56133361 L20.3127747,7.61126816 L20.3391724,7.71488512 C20.390013,7.92742588 20.4291013,8.17304656 20.4560058,8.47404676 L20.4684408,8.62926507 L20.4788331,8.79433272 C20.4803943,8.82269919 20.4818699,8.85150186 20.4832596,8.88075363 L20.4905655,9.06175676 L20.4957989,9.25415783 L20.4989477,9.45857626 L20.5,9.67563151 L20.5,16.8919361 L20.4989477,17.1089913 L20.4957989,17.3134097 L20.4905655,17.5058108 L20.4832596,17.6868139 L20.473893,17.8570386 L20.4624779,18.0171041 C20.4355344,18.3533545 20.3942497,18.62243 20.3391724,18.8526824 L20.3127747,18.9562994 L20.2988451,19.006234 L20.2695318,19.1027424 L20.2382898,19.1952861 L20.205131,19.2844844 L20.1700674,19.3709569 C20.1640654,19.3851763 20.1579846,19.3993078 20.1518251,19.4133646 L20.1139268,19.4969097 C20.1074539,19.5107186 20.1009028,19.5244784 20.0942739,19.5382021 L20.0535678,19.6202136 C20.0466284,19.6338443 20.0396117,19.6474646 20.0325178,19.6610875 C19.7274804,20.2468733 19.2798504,20.7066014 18.70948,21.0198831 L18.6298229,21.0626443 L18.6098473,21.0730362 L18.5091303,21.1231951 C18.4955767,21.1296823 18.4819628,21.136089 18.468276,21.142415 L18.38518,21.1793997 C18.3711514,21.1854017 18.3570247,21.1913224 18.3427875,21.1971616 L18.2559364,21.2312165 L18.1658281,21.263303 L18.0718594,21.2934085 L18.0232389,21.3077146 L17.9223487,21.3348257 C17.7154011,21.3870404 17.4762441,21.4271851 17.183165,21.4548168 L17.0320314,21.4675878 L16.8713076,21.4782611 L16.7871609,21.4828071 L16.610921,21.4903106 L16.4235832,21.4956854 L16.2245442,21.4989193 L16.0132009,21.5 L12.748,21.5 L12.747,19.959 L16.1110218,19.9592782 L16.2959116,19.9578034 L16.4671632,19.9547896 L16.6256139,19.9501701 L16.7721008,19.9438779 L16.9074611,19.9358462 L17.032532,19.9260081 L17.1481507,19.9142968 C17.1666793,19.9121851 17.184849,19.9099926 17.2026772,19.9077179 L17.3056874,19.8930714 L17.4013385,19.8763846 L17.4904676,19.8575906 C17.5766148,19.8377206 17.6542349,19.8145896 17.7270953,19.7878966 L17.7985086,19.7600051 L17.867586,19.7296721 L17.9351646,19.6968307 L18.0020817,19.6614141 C18.3110494,19.4917105 18.5445603,19.2518885 18.709798,18.9345704 L18.7442825,18.8658447 L18.7762597,18.7964396 L18.8057944,18.7254953 L18.8329519,18.6521519 C18.8589425,18.5773223 18.8814648,18.4976044 18.9008119,18.4091289 L18.9191113,18.3175909 L18.935359,18.2193546 L18.94962,18.1135603 C18.9518349,18.0952503 18.9539697,18.0765896 18.9560259,18.0575602 L18.9674289,17.9388166 L18.9770081,17.8103654 L18.9848284,17.6713467 L18.9909551,17.5209008 L18.995453,17.3581676 L18.9983875,17.1822876 L18.9998235,16.9924007 L18.9998235,9.57516684 L18.9983875,9.38527999 L18.995453,9.20939992 L18.9909551,9.04666682 L18.9848284,8.89622084 L18.9770081,8.75720216 L18.9674289,8.62875094 L18.9560259,8.51000736 C18.9539697,8.49097797 18.9518349,8.47231723 18.94962,8.45400724 L18.935359,8.34821293 L18.9191113,8.24997668 L18.9008119,8.15843866 C18.8814648,8.06996315 18.8589425,7.99024523 18.8329519,7.91541567 L18.8057944,7.84207227 L18.7762597,7.77112793 L18.7442825,7.70172285 L18.709798,7.63299718 C18.5445603,7.31567904 18.3110494,7.07585703 18.0020817,6.90615343 L17.9351646,6.87073684 L17.867586,6.83789547 L17.7985086,6.80756248 L17.7270953,6.77967099 C17.6542349,6.75297797 17.5766148,6.72984693 17.4904676,6.709977 L17.4013385,6.69118297 L17.3056874,6.67449616 L17.2026772,6.65984971 L17.1481507,6.65327073 L17.032532,6.64155946 L16.9074611,6.63172141 L16.7721008,6.62368971 L16.6256139,6.61739751 L16.4671632,6.61277796 L16.2959116,6.60976418 L16.1110218,6.60828933 L5.38897824,6.60828933 L5.19886103,6.60983053 L4.94044884,6.61522674 L4.78468461,6.62098685 L4.64106334,6.62856215 L4.50867177,6.63802558 C4.48749158,6.63976421 4.46674125,6.64158456 4.44640173,6.64348813 L4.32914234,6.65592051 C4.2915977,6.66040566 4.25554415,6.66523588 4.22082948,6.67042334 L4.12054988,6.68706956 L4.02739027,6.70593211 L3.94043739,6.72708392 L3.85877796,6.75059792 C3.80589988,6.76707753 3.75594193,6.78518055 3.70768641,6.80500423 L3.63642775,6.8360424 L3.56680947,6.86973449 L3.49791831,6.90615343 C3.18895065,7.07585703 2.95543974,7.31567904 2.79020203,7.63299718 L2.75571745,7.70172285 L2.72374033,7.77112793 L2.69420557,7.84207227 L2.66704807,7.91541567 C2.6410575,7.99024523 2.61853517,8.06996315 2.59918813,8.15843866 L2.58088868,8.24997668 L2.564641,8.34821293 L2.55037998,8.45400724 C2.54816509,8.47231723 2.54603025,8.49097797 2.54397413,8.51000736 L2.53257105,8.62875094 L2.5229919,8.75720216 L2.51517156,8.89622084 L2.50904495,9.04666682 L2.50454696,9.20939992 L2.50161249,9.38527999 L2.50017645,9.57516684 L2.50017645,16.9924007 L2.50161249,17.1822876 L2.50454696,17.3581676 L2.50904495,17.5209008 L2.51517156,17.6713467 L2.5229919,17.8103654 L2.53257105,17.9388166 L2.54397413,18.0575602 C2.54603025,18.0765896 2.54816509,18.0952503 2.55037998,18.1135603 L2.564641,18.2193546 L2.58088868,18.3175909 L2.59918813,18.4091289 C2.61853517,18.4976044 2.6410575,18.5773223 2.66704807,18.6521519 L2.69420557,18.7254953 L2.72374033,18.7964396 L2.75571745,18.8658447 L2.79020203,18.9345704 C2.95543974,19.2518885 3.18895065,19.4917105 3.49791831,19.6614141 L3.56483541,19.6968307 L3.63241404,19.7296721 L3.70149142,19.7600051 L3.77290473,19.7878966 C3.84576509,19.8145896 3.92338517,19.8377206 4.00953238,19.8575906 L4.09866151,19.8763846 L4.19431259,19.8930714 L4.29732284,19.9077179 C4.31515099,19.9099926 4.33332065,19.9121851 4.35184927,19.9142968 L4.46746802,19.9260081 L4.59253894,19.9358462 L4.72789924,19.9438779 L4.87438611,19.9501701 L5.03283677,19.9547896 L5.20408841,19.9578034 L5.38897824,19.9592782 L9.248,19.959 L9.248,21.5 L5.4867991,21.5 L5.27545584,21.4989193 L5.07641683,21.4956854 L4.88907895,21.4903106 L4.71283906,21.4828071 L4.54709404,21.4731874 L4.39124074,21.4614638 C4.06383903,21.4337921 3.80184451,21.3913916 3.5776513,21.3348257 L3.47676111,21.3077146 L3.42814062,21.2934085 L3.3341719,21.263303 L3.24406358,21.2312165 L3.15721253,21.1971616 L3.07301562,21.1611503 C3.05917047,21.1549861 3.04541078,21.1487409 3.03172398,21.142415 L2.9503774,21.1034924 L2.91017167,21.0833083 L2.83031837,21.0415021 L2.79052002,21.0198831 C2.22014965,20.7066014 1.77251964,20.2468733 1.46748223,19.6610875 L1.42584629,19.5792775 C1.41906187,19.5656133 1.41235507,19.5519257 1.40572614,19.5382021 L1.36688895,19.455323 L1.34817491,19.4133646 L1.31216344,19.3280227 L1.294869,19.2844844 L1.2617102,19.1952861 L1.23046818,19.1027424 L1.20115491,19.006234 L1.1872253,18.9562994 L1.16082763,18.8526824 C1.10998702,18.6401417 1.07089871,18.394521 1.04399417,18.0935208 L1.03155921,17.9383025 L1.02116686,17.7732348 C1.01960569,17.7448684 1.01813012,17.7160657 1.01674041,17.6868139 L1.00943446,17.5058108 L1.00420108,17.3134097 L1.00105227,17.1089913 L1,16.8919361 L1.00026332,9.56548557 L1.00236536,9.35482616 L1.00420108,9.25415783 L1.00943446,9.06175676 L1.01674041,8.88075363 L1.02610696,8.71052901 L1.03752211,8.55046346 C1.0644656,8.21421306 1.1057503,7.94513761 1.16082763,7.71488512 L1.1872253,7.61126816 L1.20115491,7.56133361 L1.23046818,7.46482519 L1.2617102,7.37228151 L1.294869,7.28308314 L1.32993257,7.19661063 C1.33593457,7.18239129 1.34201543,7.16825972 1.34817491,7.15420301 L1.38607319,7.07065787 L1.39584117,7.04997973 L1.44643216,6.947354 C1.45337156,6.9337233 1.46038834,6.92010294 1.46748223,6.90648002 C1.77251964,6.32069423 2.22014965,5.86096612 2.79052002,5.54768445 L2.87017712,5.50492322 L2.99086971,5.44437244 C3.00442328,5.43788526 3.01803719,5.43147856 3.03172398,5.42515261 L3.11482,5.38816785 C3.12884863,5.38216589 3.14297529,5.37624519 3.15721253,5.370406 L3.24406358,5.33635102 L3.3341719,5.30426462 L3.42814062,5.27415909 C3.44415728,5.26930726 3.46035992,5.26453848 3.47676111,5.25985301 L3.5776513,5.23274189 C3.78459888,5.18052721 4.02375586,5.14038246 4.31683501,5.11275077 L4.46796862,5.09997973 L4.62869239,5.08930651 C4.65631237,5.08770314 4.68435707,5.08618769 4.71283906,5.08476043 L4.88907895,5.07725701 L5.07641683,5.07188219 L5.27545584,5.06864828 L5.4867991,5.06756757 L16.0132009,5.06756757 Z M16.7126566,2.50024502 L16.9488443,2.50220182 L17.1739926,2.50610692 L17.3885365,2.51195144 L17.592911,2.51972649 L17.7875512,2.5294232 L17.9728921,2.54103269 L18.1493689,2.55454609 L18.3174165,2.5699545 L18.47747,2.58724907 L18.6299644,2.60642089 C18.6795844,2.61312339 18.728017,2.62013729 18.7753348,2.6274611 L18.9140163,2.65036082 L18.9809847,2.66250522 L19.1104484,2.68817755 C19.1315468,2.69260963 19.1524119,2.69711826 19.1730526,2.70170327 L19.2942775,2.73012824 C19.3140572,2.73501798 19.3336307,2.73998372 19.353007,2.74502527 L19.4669719,2.7761829 L19.5223161,2.79244127 L19.6299999,2.82631158 L19.7340401,2.86197925 L19.8348717,2.89943539 L19.9329298,2.93867113 C19.9490659,2.94535823 19.9651045,2.95211911 19.9810548,2.95895358 L20.0757683,3.00084207 L20.168796,3.04448796 L20.2605729,3.08988238 L20.4421143,3.18588127 C21.2569291,3.6334265 21.8964005,4.29018095 22.3321682,5.12701779 L22.3797471,5.22004624 L22.4256408,5.31346571 L22.4698407,5.40772301 L22.512338,5.50326496 L22.5531241,5.60053836 L22.5921905,5.69999001 C22.6112923,5.75033487 22.6297459,5.80166412 22.6475465,5.85422911 L22.6822756,5.96108118 L22.7152546,6.07167534 L22.7464748,6.18645839 C22.7565875,6.22546721 22.7664056,6.26524863 22.7759278,6.30587715 L22.8036047,6.4303784 C22.8080691,6.45157698 22.812459,6.47300594 22.8167745,6.4946746 L22.8417712,6.62763738 C22.8457878,6.65030206 22.8497295,6.67322505 22.853596,6.69641567 L22.8758931,6.83884529 C22.8794587,6.86314363 22.8829488,6.88772821 22.8863633,6.91260833 L22.9059413,7.06551012 C22.9090525,7.09160967 22.9120878,7.11802338 22.915047,7.14476057 L22.9318864,7.30913983 L22.9468893,7.48172925 L22.9600471,7.66297565 L22.9713511,7.85332582 L22.9807926,8.05322657 L22.9883631,8.26312472 L22.9940538,8.48346707 L22.9978561,8.71470042 L22.9997614,8.95727159 L23,13.6660736 L22.9989932,13.8935972 L22.9959799,14.108982 L22.9909705,14.3127699 L22.9839756,14.5055033 L22.9750056,14.6877241 L22.964071,14.8599746 L22.9511823,15.0227968 C22.9465615,15.0755597 22.9416169,15.1268416 22.93635,15.1767329 L22.9195846,15.3223249 L22.9008965,15.4601151 C22.8812506,15.5941851 22.8587365,15.7173654 22.8334014,15.8320956 L22.8071277,15.9440995 L22.7932889,15.9981583 L22.7642139,16.1027286 L22.7332844,16.2030207 L22.700511,16.299577 L22.6659041,16.3929394 L22.6479163,16.4385923 L22.6105789,16.5281804 L22.5714342,16.61593 L22.5304927,16.7023832 L22.487765,16.7880822 L22.4657346,16.8308182 C22.2201441,17.3024437 21.8936771,17.7025712 21.4942661,18.0230539 C21.4960887,17.9505884 21.497533,17.8756872 21.4985008,17.7985782 L21.5,17.5502309 L21.5,9.01733666 L21.4985008,8.76898935 L21.4984144,8.74192331 L21.4955434,8.52963215 L21.4911629,8.32874285 L21.4852228,8.13870228 L21.477673,7.95895731 L21.4732788,7.87277283 L21.4632206,7.70743416 C21.4614011,7.68063582 21.4595092,7.65420884 21.4575441,7.6281417 L21.4448649,7.47596481 L21.4303757,7.33187102 L21.4140266,7.19530722 L21.3957674,7.06572029 L21.375548,6.94255708 L21.3533185,6.8252645 L21.3290287,6.71328939 C21.324806,6.69503927 21.3204953,6.67698767 21.3160956,6.65912305 L21.2886216,6.55408707 C21.2838618,6.53692433 21.279011,6.51992554 21.2740681,6.50307916 L21.2432972,6.40373778 C21.2273508,6.35488943 21.2105567,6.30720545 21.1928867,6.26037471 L21.1563706,6.1677587 L21.1174688,6.07686487 C21.1107836,6.06182868 21.1039969,6.04684121 21.0971076,6.03189092 L21.0545335,5.94254325 L21.0094484,5.85353495 C20.7134804,5.28516576 20.2881281,4.84831742 19.734716,4.54435025 L19.64805,4.49804672 L19.5610536,4.4543219 L19.4731882,4.41312436 C19.4584416,4.40646585 19.4436364,4.3999105 19.4287613,4.39345725 L19.3385825,4.35595422 C19.2929842,4.33780668 19.246555,4.32055866 19.1989922,4.30418125 L19.102265,4.27257866 C19.085862,4.26750217 19.0693105,4.26252028 19.0525994,4.2576319 L18.9503276,4.22941532 C18.9329331,4.22489674 18.9153565,4.22046954 18.8975866,4.21613265 L18.7885583,4.19118638 L18.6743523,4.16835606 L18.5544302,4.14759026 L18.4282535,4.12883756 L18.2952835,4.11204655 L18.1549816,4.09716581 L18.0068094,4.08414391 L17.8502282,4.07292945 C17.8234007,4.07120813 17.7962003,4.06955999 17.7686159,4.06798394 L17.5984115,4.05938421 L17.4184516,4.05246338 L17.2281978,4.04717001 L17.0271115,4.04345269 L16.894733,4.04206378 C16.8560284,4.04155436 16.8167527,4.04117489 16.7768869,4.04092211 L4.8458278,4.04054054 C4.6827364,4.04054054 4.52925026,4.04248559 4.38417877,4.04657982 C4.67638696,3.66396601 5.03476921,3.34660895 5.4541436,3.10098908 L5.58791999,3.02607916 L5.67136368,2.98219664 L5.7555418,2.94014866 L5.84098221,2.899946 L5.92821276,2.86159943 L5.97266429,2.84312555 L6.06356978,2.80758332 L6.15758506,2.77392411 L6.25523798,2.7421587 L6.35705641,2.71229786 L6.40969263,2.69808502 L6.51874904,2.67110123 C6.63046004,2.6450814 6.75039875,2.62195882 6.88094054,2.60178197 L7.01510466,2.58258883 L7.15686536,2.56537028 L7.23075937,2.55750485 L7.38490466,2.54326839 L7.54796616,2.53103346 L7.63300545,2.52566993 L7.81043101,2.51645748 L7.99809242,2.50927349 L8.19651756,2.50412873 L8.40623426,2.50103398 L8.6277704,2.5 L16.7126566,2.50024502 Z" id="___å½¢çŠ¶ç»“åˆ" fill="#ffffff" fill-rule="nonzero"/>
                                    </g>
                                </svg>
                            </button>
                            <button class="bank-btn export" id="exportBankBtn" title="å¯¼å‡ºå½“å‰é¢˜åº“">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1">
                                    <title>å¯¼å‡ºå½“å‰é¢˜åº“</title>
                                    <g id="___ic_gallery_move_out" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <path d="M10.9984143,12 C11.4126279,12 11.7484143,12.3357864 11.7484143,12.75 L11.748,20.69 L13.7196699,18.7196699 C14.0125631,18.4267767 14.4874369,18.4267767 14.7803301,18.7196699 C15.0627628,19.0021027 15.0728497,19.4537494 14.8105907,19.7482689 L14.7803301,19.7803301 L12.2374369,22.3232233 C11.5682572,22.992403 10.4919646,23.0063442 9.80582194,22.365047 L9.76256313,22.3232233 L7.21966991,19.7803301 C6.9267767,19.4874369 6.9267767,19.0125631 7.21966991,18.7196699 C7.50210266,18.4372372 7.95374943,18.4271503 8.2482689,18.6894093 L8.28033009,18.7196699 L10.248,20.687 L10.2484143,12.75 C10.2484143,12.3357864 10.5842008,12 10.9984143,12 Z M16.0132009,5.06756757 L16.2245442,5.06864828 L16.4235832,5.07188219 L16.610921,5.07725701 L16.7871609,5.08476043 L16.952906,5.09438012 L17.1087593,5.10610379 C17.436161,5.13377548 17.6981555,5.17617598 17.9223487,5.23274189 L18.0232389,5.25985301 C18.0396401,5.26453848 18.0558427,5.26930726 18.0718594,5.27415909 L18.1658281,5.30426462 L18.2559364,5.33635102 L18.3427875,5.370406 L18.4269844,5.40641724 C18.4408295,5.41258145 18.4545892,5.41882666 18.468276,5.42515261 L18.5496226,5.46407517 L18.5898283,5.48425928 L18.6696816,5.52606546 C18.6829536,5.53319242 18.6962156,5.54039883 18.70948,5.54768445 C19.2798504,5.86096612 19.7274804,6.32069423 20.0325178,6.90648002 L20.0741537,6.98829002 C20.0809381,7.0019543 20.0876449,7.01564183 20.0942739,7.0293655 L20.133111,7.11224457 L20.1518251,7.15420301 L20.1878366,7.23954487 L20.205131,7.28308314 L20.2382898,7.37228151 L20.2695318,7.46482519 L20.2988451,7.56133361 L20.3127747,7.61126816 L20.3391724,7.71488512 C20.390013,7.92742588 20.4291013,8.17304656 20.4560058,8.47404676 L20.4684408,8.62926507 L20.4788331,8.79433272 C20.4803943,8.82269919 20.4818699,8.85150186 20.4832596,8.88075363 L20.4905655,9.06175676 L20.4957989,9.25415783 L20.4989477,9.45857626 L20.5,9.67563151 L20.5,16.8919361 L20.4989477,17.1089913 L20.4957989,17.3134097 L20.4905655,17.5058108 L20.4832596,17.6868139 L20.473893,17.8570386 L20.4624779,18.0171041 C20.4355344,18.3533545 20.3942497,18.62243 20.3391724,18.8526824 L20.3127747,18.9562994 L20.2988451,19.006234 L20.2695318,19.1027424 L20.2382898,19.1952861 L20.205131,19.2844844 L20.1700674,19.3709569 C20.1640654,19.3851763 20.1579846,19.3993078 20.1518251,19.4133646 L20.1139268,19.4969097 C20.1074539,19.5107186 20.1009028,19.5244784 20.0942739,19.5382021 L20.0535678,19.6202136 C20.0466284,19.6338443 20.0396117,19.6474646 20.0325178,19.6610875 C19.7274804,20.2468733 19.2798504,20.7066014 18.70948,21.0198831 L18.6298229,21.0626443 L18.6098473,21.0730362 L18.5091303,21.1231951 C18.4955767,21.1296823 18.4819628,21.136089 18.468276,21.142415 L18.38518,21.1793997 C18.3711514,21.1854017 18.3570247,21.1913224 18.3427875,21.1971616 L18.2559364,21.2312165 L18.1658281,21.263303 L18.0718594,21.2934085 L18.0232389,21.3077146 L17.9223487,21.3348257 C17.7154011,21.3870404 17.4762441,21.4271851 17.183165,21.4548168 L17.0320314,21.4675878 L16.8713076,21.4782611 L16.7871609,21.4828071 L16.610921,21.4903106 L16.4235832,21.4956854 L16.2245442,21.4989193 L16.0132009,21.5 L14.478,21.5 L16.019,19.959 L16.1110218,19.9592782 L16.2959116,19.9578034 L16.4671632,19.9547896 L16.6256139,19.9501701 L16.7721008,19.9438779 L16.9074611,19.9358462 L17.032532,19.9260081 L17.1481507,19.9142968 C17.1666793,19.9121851 17.184849,19.9099926 17.2026772,19.9077179 L17.3056874,19.8930714 L17.4013385,19.8763846 L17.4904676,19.8575906 C17.5766148,19.8377206 17.6542349,19.8145896 17.7270953,19.7878966 L17.7985086,19.7600051 L17.867586,19.7296721 L17.9351646,19.6968307 L18.0020817,19.6614141 C18.3110494,19.4917105 18.5445603,19.2518885 18.709798,18.9345704 L18.7442825,18.8658447 L18.7762597,18.7964396 L18.8057944,18.7254953 L18.8329519,18.6521519 C18.8589425,18.5773223 18.8814648,18.4976044 18.9008119,18.4091289 L18.9191113,18.3175909 L18.935359,18.2193546 L18.94962,18.1135603 C18.9518349,18.0952503 18.9539697,18.0765896 18.9560259,18.0575602 L18.9674289,17.9388166 L18.9770081,17.8103654 L18.9848284,17.6713467 L18.9909551,17.5209008 L18.995453,17.3581676 L18.9983875,17.1822876 L18.9998235,16.9924007 L18.9998235,9.57516684 L18.9983875,9.38527999 L18.995453,9.20939992 L18.9909551,9.04666682 L18.9848284,8.89622084 L18.9770081,8.75720216 L18.9674289,8.62875094 L18.9560259,8.51000736 C18.9539697,8.49097797 18.9518349,8.47231723 18.94962,8.45400724 L18.935359,8.34821293 L18.9191113,8.24997668 L18.9008119,8.15843866 C18.8814648,8.06996315 18.8589425,7.99024523 18.8329519,7.91541567 L18.8057944,7.84207227 L18.7762597,7.77112793 L18.7442825,7.70172285 L18.709798,7.63299718 C18.5445603,7.31567904 18.3110494,7.07585703 18.0020817,6.90615343 L17.9351646,6.87073684 L17.867586,6.83789547 L17.7985086,6.80756248 L17.7270953,6.77967099 C17.6542349,6.75297797 17.5766148,6.72984693 17.4904676,6.709977 L17.4013385,6.69118297 L17.3056874,6.67449616 L17.2026772,6.65984971 L17.1481507,6.65327073 L17.032532,6.64155946 L16.9074611,6.63172141 L16.7721008,6.62368971 L16.6256139,6.61739751 L16.4671632,6.61277796 L16.2959116,6.60976418 L16.1110218,6.60828933 L5.38897824,6.60828933 L5.19886103,6.60983053 L4.94044884,6.61522674 L4.78468461,6.62098685 L4.64106334,6.62856215 L4.50867177,6.63802558 C4.48749158,6.63976421 4.46674125,6.64158456 4.44640173,6.64348813 L4.32914234,6.65592051 C4.2915977,6.66040566 4.25554415,6.66523588 4.22082948,6.67042334 L4.12054988,6.68706956 L4.02739027,6.70593211 L3.94043739,6.72708392 L3.85877796,6.75059792 C3.80589988,6.76707753 3.75594193,6.78518055 3.70768641,6.80500423 L3.63642775,6.8360424 L3.56680947,6.86973449 L3.49791831,6.90615343 C3.18895065,7.07585703 2.95543974,7.31567904 2.79020203,7.63299718 L2.75571745,7.70172285 L2.72374033,7.77112793 L2.69420557,7.84207227 L2.66704807,7.91541567 C2.6410575,7.99024523 2.61853517,8.06996315 2.59918813,8.15843866 L2.58088868,8.24997668 L2.564641,8.34821293 L2.55037998,8.45400724 C2.54816509,8.47231723 2.54603025,8.49097797 2.54397413,8.51000736 L2.53257105,8.62875094 L2.5229919,8.75720216 L2.51517156,8.89622084 L2.50904495,9.04666682 L2.50454696,9.20939992 L2.50161249,9.38527999 L2.50017645,9.57516684 L2.50017645,16.9924007 L2.50161249,17.1822876 L2.50454696,17.3581676 L2.50904495,17.5209008 L2.51517156,17.6713467 L2.5229919,17.8103654 L2.53257105,17.9388166 L2.54397413,18.0575602 C2.54603025,18.0765896 2.54816509,18.0952503 2.55037998,18.1135603 L2.564641,18.2193546 L2.58088868,18.3175909 L2.59918813,18.4091289 C2.61853517,18.4976044 2.6410575,18.5773223 2.66704807,18.6521519 L2.69420557,18.7254953 L2.72374033,18.7964396 L2.75571745,18.8658447 L2.79020203,18.9345704 C2.95543974,19.2518885 3.18895065,19.4917105 3.49791831,19.6614141 L3.56483541,19.6968307 L3.63241404,19.7296721 L3.70149142,19.7600051 L3.77290473,19.7878966 C3.84576509,19.8145896 3.92338517,19.8377206 4.00953238,19.8575906 L4.09866151,19.8763846 L4.19431259,19.8930714 L4.29732284,19.9077179 C4.31515099,19.9099926 4.33332065,19.9121851 4.35184927,19.9142968 L4.46746802,19.9260081 L4.59253894,19.9358462 L4.72789924,19.9438779 L4.87438611,19.9501701 L5.03283677,19.9547896 L5.20408841,19.9578034 L5.38897824,19.9592782 L5.98,19.959 L7.521,21.5 L5.4867991,21.5 L5.27545584,21.4989193 L5.07641683,21.4956854 L4.88907895,21.4903106 L4.71283906,21.4828071 L4.54709404,21.4731874 L4.39124074,21.4614638 C4.06383903,21.4337921 3.80184451,21.3913916 3.5776513,21.3348257 L3.47676111,21.3077146 L3.42814062,21.2934085 L3.3341719,21.263303 L3.24406358,21.2312165 L3.15721253,21.1971616 L3.07301562,21.1611503 C3.05917047,21.1549861 3.04541078,21.1487409 3.03172398,21.142415 L2.9503774,21.1034924 L2.91017167,21.0833083 L2.83031837,21.0415021 L2.79052002,21.0198831 C2.22014965,20.7066014 1.77251964,20.2468733 1.46748223,19.6610875 L1.42584629,19.5792775 C1.41906187,19.5656133 1.41235507,19.5519257 1.40572614,19.5382021 L1.36688895,19.455323 L1.34817491,19.4133646 L1.31216344,19.3280227 L1.294869,19.2844844 L1.2617102,19.1952861 L1.23046818,19.1027424 L1.20115491,19.006234 L1.1872253,18.9562994 L1.16082763,18.8526824 C1.10998702,18.6401417 1.07089871,18.394521 1.04399417,18.0935208 L1.03155921,17.9383025 L1.02116686,17.7732348 C1.01960569,17.7448684 1.01813012,17.7160657 1.01674041,17.6868139 L1.00943446,17.5058108 L1.00420108,17.3134097 L1.00105227,17.1089913 L1,16.8919361 L1.00026332,9.56548557 L1.00236536,9.35482616 L1.00420108,9.25415783 L1.00943446,9.06175676 L1.01674041,8.88075363 L1.02610696,8.71052901 L1.03752211,8.55046346 C1.0644656,8.21421306 1.1057503,7.94513761 1.16082763,7.71488512 L1.1872253,7.61126816 L1.20115491,7.56133361 L1.23046818,7.46482519 L1.2617102,7.37228151 L1.294869,7.28308314 L1.32993257,7.19661063 C1.33593457,7.18239129 1.34201543,7.16825972 1.34817491,7.15420301 L1.38607319,7.07065787 L1.39584117,7.04997973 L1.44643216,6.947354 C1.45337156,6.9337233 1.46038834,6.92010294 1.46748223,6.90648002 C1.77251964,6.32069423 2.22014965,5.86096612 2.79052002,5.54768445 L2.87017712,5.50492322 L2.99086971,5.44437244 C3.00442328,5.43788526 3.01803719,5.43147856 3.03172398,5.42515261 L3.11482,5.38816785 C3.12884863,5.38216589 3.14297529,5.37624519 3.15721253,5.370406 L3.24406358,5.33635102 L3.3341719,5.30426462 L3.42814062,5.27415909 C3.44415728,5.26930726 3.46035992,5.26453848 3.47676111,5.25985301 L3.5776513,5.23274189 C3.78459888,5.18052721 4.02375586,5.14038246 4.31683501,5.11275077 L4.46796862,5.09997973 L4.62869239,5.08930651 C4.65631237,5.08770314 4.68435707,5.08618769 4.71283906,5.08476043 L4.88907895,5.07725701 L5.07641683,5.07188219 L5.27545584,5.06864828 L5.4867991,5.06756757 L16.0132009,5.06756757 Z M16.7126566,2.50024502 L16.9488443,2.50220182 L17.1739926,2.50610692 L17.3885365,2.51195144 L17.592911,2.51972649 L17.7875512,2.5294232 L17.9728921,2.54103269 L18.1493689,2.55454609 L18.3174165,2.5699545 L18.47747,2.58724907 L18.6299644,2.60642089 C18.6795844,2.61312339 18.728017,2.62013729 18.7753348,2.6274611 L18.9140163,2.65036082 L18.9809847,2.66250522 L19.1104484,2.68817755 C19.1315468,2.69260963 19.1524119,2.69711826 19.1730526,2.70170327 L19.2942775,2.73012824 C19.3140572,2.73501798 19.3336307,2.73998372 19.353007,2.74502527 L19.4669719,2.7761829 L19.5223161,2.79244127 L19.6299999,2.82631158 L19.7340401,2.86197925 L19.8348717,2.89943539 L19.9329298,2.93867113 C19.9490659,2.94535823 19.9651045,2.95211911 19.9810548,2.95895358 L20.0757683,3.00084207 L20.168796,3.04448796 L20.2605729,3.08988238 L20.4421143,3.18588127 C21.2569291,3.6334265 21.8964005,4.29018095 22.3321682,5.12701779 L22.3797471,5.22004624 L22.4256408,5.31346571 L22.4698407,5.40772301 L22.512338,5.50326496 L22.5531241,5.60053836 L22.5921905,5.69999001 C22.6112923,5.75033487 22.6297459,5.80166412 22.6475465,5.85422911 L22.6822756,5.96108118 L22.7152546,6.07167534 L22.7464748,6.18645839 C22.7565875,6.22546721 22.7664056,6.26524863 22.7759278,6.30587715 L22.8036047,6.4303784 C22.8080691,6.45157698 22.812459,6.47300594 22.8167745,6.4946746 L22.8417712,6.62763738 C22.8457878,6.65030206 22.8497295,6.67322505 22.853596,6.69641567 L22.8758931,6.83884529 C22.8794587,6.86314363 22.8829488,6.88772821 22.8863633,6.91260833 L22.9059413,7.06551012 C22.9090525,7.09160967 22.9120878,7.11802338 22.915047,7.14476057 L22.9318864,7.30913983 L22.9468893,7.48172925 L22.9600471,7.66297565 L22.9713511,7.85332582 L22.9807926,8.05322657 L22.9883631,8.26312472 L22.9940538,8.48346707 L22.9978561,8.71470042 L22.9997614,8.95727159 L23,13.6660736 L22.9989932,13.8935972 L22.9959799,14.108982 L22.9909705,14.3127699 L22.9839756,14.5055033 L22.9750056,14.6877241 L22.964071,14.8599746 L22.9511823,15.0227968 C22.9465615,15.0755597 22.9416169,15.1268416 22.93635,15.1767329 L22.9195846,15.3223249 L22.9008965,15.4601151 C22.8812506,15.5941851 22.8587365,15.7173654 22.8334014,15.8320956 L22.8071277,15.9440995 L22.7932889,15.9981583 L22.7642139,16.1027286 L22.7332844,16.2030207 L22.700511,16.299577 L22.6659041,16.3929394 L22.6479163,16.4385923 L22.6105789,16.5281804 L22.5714342,16.61593 L22.5304927,16.7023832 L22.487765,16.7880822 L22.4657346,16.8308182 C22.2201441,17.3024437 21.8936771,17.7025712 21.4942661,18.0230539 C21.4960887,17.9505884 21.497533,17.8756872 21.4985008,17.7985782 L21.5,17.5502309 L21.5,9.01733666 L21.4985008,8.76898935 L21.4984144,8.74192331 L21.4955434,8.52963215 L21.4911629,8.32874285 L21.4852228,8.13870228 L21.477673,7.95895731 L21.4732788,7.87277283 L21.4632206,7.70743416 C21.4614011,7.68063582 21.4595092,7.65420884 21.4575441,7.6281417 L21.4448649,7.47596481 L21.4303757,7.33187102 L21.4140266,7.19530722 L21.3957674,7.06572029 L21.375548,6.94255708 L21.3533185,6.8252645 L21.3290287,6.71328939 C21.324806,6.69503927 21.3204953,6.67698767 21.3160956,6.65912305 L21.2886216,6.55408707 C21.2838618,6.53692433 21.279011,6.51992554 21.2740681,6.50307916 L21.2432972,6.40373778 C21.2273508,6.35488943 21.2105567,6.30720545 21.1928867,6.26037471 L21.1563706,6.1677587 L21.1174688,6.07686487 C21.1107836,6.06182868 21.1039969,6.04684121 21.0971076,6.03189092 L21.0545335,5.94254325 L21.0094484,5.85353495 C20.7134804,5.28516576 20.2881281,4.84831742 19.734716,4.54435025 L19.64805,4.49804672 L19.5610536,4.4543219 L19.4731882,4.41312436 C19.4584416,4.40646585 19.4436364,4.3999105 19.4287613,4.39345725 L19.3385825,4.35595422 C19.2929842,4.33780668 19.246555,4.32055866 19.1989922,4.30418125 L19.102265,4.27257866 C19.085862,4.26750217 19.0693105,4.26252028 19.0525994,4.2576319 L18.9503276,4.22941532 C18.9329331,4.22489674 18.9153565,4.22046954 18.8975866,4.21613265 L18.7885583,4.19118638 L18.6743523,4.16835606 L18.5544302,4.14759026 L18.4282535,4.12883756 L18.2952835,4.11204655 L18.1549816,4.09716581 L18.0068094,4.08414391 L17.8502282,4.07292945 C17.8234007,4.07120813 17.7962003,4.06955999 17.7686159,4.06798394 L17.5984115,4.05938421 L17.4184516,4.05246338 L17.2281978,4.04717001 L17.0271115,4.04345269 L16.894733,4.04206378 C16.8560284,4.04155436 16.8167527,4.04117489 16.7768869,4.04092211 L4.8458278,4.04054054 C4.6827364,4.04054054 4.52925026,4.04248559 4.38417877,4.04657982 C4.67638696,3.66396601 5.03476921,3.34660895 5.4541436,3.10098908 L5.58791999,3.02607916 L5.67136368,2.98219664 L5.7555418,2.94014866 L5.84098221,2.899946 L5.92821276,2.86159943 L5.97266429,2.84312555 L6.06356978,2.80758332 L6.15758506,2.77392411 L6.25523798,2.7421587 L6.35705641,2.71229786 L6.40969263,2.69808502 L6.51874904,2.67110123 C6.63046004,2.6450814 6.75039875,2.62195882 6.88094054,2.60178197 L7.01510466,2.58258883 L7.15686536,2.56537028 L7.23075937,2.55750485 L7.38490466,2.54326839 L7.54796616,2.53103346 L7.63300545,2.52566993 L7.81043101,2.51645748 L7.99809242,2.50927349 L8.19651756,2.50412873 L8.40623426,2.50103398 L8.6277704,2.5 L16.7126566,2.50024502 Z" id="___å½¢çŠ¶ç»“åˆ" fill="#ffffff" fill-rule="nonzero"/>
                                    </g>
                                </svg>
                            </button>
                            <button class="bank-btn info" id="bankInfoBtn" title="é¢˜åº“ä¿¡æ¯">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 24 24" version="1.1">
                                    <title>é¢˜åº“ä¿¡æ¯</title>
                                    <defs>
                                        <path d="M12,1 C18.0751322,1 23,5.92486775 23,12 C23,18.0751322 18.0751322,23 12,23 C5.92486775,23 1,18.0751322 1,12 C1,5.92486775 5.92486775,1 12,1 Z M12,2.5 C6.75329488,2.5 2.5,6.75329488 2.5,12 C2.5,17.2467051 6.75329488,21.5 12,21.5 C17.2467051,21.5 21.5,17.2467051 21.5,12 C21.5,6.75329488 17.2467051,2.5 12,2.5 Z M12,9.75 C12.4142136,9.75 12.75,10.0857864 12.75,10.5 L12.75,17.25 C12.75,17.6642136 12.4142136,18 12,18 C11.5857864,18 11.25,17.6642136 11.25,17.25 L11.25,10.5 C11.25,10.0857864 11.5857864,9.75 12,9.75 Z M12,6 C12.6903559,6 13.25,6.55964406 13.25,7.25 C13.25,7.94035594 12.6903559,8.5 12,8.5 C11.3096441,8.5 10.75,7.94035594 10.75,7.25 C10.75,6.55964406 11.3096441,6 12,6 Z" id="_path-1"/>
                                    </defs>
                                    <g id="_Public/ic_public_detail" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <mask id="_mask-2" fill="white">
                                            <use xlink:href="#_path-1"/>
                                        </mask>
                                        <use id="_å½¢çŠ¶ç»“åˆ" fill="#ffffff" fill-rule="nonzero" xlink:href="#_path-1"/>
                                    </g>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="bank-preview" id="bankPreview">
                        <div class="bank-header">
                            <div class="bank-stats">æ­£åœ¨åŠ è½½é¢˜åº“ä¿¡æ¯...</div>
                        </div>
                        <div class="bank-items">
                            <div class="bank-item">æ­£åœ¨åŠ è½½é¢˜ç›®é¢„è§ˆ...</div>
                        </div>
                    </div>
                </div>
                
                <h2 style="margin-top: 30px;">âš¡ é€Ÿåº¦é€‰æ‹©</h2>
                <div class="speed-options" id="speedOptions">
                    <!-- é€Ÿåº¦é€‰é¡¹ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
        
        <div class="info-box" style="background: rgba(255, 255, 255, 0.05); border-radius: 12px; padding: 25px; margin-bottom: 20px;">
            <h3 style="color: #8a8aff; margin-bottom: 15px; font-size: 20px;">ä½¿ç”¨è¯´æ˜</h3>
            <div style="color: #ccc; line-height: 1.6;">
                <ul style="padding-left: 20px; margin: 10px 0;">
                    <li>1. è¾“å…¥é—®å·é“¾æ¥åç¼€ (å¦‚: wRSroLM.aspx) æˆ–ä»å†å²è®°å½•ä¸­é€‰æ‹©</li>
                    <li>2. é€‰æ‹©æˆ–åˆ›å»ºé¢˜åº“ (æ”¯æŒæœ€å¤š1000æ¡é¢˜ç›®ï¼Œæ¯100è¡Œè‡ªåŠ¨æ‰©å±•)</li>
                    <li>3. è®¾ç½®æ­£ç¡®ç‡ (0-100%ï¼Œé‡‡ç”¨å»ä¸€æ³•ä¿è¯å®é™…æ­£ç¡®ç‡â‰¥è®¾å®šå€¼)</li>
                    <li>4. é€‰æ‹©ç­”é¢˜é€Ÿåº¦</li>
                    <li>5. ç‚¹å‡»"æ‰“å¼€é—®å·é¡µé¢"æŒ‰é’®</li>
                    <li>6. ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆåç‚¹å‡»å³ä¸‹è§’"å¼€å§‹ç­”é¢˜"</li>
                    <li>7. ç­”é¢˜å®Œæˆåä¼šå¼¹å‡ºç¡®è®¤æäº¤å¯¹è¯æ¡†</li>
                    <li>8. æ–°çš„é“¾æ¥ä¼šè‡ªåŠ¨ä¿å­˜åˆ°å†å²è®°å½•ï¼Œä¸‹æ¬¡å¯ä¸€é”®é€‰æ‹©</li>
                </ul>
                <p><strong>æ³¨æ„ï¼š</strong>æœ¬ç¨‹åºä»…ç”¨äºå­¦ä¹ ç ”ç©¶ï¼Œè¯·å‹¿ç”¨äºéæ³•ç”¨é€”</p>
                <p><strong>æ³¨æ„ï¼š</strong>ä¸‹è½½è€…è¯·åœ¨24å°æ—¶å†…è‡ªè¡Œåˆ é™¤</p>
            </div>
        </div>
        
        <div class="control-panel">
            <button class="btn btn-open" id="btnOpen">
                æ‰“å¼€é—®å·é¡µé¢
            </button>
            <button class="btn btn-start" id="btnStart" disabled>
                <span class="loading" style="display: none;"></span>
                å¼€å§‹è‡ªåŠ¨ç­”é¢˜
            </button>
        </div>
        
        <div class="status-panel">
            <div class="status-header">
                <h3>çŠ¶æ€ä¿¡æ¯</h3>
                <button onclick="clearLogs()" style="background:none;border:1px solid #666;color:#666;padding:5px 10px;border-radius:5px;font-size:12px;cursor:pointer;">
                    æ¸…ç©ºæ—¥å¿—
                </button>
            </div>
            <div class="status-content" id="statusContent">
                <div class="log info">ç¨‹åºå·²å¯åŠ¨ï¼Œç­‰å¾…æ“ä½œ...</div>
            </div>
        </div>
        
        <div class="footer">
            Â© 2026 MCXGJKH | é—®å·æ˜Ÿè‡ªåŠ¨ç­”é¢˜å™¨ V8.0.2
        </div>
    </div>

    <!-- ========== åŸæœ‰é¢˜åº“ç¼–è¾‘å™¨æ¨¡æ€æ¡† ========== -->
    <div class="modal" id="bankEditorModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">ç¼–è¾‘é¢˜åº“</h3>
                <button class="close-modal" id="closeModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="bank-editor">
                    <input type="text" class="bank-name-input" id="bankNameInput" placeholder="é¢˜åº“åç§°" value="æ–°é¢˜åº“">
                    <textarea class="bank-description" id="bankDescription" placeholder="é¢˜åº“æè¿° (å¯é€‰)"></textarea>
                    <div class="bank-info-row">
                        <input type="number" class="info-input" id="basicInfoCount" placeholder="åŸºç¡€ä¿¡æ¯å¡«å†™é¢˜æ•°" value="2" min="0" max="20">
                        <input type="number" class="info-input" id="startQuestionNum" placeholder="èµ·å§‹é¢˜ç›®ç¼–å·" value="3" min="1" max="1000">
                    </div>
                    <div class="editor-container-basic" id="basicInfoContainer" style="display: none; margin-bottom: 10px;">
                        <div class="editor-header">
                            <span>åŸºç¡€ä¿¡æ¯ç­”æ¡ˆ (æ¯è¡Œä¸€ä¸ª)</span>
                        </div>
                        <textarea id="basicInfoTextarea" placeholder="è¯·è¾“å…¥åŸºç¡€ä¿¡æ¯ç­”æ¡ˆï¼Œæ¯è¡Œä¸€ä¸ªï¼š
ä¾‹å¦‚ï¼š
æœ±ä¸€é¾™
901

ç¨‹åºä¼šè‡ªåŠ¨å°†ç­”æ¡ˆæ ¼å¼åŒ–ä¸ºï¼š['ç­”æ¡ˆ1'], ['ç­”æ¡ˆ2']" style="width: 100%;"></textarea>
                    </div>
                    <div class="editor-container" style="margin-top: 10px;">
                        <div class="editor-header">
                            <span>é¢˜ç›®ç­”æ¡ˆ (æ¯è¡Œä¸€ä¸ªç­”æ¡ˆï¼Œç¨‹åºä¼šè‡ªåŠ¨æ ¼å¼åŒ–ä¸ºæ•°ç»„)</span>
                            <span id="currentLineCount">0 è¡Œ</span>
                        </div>
                        <textarea id="bankContentTextarea" placeholder="è¯·è¾“å…¥é¢˜ç›®ç­”æ¡ˆï¼Œæ¯è¡Œä¸€ä¸ªç­”æ¡ˆï¼š
ä¾‹å¦‚ï¼š
æçº¯åæ‰€å¾—ç²¾ç›æœªå®Œå…¨å¹²ç‡¥
è’¸å‘çš¿
æœ‰æ°”æ³¡äº§ç”Ÿ

ç¨‹åºä¼šè‡ªåŠ¨å°†ç­”æ¡ˆæ ¼å¼åŒ–ä¸ºï¼š['ç­”æ¡ˆ1', 'ç­”æ¡ˆ2', 'ç­”æ¡ˆ3']
å¹¶è‡ªåŠ¨æ·»åŠ å¸¸è§çš„å­—æ¯é€‰é¡¹æ ¼å¼å¦‚ï¼š['ç­”æ¡ˆ1', 'A ç­”æ¡ˆ1']

ç³»ç»Ÿæ”¯æŒæœ€å¤š1000è¡Œï¼Œæ¯100è¡Œè‡ªåŠ¨æ‰©å±•æ–‡æœ¬æ¡†"></textarea>
                    </div>
                    <div class="editor-info">
                        <span id="maxLinesInfo">æœ€å¤§æ”¯æŒ: 100 è¡Œ</span>
                        <span> | </span>
                        <span>å·²ä½¿ç”¨: <span id="usedLines">0</span> è¡Œ</span>
                        <span> | </span>
                        <span>å‰©ä½™: <span id="remainingLines">100</span> è¡Œ</span>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-open" id="cancelEditBtn" style="flex: none; padding: 12px 25px;">å–æ¶ˆ</button>
                <button class="btn btn-start" id="saveBankBtn" style="flex: none; padding: 12px 25px;">ä¿å­˜é¢˜åº“</button>
            </div>
        </div>
    </div>

    <!-- ========== åŸæœ‰é¢˜åº“ä¿¡æ¯æ¨¡æ€æ¡† ========== -->
    <div class="modal" id="bankInfoModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="infoModalTitle">é¢˜åº“ä¿¡æ¯</h3>
                <button class="close-modal" id="closeInfoModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div id="bankInfoContent" style="color: #ccc; line-height: 1.6;">
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #8a8aff; margin-bottom: 10px;" id="infoBankName">é¢˜åº“åç§°</h4>
                        <p id="infoBankDescription">æš‚æ— æè¿°</p>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
                            <div style="color: #8a8aff; font-size: 12px;">æ€»é¢˜ç›®æ•°</div>
                            <div style="font-size: 24px; font-weight: bold;" id="infoTotalQuestions">0</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
                            <div style="color: #8a8aff; font-size: 12px;">æœ‰æ•ˆé¢˜ç›®æ•°</div>
                            <div style="font-size: 24px; font-weight: bold;" id="infoValidQuestions">0</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
                            <div style="color: #8a8aff; font-size: 12px;">åŸºç¡€ä¿¡æ¯é¢˜æ•°</div>
                            <div style="font-size: 24px; font-weight: bold;" id="infoBasicQuestions">0</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
                            <div style="color: #8a8aff; font-size: 12px;">èµ·å§‹ç¼–å·</div>
                            <div style="font-size: 24px; font-weight: bold;" id="infoStartNumber">3</div>
                        </div>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <h4 style="color: #8a8aff; margin-bottom: 10px;">æ­£ç¡®ç‡è®¡ç®—è¯´æ˜</h4>
                        <p>æœ‰æ•ˆé¢˜ç›®æ•° = æ€»é¢˜ç›®æ•° - åŸºç¡€ä¿¡æ¯å¡«å†™é¢˜æ•°</p>
                        <p>éœ€è¦æ­£ç¡®çš„é¢˜ç›®æ•° = ceil(æœ‰æ•ˆé¢˜ç›®æ•° Ã— æ­£ç¡®ç‡%)</p>
                        <p>å®é™…æ­£ç¡®ç‡ â‰¥ è®¾å®šæ­£ç¡®ç‡ (å»ä¸€æ³•ä¿è¯)</p>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
                        <h4 style="color: #8a8aff; margin-bottom: 10px;">ç¤ºä¾‹è®¡ç®—</h4>
                        <p id="infoCalculationExample">ç¤ºä¾‹ï¼šæ€»é¢˜ç›®42é¢˜ï¼ŒåŸºç¡€ä¿¡æ¯2é¢˜ï¼Œæœ‰æ•ˆé¢˜ç›®40é¢˜</p>
                        <p id="infoAccuracyExample">è®¾å®š90%æ­£ç¡®ç‡æ—¶ï¼Œéœ€è¦æ­£ç¡® ceil(40 Ã— 90%) = 36 é¢˜</p>
                        <p>å®é™…æ­£ç¡®ç‡ = 36/40 = 90% (æ­£å¥½æ»¡è¶³)</p>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-open" id="closeInfoBtn" style="flex: none; padding: 12px 25px;">å…³é—­</button>
            </div>
        </div>
    </div>

    <!-- ========== åŸæœ‰é“¾æ¥å†å²è®°å½•æ¨¡æ€æ¡† ========== -->
    <div class="modal history-modal" id="historyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ğŸ“‹ é“¾æ¥å†å²è®°å½•</h3>
                <button class="close-modal" id="closeHistoryModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="history-list" id="historyList"></div>
                <div id="historyEmpty" class="history-empty" style="display: none;">
                    <div>ğŸ“</div>
                    <div>æš‚æ— å†å²è®°å½•</div>
                    <div style="font-size: 14px; margin-top: 10px; color: #666;">
                        æ‰“å¼€æ–°çš„é—®å·é“¾æ¥åï¼Œä¼šè‡ªåŠ¨ä¿å­˜åˆ°è¿™é‡Œ
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-open" id="clearHistoryBtn" style="flex: none; padding: 12px 25px;">æ¸…ç©ºå…¨éƒ¨å†å²</button>
            </div>
        </div>
    </div>

    <!-- ========== åŸæœ‰å¯¼å…¥ç»“æœæ¨¡æ€æ¡† ========== -->
    <div class="modal" id="importResultModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3 style="color: #2196F3;">ğŸ“¥ å¯¼å…¥ç»“æœ</h3>
                <button class="close-modal" id="closeImportResultBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div id="importResultContent" style="color: #ccc; line-height: 1.6;"></div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-open" id="confirmImportBtn" style="flex: none; padding: 12px 25px;">ç¡®è®¤å¯¼å…¥</button>
            </div>
        </div>
    </div>

    <!-- ========== åŸæœ‰åˆ é™¤ç¡®è®¤æ¨¡æ€æ¡† ========== -->
    <div class="modal" id="deleteConfirmModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 style="color: #f44336;">âš ï¸ åˆ é™¤é¢˜åº“ç¡®è®¤</h3>
                <button class="close-modal" id="closeDeleteModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div style="color: #ccc; line-height: 1.6; text-align: center;">
                    <div style="margin-bottom: 25px; font-size: 16px;">æ‚¨ç¡®å®šè¦åˆ é™¤ä»¥ä¸‹é¢˜åº“å—ï¼Ÿ</div>
                    <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 10px; margin-bottom: 25px; border: 2px solid rgba(244,67,54,0.3);">
                        <div style="font-size: 24px; color: #f44336; font-weight: bold; margin-bottom: 10px;" id="deleteBankNameDisplay">é¢˜åº“åç§°</div>
                        <div style="font-size: 14px; color: #aaa; user-select: text; cursor: text; padding: 8px; background: rgba(0,0,0,0.2); border-radius: 5px; margin-top: 10px;" id="deleteBankNameCopy">å¯å¤åˆ¶æ­¤åç§°</div>
                    </div>
                    <div style="margin-bottom: 25px; font-size: 16px;">æ­¤æ“ä½œ<b style="color: #f44336;">ä¸å¯æ¢å¤</b>ï¼Œè¯·è°¨æ…æ“ä½œï¼</div>
                    <div style="margin-bottom: 20px;">
                        <div style="color: #FF9800; margin-bottom: 10px; font-size: 14px;">ä¸ºç¡®è®¤åˆ é™¤ï¼Œè¯·åœ¨ä¸‹æ–¹è¾“å…¥æ¡†ä¸­è¾“å…¥é¢˜åº“åç§°ï¼š</div>
                        <input type="text" id="confirmDeleteInput" style="width: 100%; padding: 15px; background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; font-size: 16px; text-align: center;" placeholder="è¯·è¾“å…¥é¢˜åº“åç§°ä»¥ç¡®è®¤åˆ é™¤">
                    </div>
                    <div style="color: #888; font-size: 12px; margin-top: 15px;">æç¤ºï¼šè¾“å…¥æ­£ç¡®çš„é¢˜åº“åç§°åï¼Œåˆ é™¤æŒ‰é’®æ‰ä¼šæ¿€æ´»</div>
                </div>
            </div>
            <div class="modal-actions" style="justify-content: center;">
                <button class="btn btn-open" id="cancelDeleteBtn" style="flex: none; padding: 12px 30px;">å–æ¶ˆ</button>
                <button class="btn btn-stop" id="confirmDeleteBtn" style="flex: none; padding: 12px 30px; background: linear-gradient(135deg, #f44336 0%, #c62828 100%); opacity: 0.5; cursor: not-allowed;" disabled>ç¡®è®¤åˆ é™¤</button>
            </div>
        </div>
    </div>

    <!-- ========== é¢˜ç›®åŒ¹é…é¢˜åº“ç¼–è¾‘å™¨æ¨¡æ€æ¡†ï¼ˆå·²å¢åŠ åŸºç¡€ä¿¡æ¯åŠŸèƒ½ï¼‰ ========== -->
    <div class="modal" id="matchBankEditorModal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3 id="matchModalTitle">ç¼–è¾‘é¢˜ç›®åŒ¹é…åº“</h3>
                <button class="close-modal" id="closeMatchModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="bank-editor">
                    <input type="text" class="bank-name-input" id="matchBankNameInput" placeholder="é¢˜åº“åç§°ï¼ˆå¦‚ï¼šåŒ–å­¦å®éªŒé¢˜åº“ï¼‰" value="æ–°é¢˜ç›®åŒ¹é…åº“">
                    <textarea class="bank-description" id="matchBankDescription" placeholder="é¢˜åº“æè¿° (å¯é€‰)"></textarea>
                    
                    <!-- åŸºç¡€ä¿¡æ¯ä¸èµ·å§‹ç¼–å·è¡Œï¼ˆä¸ä¸»é¢˜åº“å®Œå…¨ä¸€è‡´ï¼‰ -->
                    <div class="bank-info-row">
                        <input type="number" class="info-input" id="matchBasicInfoCount" placeholder="åŸºç¡€ä¿¡æ¯å¡«å†™é¢˜æ•°" value="2" min="0" max="20">
                        <input type="number" class="info-input" id="matchStartQuestionNum" placeholder="èµ·å§‹é¢˜ç›®ç¼–å·" value="3" min="1" max="1000">
                    </div>
                    
                    <!-- åŸºç¡€ä¿¡æ¯ç­”æ¡ˆç¼–è¾‘æ¡†ï¼ˆä¸ä¸»é¢˜åº“è¡Œä¸ºä¸€è‡´ï¼Œè¾“å…¥åŸºç¡€ä¿¡æ¯é¢˜æ•°åè‡ªåŠ¨æ˜¾ç¤º/éšè—ï¼‰ -->
                    <div class="editor-container-basic" id="matchBasicInfoContainer" style="display: none; margin-bottom: 10px;">
                        <div class="editor-header">
                            <span>åŸºç¡€ä¿¡æ¯ç­”æ¡ˆ (æ¯è¡Œä¸€ä¸ª)</span>
                        </div>
                        <textarea id="matchBasicInfoTextarea" placeholder="è¯·è¾“å…¥åŸºç¡€ä¿¡æ¯ç­”æ¡ˆï¼Œæ¯è¡Œä¸€ä¸ªï¼š
    ä¾‹å¦‚ï¼š
    å¼ ä¸‰
    202501

    ç¨‹åºä¼šè‡ªåŠ¨å°†ç­”æ¡ˆæ ¼å¼åŒ–ä¸ºï¼š['ç­”æ¡ˆ1'], ['ç­”æ¡ˆ2']ï¼ˆæ³¨æ„ï¼šé¢˜ç›®åŒ¹é…åº“åªå­˜å‚¨é¢˜ç›®ï¼Œä¸å­˜å‚¨ç­”æ¡ˆï¼Œæ­¤å¤„ä»…ä¸ºå ä½/è®°å½•ï¼‰" style="width: 100%;"></textarea>
                    </div>
                    
                    <!-- é¢˜ç›®åº“ï¼šæ¯è¡Œä¸€ä¸ªé¢˜ç›®æ–‡æœ¬ -->
                    <div class="editor-container" style="margin-top: 10px;">
                        <div class="editor-header">
                            <span>ğŸ“‹ é¢˜ç›®åº“ï¼ˆæ¯è¡Œä¸€ä¸ªé¢˜ç›®æ–‡æœ¬ï¼Œç¨‹åºè‡ªåŠ¨æŒ‰èµ·å§‹ç¼–å·ç”Ÿæˆé¢˜å·ï¼‰</span>
                            <span id="matchCurrentLineCount">0 è¡Œ</span>
                        </div>
                        <textarea id="matchBankContentTextarea" rows="12" placeholder="ç¤ºä¾‹ï¼š
    ä¸‹åˆ—ä»ªå™¨ä¸­ï¼Œä¸èƒ½ç”¨äºåŠ çƒ­çš„æ˜¯ï¼Ÿ
    å®éªŒå®¤åˆ¶å–äºŒæ°§åŒ–ç¢³çš„è¯å“æ˜¯ï¼Ÿ
    é“ä¸åœ¨æ°§æ°”ä¸­ç‡ƒçƒ§çš„ç°è±¡ï¼Ÿ

    ç¨‹åºå°†è‡ªåŠ¨ä¸ºæ¯è¡Œåˆ†é…ä¸€ä¸ªé¢˜å·ï¼ˆä»èµ·å§‹ç¼–å·å¼€å§‹é€’å¢ï¼‰ã€‚åŒ¹é…æ—¶å°†ä½¿ç”¨è¿™äº›é¢˜ç›®æ–‡æœ¬å®šä½é¢˜å·ï¼Œç­”æ¡ˆè¯·ä»ä¸»é¢˜åº“è·å–ã€‚"></textarea>
                    </div>
                    
                    <div class="editor-info">
                        <span id="matchMaxLinesInfo">æœ€å¤§æ”¯æŒ: 1000 è¡Œ</span> | 
                        å·²ä½¿ç”¨: <span id="matchUsedLines">0</span> è¡Œ | 
                        å‰©ä½™: <span id="matchRemainingLines">1000</span> è¡Œ
                    </div>
                    <div class="match-editor-tip">
                        ğŸ’¡ æç¤ºï¼šæ¯è¡Œä¸€ä¸ªé¢˜ç›®æ–‡æœ¬ï¼Œä¸åŒ…å«ç­”æ¡ˆã€‚ç­”æ¡ˆè¯·é€šè¿‡ä¸»é¢˜åº“æä¾›ï¼ŒåŒ¹é…æ—¶å°†æ ¹æ®é¢˜å·ä»ä¸»é¢˜åº“è·å–æ­£ç¡®ç­”æ¡ˆã€‚
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-open" id="cancelMatchEditBtn" style="flex: none; padding: 12px 25px;">å–æ¶ˆ</button>
                <button class="btn btn-start" id="saveMatchBankBtn" style="flex: none; padding: 12px 25px;">ä¿å­˜é¢˜åº“</button>
            </div>
        </div>
    </div>

    <!-- ========== é¢˜ç›®åŒ¹é…é¢˜åº“ä¿¡æ¯æ¨¡æ€æ¡†ï¼ˆå”¯ä¸€ï¼‰ ========== -->
    <div class="modal" id="matchBankInfoModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="matchInfoModalTitle">é¢˜ç›®åŒ¹é…åº“ä¿¡æ¯</h3>
                <button class="close-modal" id="closeMatchInfoModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div id="matchBankInfoContent" style="color: #ccc; line-height: 1.6;">
                    <div style="margin-bottom: 20px;">
                        <h4 style="color: #ff9800;" id="infoMatchBankName">é¢˜åº“åç§°</h4>
                        <p id="infoMatchBankDescription">æš‚æ— æè¿°</p>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
                            <div style="color: #8a8aff; font-size: 12px;">é¢˜ç›®æ€»æ•°</div>
                            <div style="font-size: 24px; font-weight: bold;" id="infoMatchTotalQuestions">0</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
                            <div style="color: #8a8aff; font-size: 12px;">åŸºç¡€ä¿¡æ¯é¢˜æ•°</div>
                            <div style="font-size: 24px; font-weight: bold;" id="infoMatchBasicQuestions">0</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
                            <div style="color: #8a8aff; font-size: 12px;">æœ‰æ•ˆé¢˜ç›®æ•°</div>
                            <div style="font-size: 24px; font-weight: bold;" id="infoMatchValidQuestions">0</div>
                        </div>
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
                            <div style="color: #8a8aff; font-size: 12px;">èµ·å§‹ç¼–å·</div>
                            <div style="font-size: 24px; font-weight: bold;" id="infoMatchStartNumber">3</div>
                        </div>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
                        <h4 style="color: #ff9800; margin-bottom: 10px;">ğŸ“Œ åŒ¹é…è¯´æ˜</h4>
                        <p>ç­”é¢˜æ—¶ï¼Œå¦‚æœå¯ç”¨â€œé¢˜ç›®åŒ¹é…â€ï¼Œä¼šéå†æœ¬åº“ä¸­çš„æ‰€æœ‰é¢˜ç›®æ–‡æœ¬ï¼Œä½¿ç”¨<strong>åŒ…å«åŒ¹é…</strong>æ–¹å¼å®šä½å½“å‰é¢˜ç›®ï¼ŒæˆåŠŸåè·å¾—é¢˜å·ï¼Œç„¶åä»<strong>ä¸»é¢˜åº“</strong>ä¸­è·å–å¯¹åº”é¢˜å·çš„ç­”æ¡ˆè¿›è¡Œé€‰é¡¹åŒ¹é…ã€‚</p>
                        <p style="margin-top: 8px;">âš ï¸ åŒ¹é…ä¼˜å…ˆçº§ï¼šå›¾ç‰‡URLåŒ¹é… > é¢˜ç›®æ–‡æœ¬åŒ¹é… > ä¼ ç»Ÿé¢˜å·åŒ¹é…</p>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-open" id="closeMatchInfoBtn" style="flex: none; padding: 12px 25px;">å…³é—­</button>
            </div>
        </div>
    </div>

    <!-- ========== é¢˜ç›®åŒ¹é…é¢˜åº“åˆ é™¤ç¡®è®¤æ¨¡æ€æ¡† ========== -->
    <div class="modal" id="deleteMatchConfirmModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 style="color: #f44336;">âš ï¸ åˆ é™¤é¢˜ç›®åŒ¹é…åº“ç¡®è®¤</h3>
                <button class="close-modal" id="closeMatchDeleteModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div style="color: #ccc; text-align: center;">
                    <div style="margin-bottom: 25px; font-size: 16px;">ç¡®å®šæ°¸ä¹…åˆ é™¤ä»¥ä¸‹é¢˜ç›®åŒ¹é…åº“å—ï¼Ÿ</div>
                    <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 10px; margin-bottom: 25px; border: 2px solid rgba(244,67,54,0.3);">
                        <div style="font-size: 24px; color: #f44336; font-weight: bold; margin-bottom: 10px;" id="deleteMatchBankNameDisplay">é¢˜ç›®åŒ¹é…åº“åç§°</div>
                        <div style="font-size: 14px; color: #aaa; background: rgba(0,0,0,0.2); padding: 8px; border-radius: 5px;" id="deleteMatchBankNameCopy">å¯å¤åˆ¶æ­¤åç§°</div>
                    </div>
                    <div style="margin-bottom: 25px;">æ­¤æ“ä½œ<b style="color: #f44336;">ä¸å¯æ¢å¤</b>ï¼</div>
                    <div style="margin-bottom: 20px;">
                        <div style="color: #FF9800; margin-bottom: 10px;">ä¸ºç¡®è®¤åˆ é™¤ï¼Œè¯·è¾“å…¥é¢˜ç›®åŒ¹é…åº“åç§°ï¼š</div>
                        <input type="text" id="confirmMatchDeleteInput" style="width: 100%; padding: 15px; background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.2); border-radius: 8px; color: white; font-size: 16px; text-align: center;" placeholder="è¯·è¾“å…¥é¢˜åº“åç§°ä»¥ç¡®è®¤åˆ é™¤">
                    </div>
                </div>
            </div>
            <div class="modal-actions" style="justify-content: center;">
                <button class="btn btn-open" id="cancelMatchDeleteBtn" style="flex: none; padding: 12px 30px;">å–æ¶ˆ</button>
                <button class="btn btn-stop" id="confirmMatchDeleteBtn" style="flex: none; padding: 12px 30px; background: linear-gradient(135deg,#f44336 0%,#c62828 100%); opacity: 0.5; cursor: not-allowed;" disabled>ç¡®è®¤åˆ é™¤</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== åŸæœ‰é€Ÿåº¦é…ç½® ====================
        const SPEED_OPTIONS = [
            { name: 'åˆ˜å­è½©é€Ÿåº¦', value: 'lightning', delay: 100, desc: '5ç§’å®Œæˆæ‰€æœ‰é¢˜ç›®' },
            { name: 'æé€Ÿ', value: 'turbo', delay: 200, desc: '10ç§’å®Œæˆæ‰€æœ‰é¢˜ç›®' },
            { name: 'å¿«é€Ÿ', value: 'fast', delay: 300, desc: '15ç§’å®Œæˆæ‰€æœ‰é¢˜ç›®' },
            { name: 'æ ‡å‡†', value: 'normal', delay: 500, desc: '25ç§’å®Œæˆæ‰€æœ‰é¢˜ç›®' },
            { name: 'é€‚ä¸­', value: 'medium', delay: 800, desc: '40ç§’å®Œæˆæ‰€æœ‰é¢˜ç›®' },
            { name: 'è‡ªç„¶', value: 'natural', delay: 1200, desc: '1åˆ†é’Ÿå®Œæˆæ‰€æœ‰é¢˜ç›®' },
            { name: 'æ…¢é€Ÿ', value: 'slow', delay: 1800, desc: '1åˆ†30ç§’å®Œæˆæ‰€æœ‰é¢˜ç›®' },
            { name: 'ææ…¢', value: 'very-slow', delay: 2500, desc: '2åˆ†é’Ÿå®Œæˆæ‰€æœ‰é¢˜ç›®' },
            { name: 'éšæœº', value: 'random', delay: 'random', desc: 'éšæœºé€Ÿåº¦æ¨¡æ‹ŸçœŸäºº' }
        ];
        
        // ==================== åŸæœ‰é»˜è®¤é¢˜åº“ ====================
        const DEFAULT_QUESTION_BANK = {
            name: "2026ç†åŒ–ç”Ÿå®éªŒæ“ä½œæ¨¡æ‹Ÿè€ƒè¯•-åŒ–å­¦",
            description: "æ±¤é€Šæ¹–åˆä¸­æ¨¡æ‹Ÿ | åŸºç¡€ä¿¡æ¯å¡«å†™é¢˜ï¼š2é¢˜",
            basicInfoCount: 2,
            startQuestionNum: 3,
            answers: {
                "1": ["æœ±ä¸€é¾™"],
                "2": ["901"],
                "3": ["é”å™¨", "D é”å™¨"],
                "4": ["è’¸å‘çš¿", "D è’¸å‘çš¿"],
                "5": ["å®Œå…¨æ³¨æ»¡ç»ç’ƒç®¡", "B å®Œå…¨æ³¨æ»¡ç»ç’ƒç®¡"],
                "6": ["æœ‰æ°”æ³¡äº§ç”Ÿ", "C æœ‰æ°”æ³¡äº§ç”Ÿ"],
                "7": ["ä¸ç”µæºè´Ÿæç›¸è¿çš„ç»ç’ƒç®¡å†…äº§ç”Ÿæ±½æ³¡çš„é€Ÿç‡æ›´å¿«"],
                "8": ["cä¸­æ¶²é¢æœ€é«˜", "C cä¸­æ¶²é¢æœ€é«˜"],
                "9": ["çƒ§æ¯å†…å£æœ‰æ°´é›¾", "A çƒ§æ¯å†…å£æœ‰æ°´é›¾"],
                "10": ["1:2", "B 1:2"],
                "11": ["æœ¨æ¡ç‡ƒçƒ§å¾—æ›´æ—º", "D æœ¨æ¡ç‡ƒçƒ§å¾—æ›´æ—º"],
                "12": ["ç”µè§£å™¨ä¸­åŠ å…¥çš„æ˜¯è’¸é¦æ°´", "A ç”µè§£å™¨ä¸­åŠ å…¥çš„æ˜¯è’¸é¦æ°´"],
                "13": ["é›†æ°”ç“¶", "D é›†æ°”ç“¶"],
                "14": ["é•Šå­", "C é•Šå­"],
                "15": ["å¯¼ç®¡å£æœ‰æ°”æ³¡å†’å‡º", "A å¯¼ç®¡å£æœ‰æ°”æ³¡å†’å‡º"],
                "16": ["çŸ³ç°çŸ³å’Œç¨€ç›é…¸", "C çŸ³ç°çŸ³å’Œç¨€ç›é…¸"],
                "17": ["å°†ç‡ƒç€çš„æœ¨æ¡æ”¾åœ¨é›†æ°”ç“¶å£", "B å°†ç‡ƒç€çš„æœ¨æ¡æ”¾åœ¨é›†æ°”ç“¶å£"],
                "18": ["äºŒæ°§åŒ–ç¢³èƒ½å‚ä¸å…‰åˆä½œç”¨", "D äºŒæ°§åŒ–ç¢³èƒ½å‚ä¸å…‰åˆä½œç”¨"],
                "19": ["äºŒæ°§åŒ–ç¢³èƒ½æº¶äºæ°´", "B äºŒæ°§åŒ–ç¢³èƒ½æº¶äºæ°´"],
                "20": ["â‘ â‘¢", "A â‘ â‘¢"],
                "21": ["å›¾IIIä¸­çº¸èŠ±å˜çº¢", "C å›¾IIIä¸­çº¸èŠ±å˜çº¢"],
                "22": ["äºŒæ°§åŒ–ç¢³èƒ½ä½¿æ¾„æ¸…çŸ³ç°æ°´å˜æµ‘æµŠ", "C äºŒæ°§åŒ–ç¢³èƒ½ä½¿æ¾„æ¸…çŸ³ç°æ°´å˜æµ‘æµŠ"],
                "23": ["C"],
                "24": ["å»¶å±•æ€§", "C å»¶å±•æ€§"],
                "25": ["å¯¼ç”µæ€§", "B å¯¼ç”µæ€§"],
                "26": ["ç¡¬é“çš„ç¡¬åº¦æ›´å¤§", "D ç¡¬é“çš„ç¡¬åº¦æ›´å¤§"],
                "27": ["æ°¢æ°”", "C æ°¢æ°”"],
                "28": ["é“", "A é“"],
                "29": ["é“œä¸æ°§æ°”ååº”ç”Ÿæˆæ°§åŒ–é“œ", "B é“œä¸æ°§æ°”ååº”ç”Ÿæˆæ°§åŒ–é“œ"],
                "30": ["è¯¥å®éªŒè¯´æ˜é‡‘å±æ´»åŠ¨æ€§ï¼šé“¶ ï¼ é“œ", "D è¯¥å®éªŒè¯´æ˜é‡‘å±æ´»åŠ¨æ€§ï¼šé“¶ ï¼ é“œ"],
                "31": ["é“œ ï¼ é“¶", "A é“œ ï¼ é“¶"],
                "32": ["å®éªŒä¸­æº¶æ¶²ç”±è“è‰²å˜æˆæµ…ç»¿è‰²", "A å®éªŒä¸­æº¶æ¶²ç”±è“è‰²å˜æˆæµ…ç»¿è‰²"],
                "33": ["çƒ§æ¯", "B çƒ§æ¯"],
                "34": ["æ‰˜ç›˜å¤©å¹³", "C æ‰˜ç›˜å¤©å¹³"],
                "35": ["æ…æ‹Œï¼ŒåŠ å¿«ç²—ç›æº¶è§£", "B æ…æ‹Œï¼ŒåŠ å¿«ç²—ç›æº¶è§£"],
                "36": ["å¹³è§†å‡¹æ¶²é¢çš„æœ€ä½å¤„", "C å¹³è§†å‡¹æ¶²é¢çš„æœ€ä½å¤„"],
                "37": ["å¼•æµ", "C å¼•æµ"],
                "38": ["é‡ç­’", "B é‡ç­’"],
                "39": ["å®éªŒä¸­æ»¤çº¸å‘ç”Ÿç ´æŸ", "D å®éªŒä¸­æ»¤çº¸å‘ç”Ÿç ´æŸ"],
                "40": ["å½“è’¸å‘çš¿ä¸­å‡ºç°è¾ƒå¤šå›ºä½“æ—¶åœæ­¢åŠ çƒ­", "B å½“è’¸å‘çš¿ä¸­å‡ºç°è¾ƒå¤šå›ºä½“æ—¶åœæ­¢åŠ çƒ­"],
                "41": ["é£Ÿç›å’Œç»†æ²™", "A é£Ÿç›å’Œç»†æ²™"],
                "42": ["æçº¯åæ‰€å¾—ç²¾ç›æœªå®Œå…¨å¹²ç‡¥", "D æçº¯åæ‰€å¾—ç²¾ç›æœªå®Œå…¨å¹²ç‡¥"]
            }
        };
        
        // ==================== åŸæœ‰é¢˜åº“æ•°æ®å­˜å‚¨ ====================
        let questionBanks = {};
        let selectedSpeed = null;
        let selectedBank = DEFAULT_QUESTION_BANK.name;
        let wjxWindowId = null;
        let accuracy = 100;
        let isEditingBank = false;
        let editingBankName = "";
        let maxLines = 100;
        let bankToDelete = "";
        
        // ==================== åŸæœ‰é“¾æ¥å†å²è®°å½• ====================
        let urlHistory = [];
        let currentUrlId = null;
        
        // ==================== åŸæœ‰åˆå§‹åŒ– ====================
        document.addEventListener('DOMContentLoaded', () => {
            renderSpeedOptions();
            setupEventListeners();
            loadBanksFromStorage();
            loadUrlHistory();

            const defaultUrl = "wRSroLM.aspx";
            const defaultTitle = "ç†åŒ–ç”Ÿæ¨¡æ‹Ÿ-åŒ–å­¦";
            if (urlHistory.length === 0) {
                addUrlToHistory(defaultUrl, defaultTitle);
                log('å·²æ·»åŠ é»˜è®¤é“¾æ¥å†å²è®°å½•: ' + defaultTitle, 'info');
            }
            
            updateBankSelect();
            updateBankPreview();
            updateHistoryCount();
            addKeyboardShortcutInfo();
            document.addEventListener('keydown', (e) => {
                if (e.key === 'F12') {
                    console.log('F12æŒ‰ä¸‹ï¼šæ‰“å¼€/å…³é—­å¼€å‘è€…å·¥å…·');
                    showShortcutNotification('F12: æ‰“å¼€/å…³é—­å¼€å‘è€…å·¥å…·');
                }
            });
            log('ç¨‹åºåˆå§‹åŒ–å®Œæˆ V8.0.2', 'success');
        });

        // ==================== åŸæœ‰è¾…åŠ©å‡½æ•° ====================
        function addKeyboardShortcutInfo() {
            const statusContent = document.getElementById('statusContent');
            if (statusContent) {
                const shortcutLog = document.createElement('div');
                shortcutLog.className = 'log info';
                shortcutLog.innerHTML = `
                    <strong>V8.0.2 å¿«æ·é”®è¯´æ˜ï¼š</strong><br>
                    â€¢ <b>F12</b>: æ‰“å¼€/å…³é—­å¼€å‘è€…å·¥å…·ï¼ˆå¦‚æ— æ•ˆè¯·æ£€æŸ¥ç³»ç»Ÿè®¾ç½®ï¼‰<br>
                    â€¢ <b>Ctrl+Shift+I</b>: æ‰“å¼€/å…³é—­å¼€å‘è€…å·¥å…·ï¼ˆå¤‡ç”¨ï¼‰<br>
                    â€¢ <b>F5/Ctrl+R</b>: åˆ·æ–°å½“å‰é¡µé¢<br>
                    â€¢ <b>Ctrl+Shift+R</b>: ç¡¬åˆ·æ–°ï¼ˆæ¸…é™¤ç¼“å­˜ï¼‰<br>
                    â€¢ <b>Alt+Left/Right</b>: å‰è¿›/åé€€<br>
                    <em>æç¤ºï¼šå¦‚F12æ— æ•ˆï¼Œå¯èƒ½æ˜¯ç³»ç»Ÿå¿«æ·é”®å†²çªï¼Œè¯·å°è¯•Ctrl+Shift+I</em>
                `;
                statusContent.appendChild(shortcutLog);
            }
        }

        function showShortcutNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(102, 126, 234, 0.9);
                color: white;
                padding: 10px 20px;
                border-radius: 8px;
                z-index: 10000;
                font-size: 14px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                animation: fadeInOut 3s ease;
            `;
            const style = document.createElement('style');
            style.textContent = `@keyframes fadeInOut{0%{opacity:0;transform:translateY(-20px);}10%{opacity:1;transform:translateY(0);}90%{opacity:1;transform:translateY(0);}100%{opacity:0;transform:translateY(-20px);}}`;
            document.head.appendChild(style);
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => {
                if (notification.parentNode) notification.parentNode.removeChild(notification);
                if (style.parentNode) style.parentNode.removeChild(style);
            }, 3000);
        }

        function renderSpeedOptions() {
            const container = document.getElementById('speedOptions');
            container.innerHTML = '';
            SPEED_OPTIONS.forEach(option => {
                const div = document.createElement('div');
                div.className = 'speed-option';
                div.innerHTML = `<div class="speed-name">${option.name}</div><div class="speed-desc">${option.desc}</div>`;
                div.addEventListener('click', () => {
                    document.querySelectorAll('.speed-option').forEach(el => el.classList.remove('selected'));
                    div.classList.add('selected');
                    selectedSpeed = option;
                    log(`å·²é€‰æ‹©é€Ÿåº¦: ${option.name}`, 'success');
                });
                container.appendChild(div);
            });
            setTimeout(() => { container.children[3].click(); }, 100);
        }
        
        // ==================== åŸæœ‰äº‹ä»¶ç›‘å¬å™¨ï¼ˆå®Œæ•´ä¿ç•™ï¼‰====================
        function setupEventListeners() {
            const accuracySlider = document.getElementById('accuracySlider');
            const accuracyValue = document.getElementById('accuracyValue');
            accuracySlider.addEventListener('input', () => {
                accuracy = parseInt(accuracySlider.value);
                accuracyValue.textContent = `${accuracy}%`;
                updateAccuracyExamples();
            });
            
            const urlSuffixInput = document.getElementById('urlSuffix');
            urlSuffixInput.addEventListener('input', () => {
                const value = urlSuffixInput.value.trim();
                if (value && !value.match(/^[a-zA-Z0-9_\-\.]+$/)) {
                    log('è­¦å‘Š: é“¾æ¥åç¼€åªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€è¿å­—ç¬¦å’Œç‚¹å·', 'warning');
                }
                currentUrlId = null;
                document.getElementById('currentUrlTitle').textContent = 'æœªè®¾ç½®';
            });
            
            const bankSelect = document.getElementById('bankSelect');
            bankSelect.addEventListener('change', () => {
                selectedBank = bankSelect.value;
                updateBankPreview();
                log(`å·²é€‰æ‹©é¢˜åº“: ${selectedBank}`, 'success');
            });

            document.getElementById('historyBtn').addEventListener('click', showHistoryModal);
            document.getElementById('closeHistoryModalBtn').addEventListener('click', () => document.getElementById('historyModal').style.display = 'none');
            document.getElementById('clearHistoryBtn').addEventListener('click', clearUrlHistory);
            
            document.addEventListener('keydown', (e) => {
                if (e.key === 'F12') {
                    e.preventDefault();
                    if (window.electronAPI) {
                        window.electronAPI.toggleDevTools().then(result => {
                            if (result.success) {
                                showShortcutNotification('å¼€å‘è€…å·¥å…·å·²åˆ‡æ¢');
                                log('F12å¿«æ·é”®: å¼€å‘è€…å·¥å…·å·²åˆ‡æ¢', 'success');
                            } else {
                                log(`F12å¿«æ·é”®å¤±è´¥: ${result.error}`, 'error');
                                backupF12Handler();
                            }
                        }).catch(error => {
                            log(`F12å¿«æ·é”®é”™è¯¯: ${error.message}`, 'error');
                            backupF12Handler();
                        });
                    } else {
                        log('F12å¿«æ·é”®: electronAPIæœªåŠ è½½ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ³•', 'warning');
                        backupF12Handler();
                    }
                }
                if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'I') {
                    e.preventDefault();
                    if (window.electronAPI) {
                        window.electronAPI.toggleDevTools().then(result => {
                            if (result.success) {
                                showShortcutNotification('å¼€å‘è€…å·¥å…·å·²åˆ‡æ¢');
                                log('Ctrl+Shift+Iå¿«æ·é”®: å¼€å‘è€…å·¥å…·å·²åˆ‡æ¢', 'success');
                            }
                        });
                    }
                }
            });
            
            document.getElementById('addBankBtn').addEventListener('click', () => {
                isEditingBank = false;
                editingBankName = "";
                document.getElementById('modalTitle').textContent = 'æ–°å»ºé¢˜åº“';
                document.getElementById('bankNameInput').value = '';
                document.getElementById('bankDescription').value = '';
                document.getElementById('basicInfoCount').value = '';
                document.getElementById('startQuestionNum').value = '';
                document.getElementById('bankContentTextarea').value = '';
                document.getElementById('basicInfoTextarea').value = '';
                const basicInfoCount = parseInt(document.getElementById('basicInfoCount').value) || 0;
                const basicInfoContainer = document.getElementById('basicInfoContainer');
                basicInfoContainer.style.display = basicInfoCount > 0 ? 'block' : 'none';
                updateLineCount();
                document.getElementById('bankEditorModal').style.display = 'flex';
            });
            
            document.getElementById('editBankBtn').addEventListener('click', () => {
                if (!questionBanks[selectedBank]) { log('é”™è¯¯: æœªæ‰¾åˆ°å½“å‰é¢˜åº“æ•°æ®', 'error'); return; }
                isEditingBank = true;
                editingBankName = selectedBank;
                const bank = questionBanks[selectedBank];
                document.getElementById('modalTitle').textContent = 'ç¼–è¾‘é¢˜åº“';
                document.getElementById('bankNameInput').value = bank.name || selectedBank;
                document.getElementById('bankDescription').value = bank.description || '';
                document.getElementById('basicInfoCount').value = bank.basicInfoCount || 2;
                document.getElementById('startQuestionNum').value = bank.startQuestionNum || 3;
                const basicInfoCount = bank.basicInfoCount || 0;
                const basicInfoContainer = document.getElementById('basicInfoContainer');
                basicInfoContainer.style.display = basicInfoCount > 0 ? 'block' : 'none';
                let basicInfoText = '';
                let questionText = '';
                const answers = bank.answers || {};
                const questionNumbers = Object.keys(answers).filter(key => key.match(/^\d+$/)).map(Number).sort((a,b)=>a-b);
                for (let i = 1; i <= basicInfoCount; i++) {
                    if (answers[i] && answers[i].length > 0) basicInfoText += answers[i][0] + '\n';
                }
                const startNum = bank.startQuestionNum || 3;
                for (let i = startNum; i <= Math.max(...questionNumbers); i++) {
                    if (answers[i] && answers[i].length > 0) questionText += answers[i][0] + '\n';
                }
                document.getElementById('basicInfoTextarea').value = basicInfoText.trim();
                document.getElementById('bankContentTextarea').value = questionText.trim();
                updateLineCount();
                document.getElementById('bankEditorModal').style.display = 'flex';
            });
            
            document.getElementById('deleteBankBtn').addEventListener('click', () => {
                if (selectedBank === DEFAULT_QUESTION_BANK.name) {
                    log('é»˜è®¤é¢˜åº“ä¸èƒ½åˆ é™¤', 'error');
                    alert('é»˜è®¤é¢˜åº“ä¸èƒ½åˆ é™¤ï¼Œå¦‚éœ€åˆ é™¤è¯·å…ˆåˆ›å»ºå…¶ä»–é¢˜åº“ã€‚');
                    return;
                }
                if (Object.keys(questionBanks).length <= 1) {
                    log('ä¸èƒ½åˆ é™¤æœ€åä¸€ä¸ªè‡ªå®šä¹‰é¢˜åº“', 'error');
                    alert('ä¸èƒ½åˆ é™¤æœ€åä¸€ä¸ªè‡ªå®šä¹‰é¢˜åº“ï¼Œè¯·è‡³å°‘ä¿ç•™ä¸€ä¸ªé¢˜åº“ã€‚');
                    return;
                }
                bankToDelete = selectedBank;
                document.getElementById('deleteBankNameDisplay').textContent = bankToDelete;
                document.getElementById('deleteBankNameCopy').textContent = bankToDelete;
                document.getElementById('confirmDeleteInput').value = '';
                const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
                confirmDeleteBtn.disabled = true;
                confirmDeleteBtn.style.opacity = '0.5';
                confirmDeleteBtn.style.cursor = 'not-allowed';
                document.getElementById('deleteConfirmModal').style.display = 'flex';
            });
            
            document.getElementById('bankInfoBtn').addEventListener('click', () => {
                if (!questionBanks[selectedBank]) { log('é”™è¯¯: æœªæ‰¾åˆ°å½“å‰é¢˜åº“æ•°æ®', 'error'); return; }
                const bank = questionBanks[selectedBank];
                const answers = bank.answers || {};
                const totalQuestions = Object.keys(answers).length;
                const basicInfoCount = bank.basicInfoCount || 2;
                const validQuestions = Math.max(0, totalQuestions - basicInfoCount);
                document.getElementById('infoModalTitle').textContent = 'é¢˜åº“ä¿¡æ¯';
                document.getElementById('infoBankName').textContent = bank.name || selectedBank;
                document.getElementById('infoBankDescription').textContent = bank.description || 'æš‚æ— æè¿°';
                document.getElementById('infoTotalQuestions').textContent = totalQuestions;
                document.getElementById('infoBasicQuestions').textContent = basicInfoCount;
                document.getElementById('infoValidQuestions').textContent = validQuestions;
                document.getElementById('infoStartNumber').textContent = bank.startQuestionNum || 3;
                document.getElementById('infoCalculationExample').textContent = `ç¤ºä¾‹ï¼šæ€»é¢˜ç›®${totalQuestions}é¢˜ï¼ŒåŸºç¡€ä¿¡æ¯${basicInfoCount}é¢˜ï¼Œæœ‰æ•ˆé¢˜ç›®${validQuestions}é¢˜`;
                if (validQuestions > 0) {
                    const neededCorrect = Math.ceil(validQuestions * accuracy / 100);
                    document.getElementById('infoAccuracyExample').textContent = `è®¾å®š${accuracy}%æ­£ç¡®ç‡æ—¶ï¼Œéœ€è¦æ­£ç¡® ceil(${validQuestions} Ã— ${accuracy}%) = ${neededCorrect} é¢˜`;
                } else {
                    document.getElementById('infoAccuracyExample').textContent = 'æœ‰æ•ˆé¢˜ç›®æ•°ä¸º0ï¼Œæ— æ³•è®¡ç®—æ­£ç¡®ç‡';
                }
                document.getElementById('bankInfoModal').style.display = 'flex';
            });

            document.getElementById('exportBankBtn').addEventListener('click', exportCurrentBank);
            document.getElementById('importBankBtn').addEventListener('click', importBank);
            document.getElementById('closeImportResultBtn').addEventListener('click', () => document.getElementById('importResultModal').style.display = 'none');
            document.getElementById('confirmImportBtn').addEventListener('click', confirmImportBanks);
            document.getElementById('closeModalBtn').addEventListener('click', closeBankEditor);
            document.getElementById('cancelEditBtn').addEventListener('click', closeBankEditor);
            document.getElementById('saveBankBtn').addEventListener('click', saveBank);
            document.getElementById('closeInfoModalBtn').addEventListener('click', closeBankInfo);
            document.getElementById('closeInfoBtn').addEventListener('click', closeBankInfo);
            document.getElementById('closeDeleteModalBtn').addEventListener('click', closeDeleteConfirm);
            document.getElementById('cancelDeleteBtn').addEventListener('click', closeDeleteConfirm);
            document.getElementById('confirmDeleteBtn').addEventListener('click', confirmDeleteBank);
            
            document.getElementById('confirmDeleteInput').addEventListener('input', function() {
                const inputValue = this.value.trim();
                const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
                if (inputValue === bankToDelete) {
                    confirmDeleteBtn.disabled = false;
                    confirmDeleteBtn.style.opacity = '1';
                    confirmDeleteBtn.style.cursor = 'pointer';
                    confirmDeleteBtn.style.boxShadow = '0 10px 25px rgba(244, 67, 54, 0.3)';
                } else {
                    confirmDeleteBtn.disabled = true;
                    confirmDeleteBtn.style.opacity = '0.5';
                    confirmDeleteBtn.style.cursor = 'not-allowed';
                    confirmDeleteBtn.style.boxShadow = 'none';
                }
            });
            
            document.getElementById('basicInfoCount').addEventListener('input', function() {
                const basicInfoCount = parseInt(this.value) || 0;
                const basicInfoContainer = document.getElementById('basicInfoContainer');
                basicInfoContainer.style.display = basicInfoCount > 0 ? 'block' : 'none';
                const value = parseInt(this.value) || 0;
                if (value < 0) this.value = 0;
                if (value > 20) this.value = 20;
            });
            
            document.getElementById('startQuestionNum').addEventListener('input', function() {
                const value = parseInt(this.value) || 1;
                if (value < 1) this.value = 1;
                if (value > 1000) this.value = 1000;
            });
            
            const textarea = document.getElementById('bankContentTextarea');
            textarea.addEventListener('input', function() {
                updateLineCount();
                autoExpandTextarea(this);
            });
            
            const basicInfoTextarea = document.getElementById('basicInfoTextarea');
            if (basicInfoTextarea) basicInfoTextarea.addEventListener('input', function() {});
            
            document.getElementById('btnOpen').addEventListener('click', openWjxPage);
            document.getElementById('btnStart').addEventListener('click', startAutoAnswer);
            
            if (window.electronAPI) {
                window.electronAPI.onWjxLoaded((event, success, error) => {
                    if (success) {
                        log('é—®å·é¡µé¢åŠ è½½å®Œæˆï¼Œè„šæœ¬æ³¨å…¥æˆåŠŸ', 'success');
                        document.getElementById('btnStart').disabled = false;
                        const btn = document.getElementById('btnStart');
                        const loading = btn.querySelector('.loading');
                        btn.disabled = false;
                        loading.style.display = 'none';
                        btn.innerHTML = 'å¼€å§‹è‡ªåŠ¨ç­”é¢˜';
                    } else {
                        log(`è„šæœ¬æ³¨å…¥å¤±è´¥: ${error}`, 'error');
                    }
                });
                window.electronAPI.onWjxClosed(() => {
                    log('é—®å·çª—å£å·²å…³é—­', 'warning');
                    wjxWindowId = null;
                    document.getElementById('btnStart').disabled = true;
                });
                window.electronAPI.onWjxError((error) => {
                    log(`é¡µé¢åŠ è½½é”™è¯¯: ${error}`, 'error');
                });
            }
        }

        function backupF12Handler() {
            console.log('æ­£åœ¨å°è¯•æ‰“å¼€å¼€å‘è€…å·¥å…·...');
            try {
                if (typeof window.devtools !== 'undefined') window.devtools.open();
                showShortcutNotification('è¯·æ£€æŸ¥ç³»ç»Ÿå¿«æ·é”®è®¾ç½®æˆ–ä½¿ç”¨Ctrl+Shift+I');
                const helpMsg = 'å¦‚æœF12æ— æ•ˆï¼Œè¯·å°è¯•: 1) æ£€æŸ¥ç³»ç»Ÿå¿«æ·é”®è®¾ç½® 2) ä½¿ç”¨Ctrl+Shift+I 3) å³é”®ç‚¹å‡»é¡µé¢é€‰æ‹©"æ£€æŸ¥"';
                log(helpMsg, 'warning');
            } catch (error) { console.warn('å¤‡ç”¨F12å¤„ç†æ–¹æ³•å¤±è´¥:', error); }
        }
        
        // ==================== åŸæœ‰é¢˜åº“å­˜å‚¨æ“ä½œ ====================
        function loadBanksFromStorage() {
            try {
                const savedBanks = localStorage.getItem('questionBanksV7');
                if (savedBanks) {
                    questionBanks = JSON.parse(savedBanks);
                    log('ä»æœ¬åœ°å­˜å‚¨åŠ è½½é¢˜åº“æˆåŠŸ', 'success');
                } else {
                    questionBanks[DEFAULT_QUESTION_BANK.name] = DEFAULT_QUESTION_BANK;
                    log('ä½¿ç”¨é»˜è®¤é¢˜åº“', 'info');
                }
            } catch (e) {
                log('åŠ è½½é¢˜åº“å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤é¢˜åº“: ' + e.message, 'error');
                questionBanks[DEFAULT_QUESTION_BANK.name] = DEFAULT_QUESTION_BANK;
            }
        }
        
        function saveBanksToStorage() {
            try {
                localStorage.setItem('questionBanksV7', JSON.stringify(questionBanks));
                return true;
            } catch (e) {
                log('ä¿å­˜é¢˜åº“åˆ°æœ¬åœ°å­˜å‚¨å¤±è´¥: ' + e.message, 'error');
                return false;
            }
        }
        
        function loadUrlHistory() {
            try {
                const savedHistory = localStorage.getItem('urlHistoryV7');
                if (savedHistory) {
                    urlHistory = JSON.parse(savedHistory);
                    log(`åŠ è½½é“¾æ¥å†å²è®°å½•æˆåŠŸ: ${urlHistory.length} æ¡`, 'success');
                } else {
                    urlHistory = [];
                    log('æ— å†å²é“¾æ¥è®°å½•', 'info');
                }
            } catch (e) {
                log('åŠ è½½é“¾æ¥å†å²è®°å½•å¤±è´¥: ' + e.message, 'error');
                urlHistory = [];
            }
        }
        
        function saveUrlHistory() {
            try {
                localStorage.setItem('urlHistoryV7', JSON.stringify(urlHistory));
                updateHistoryCount();
                return true;
            } catch (e) {
                log('ä¿å­˜é“¾æ¥å†å²è®°å½•å¤±è´¥: ' + e.message, 'error');
                return false;
            }
        }
        
        function updateHistoryCount() {
            const historyCountElement = document.getElementById('historyCount');
            if (historyCountElement) historyCountElement.textContent = urlHistory.length;
        }
        
        function showHistoryModal() {
            const historyList = document.getElementById('historyList');
            const historyEmpty = document.getElementById('historyEmpty');
            if (urlHistory.length === 0) {
                historyList.style.display = 'none';
                historyEmpty.style.display = 'block';
            } else {
                historyList.style.display = 'block';
                historyEmpty.style.display = 'none';
                const sortedHistory = [...urlHistory].sort((a, b) => new Date(b.lastAccessed) - new Date(a.lastAccessed));
                historyList.innerHTML = '';
                sortedHistory.forEach((item, index) => {
                    const historyItem = document.createElement('div');
                    historyItem.className = 'history-item';
                    if (item.id === currentUrlId) historyItem.classList.add('selected');
                    historyItem.innerHTML = `
                        <div class="history-info">
                            <div class="history-title">${item.title || 'æœªå‘½åé“¾æ¥'}</div>
                            <div class="history-url">${item.suffix}</div>
                            <div class="history-date">æœ€åè®¿é—®: ${formatDate(item.lastAccessed)}</div>
                        </div>
                        <div class="history-actions">
                            <button class="history-action-btn select" title="é€‰æ‹©æ­¤é“¾æ¥" data-id="${item.id}">âœ…</button>
                            <button class="history-action-btn delete" title="åˆ é™¤æ­¤é“¾æ¥" data-id="${item.id}">âŒ</button>
                        </div>
                    `;
                    historyList.appendChild(historyItem);
                });
                document.querySelectorAll('.history-action-btn.select').forEach(btn => {
                    btn.addEventListener('click', function() { selectHistoryItem(this.getAttribute('data-id')); });
                });
                document.querySelectorAll('.history-action-btn.delete').forEach(btn => {
                    btn.addEventListener('click', function() { deleteHistoryItem(this.getAttribute('data-id')); });
                });
            }
            document.getElementById('historyModal').style.display = 'flex';
        }
        
        function selectHistoryItem(id) {
            const item = urlHistory.find(h => h.id === id);
            if (item) {
                document.getElementById('urlSuffix').value = item.suffix;
                currentUrlId = item.id;
                document.getElementById('currentUrlTitle').textContent = item.title || 'æœªå‘½åé“¾æ¥';
                item.lastAccessed = new Date().toISOString();
                saveUrlHistory();
                log(`å·²é€‰æ‹©é“¾æ¥: ${item.title || item.suffix}`, 'success');
                document.getElementById('historyModal').style.display = 'none';
            }
        }
        
        function deleteHistoryItem(id) {
            const index = urlHistory.findIndex(h => h.id === id);
            if (index !== -1) {
                const item = urlHistory[index];
                if (confirm(`ç¡®å®šè¦åˆ é™¤é“¾æ¥ "${item.title || item.suffix}" å—ï¼Ÿ`)) {
                    urlHistory.splice(index, 1);
                    saveUrlHistory();
                    if (currentUrlId === id) {
                        currentUrlId = null;
                        document.getElementById('currentUrlTitle').textContent = 'æœªè®¾ç½®';
                    }
                    log(`å·²åˆ é™¤é“¾æ¥: ${item.title || item.suffix}`, 'success');
                    showHistoryModal();
                }
            }
        }
        
        function clearUrlHistory() {
            if (urlHistory.length === 0) return;
            if (confirm(`ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰ ${urlHistory.length} æ¡é“¾æ¥å†å²è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼`)) {
                urlHistory = [];
                saveUrlHistory();
                currentUrlId = null;
                document.getElementById('currentUrlTitle').textContent = 'æœªè®¾ç½®';
                log('å·²æ¸…ç©ºæ‰€æœ‰é“¾æ¥å†å²è®°å½•', 'success');
                showHistoryModal();
            }
        }
        
        function addUrlToHistory(suffix, title) {
            const existingIndex = urlHistory.findIndex(h => h.suffix === suffix);
            if (existingIndex !== -1) {
                urlHistory[existingIndex].title = title || urlHistory[existingIndex].title;
                urlHistory[existingIndex].lastAccessed = new Date().toISOString();
                currentUrlId = urlHistory[existingIndex].id;
            } else {
                const newItem = {
                    id: Date.now().toString(),
                    suffix: suffix,
                    title: title || `é“¾æ¥ ${urlHistory.length + 1}`,
                    created: new Date().toISOString(),
                    lastAccessed: new Date().toISOString()
                };
                urlHistory.push(newItem);
                currentUrlId = newItem.id;
                if (urlHistory.length > 50) {
                    urlHistory.sort((a, b) => new Date(a.lastAccessed) - new Date(b.lastAccessed));
                    urlHistory.shift();
                }
            }
            saveUrlHistory();
            updateHistoryCount();
            document.getElementById('currentUrlTitle').textContent = title || 'æœªå‘½åé“¾æ¥';
            return currentUrlId;
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);
            if (diffMins < 1) return 'åˆšåˆš';
            else if (diffMins < 60) return `${diffMins}åˆ†é’Ÿå‰`;
            else if (diffHours < 24) return `${diffHours}å°æ—¶å‰`;
            else if (diffDays < 7) return `${diffDays}å¤©å‰`;
            else return date.toLocaleDateString('zh-CN');
        }
        
        function updateBankSelect() {
            const bankSelect = document.getElementById('bankSelect');
            bankSelect.innerHTML = '';
            Object.keys(questionBanks).forEach(bankName => {
                const option = document.createElement('option');
                option.value = bankName;
                option.textContent = bankName;
                if (bankName === DEFAULT_QUESTION_BANK.name) option.textContent += ' (é»˜è®¤)';
                bankSelect.appendChild(option);
            });
            bankSelect.value = selectedBank;
        }
        
        function updateBankPreview() {
            const bankPreview = document.getElementById('bankPreview');
            const bank = questionBanks[selectedBank];
            if (!bank) {
                bankPreview.innerHTML = `<div class="bank-header"><div class="bank-stats">é¢˜åº“æ•°æ®é”™è¯¯</div></div><div class="bank-items"><div class="bank-item">æ— æ³•åŠ è½½é¢˜åº“ä¿¡æ¯</div></div>`;
                return;
            }
            const answers = bank.answers || {};
            const totalQuestions = Object.keys(answers).length;
            const basicInfoCount = bank.basicInfoCount || 2;
            const validQuestions = Math.max(0, totalQuestions - basicInfoCount);
            const startQuestionNum = bank.startQuestionNum || 3;
            const previewTitle = bankPreview.querySelector('.bank-header');
            if (previewTitle) {
                previewTitle.innerHTML = `<div class="bank-stats">é¢˜ç›®: ${totalQuestions}é¢˜ | æœ‰æ•ˆ: ${validQuestions}é¢˜ | åŸºç¡€ä¿¡æ¯: ${basicInfoCount}é¢˜</div>`;
            }
            const bankItems = bankPreview.querySelector('.bank-items');
            if (bankItems) {
                let previewHTML = '';
                const questionNumbers = Object.keys(answers).filter(key => key.match(/^\d+$/)).map(Number).sort((a,b)=>a-b);
                for (let i = 1; i <= Math.min(basicInfoCount, 2); i++) {
                    if (answers[i]) previewHTML += `<div class="bank-item">ç¬¬${i}é¢˜ (åŸºç¡€ä¿¡æ¯): ${answers[i][0] || ''}</div>`;
                }
                let count = 0;
                for (let i = startQuestionNum; i <= Math.max(...questionNumbers) && count < 8; i++) {
                    if (answers[i] && answers[i].length > 0) {
                        previewHTML += `<div class="bank-item">ç¬¬${i}é¢˜: ${answers[i][0] || ''}</div>`;
                        count++;
                    }
                }
                if (validQuestions > 8) previewHTML += `<div class="bank-item" style="border-left-color: #FF9800; font-style: italic;">è¿˜æœ‰ ${validQuestions - 8} é¢˜æœªæ˜¾ç¤º...</div>`;
                if (validQuestions === 0) previewHTML = `<div class="bank-item" style="border-left-color: #f44336;">é¢˜åº“ä¸­æ²¡æœ‰æœ‰æ•ˆé¢˜ç›®ï¼Œè¯·ç¼–è¾‘é¢˜åº“æ·»åŠ ç­”æ¡ˆ</div>`;
                bankItems.innerHTML = previewHTML;
            }
            updateAccuracyExamples();
        }
        
        function updateAccuracyExamples() {
            const bank = questionBanks[selectedBank];
            if (!bank) return;
            const answers = bank.answers || {};
            const totalQuestions = Object.keys(answers).length;
            const basicInfoCount = bank.basicInfoCount || 2;
            const validQuestions = Math.max(0, totalQuestions - basicInfoCount);
            if (validQuestions > 0) {
                const neededCorrect = Math.ceil(validQuestions * accuracy / 100);
                const actualAccuracy = (neededCorrect / validQuestions * 100).toFixed(1);
                const accuracyInfo = document.querySelector('.accuracy-info');
                if (accuracyInfo) {
                    accuracyInfo.innerHTML = `
                        <strong>å»ä¸€æ³•è®¡ç®—è§„åˆ™ï¼š</strong><br>
                        æœ‰æ•ˆé¢˜ç›®æ•° = æ€»é¢˜ç›®æ•° - åŸºç¡€ä¿¡æ¯å¡«å†™é¢˜æ•° = ${validQuestions}é¢˜<br>
                        éœ€è¦æ­£ç¡®çš„é¢˜æ•° = ceil(${validQuestions} Ã— ${accuracy}%) = ${neededCorrect}é¢˜<br>
                        å®é™…æ­£ç¡®ç‡ = ${neededCorrect}/${validQuestions} = ${actualAccuracy}% â‰¥ ${accuracy}%
                    `;
                }
            }
        }
        
        function autoExpandTextarea(textarea) {
            const lines = textarea.value.split('\n').length;
            const newMaxLines = Math.min(1000, Math.max(100, Math.ceil(lines / 100) * 100));
            if (newMaxLines > maxLines) {
                maxLines = newMaxLines;
                textarea.rows = Math.min(30, Math.max(15, Math.ceil(lines * 0.8)));
                updateLineCount();
                log(`é¢˜åº“å®¹é‡å·²æ‰©å±•è‡³ ${maxLines} è¡Œ`, 'info');
            }
        }
        
        function updateLineCount() {
            const textarea = document.getElementById('bankContentTextarea');
            const lines = textarea.value.split('\n').filter(line => line.trim() !== '');
            const lineCount = lines.length;
            document.getElementById('currentLineCount').textContent = `${lineCount} è¡Œ`;
            document.getElementById('usedLines').textContent = lineCount;
            document.getElementById('remainingLines').textContent = maxLines - lineCount;
            document.getElementById('maxLinesInfo').textContent = `æœ€å¤§æ”¯æŒ: ${maxLines} è¡Œ`;
            const remaining = maxLines - lineCount;
            const remainingElement = document.getElementById('remainingLines');
            if (remaining <= 10) remainingElement.style.color = '#f44336';
            else if (remaining <= 50) remainingElement.style.color = '#FF9800';
            else remainingElement.style.color = '#4CAF50';
            if (lineCount >= maxLines - 5 && maxLines < 1000) log(`æç¤ºï¼šé¢˜åº“å³å°†æ»¡ ${maxLines} è¡Œï¼Œä¿å­˜æ—¶ä¼šè‡ªåŠ¨æ‰©å±•`, 'warning');
        }
        
        function closeBankEditor() { document.getElementById('bankEditorModal').style.display = 'none'; }
        function closeBankInfo() { document.getElementById('bankInfoModal').style.display = 'none'; }
        function closeDeleteConfirm() { document.getElementById('deleteConfirmModal').style.display = 'none'; bankToDelete = ""; }
        
        function confirmDeleteBank() {
            if (!bankToDelete || bankToDelete === "") { log('é”™è¯¯: æœªæŒ‡å®šè¦åˆ é™¤çš„é¢˜åº“', 'error'); return; }
            delete questionBanks[bankToDelete];
            saveBanksToStorage();
            updateBankSelect();
            selectedBank = Object.keys(questionBanks)[0];
            document.getElementById('bankSelect').value = selectedBank;
            updateBankPreview();
            log(`å·²åˆ é™¤é¢˜åº“: ${bankToDelete}`, 'success');
            closeDeleteConfirm();
        }
        
        function saveBank() {
            const bankName = document.getElementById('bankNameInput').value.trim();
            const description = document.getElementById('bankDescription').value.trim();
            const basicInfoCount = parseInt(document.getElementById('basicInfoCount').value) || 0;
            const startQuestionNum = parseInt(document.getElementById('startQuestionNum').value) || 3;
            const basicInfoContent = document.getElementById('basicInfoTextarea').value.trim();
            const questionContent = document.getElementById('bankContentTextarea').value.trim();
            if (!bankName) { log('é”™è¯¯: é¢˜åº“åç§°ä¸èƒ½ä¸ºç©º', 'error'); return; }
            if (bankName === DEFAULT_QUESTION_BANK.name && !isEditingBank) { log('é”™è¯¯: ä¸èƒ½ä½¿ç”¨é»˜è®¤é¢˜åº“åç§°', 'error'); return; }
            const answers = {};
            if (basicInfoCount > 0 && basicInfoContent) {
                const basicInfoLines = basicInfoContent.split('\n').filter(line => line.trim() !== '');
                for (let i = 1; i <= Math.min(basicInfoCount, basicInfoLines.length); i++) {
                    const answerText = basicInfoLines[i-1].trim();
                    if (answerText) answers[i.toString()] = [answerText];
                }
            }
            const questionLines = questionContent.split('\n').filter(line => line.trim() !== '');
            let currentQuestionNum = startQuestionNum;
            questionLines.forEach((line, index) => {
                if (currentQuestionNum > 1000) { log(`è­¦å‘Š: é¢˜ç›®æ•°é‡è¶…è¿‡1000æ¡é™åˆ¶ï¼Œç¬¬${index + 1}è¡Œä¹‹åçš„å†…å®¹å°†è¢«å¿½ç•¥`, 'warning'); return; }
                const answerText = line.trim();
                if (answerText) {
                    const answerArray = [answerText];
                    if (answerText.length < 50) {
                        const letters = ['A', 'B', 'C', 'D'];
                        const letter = letters[Math.min(index, 3)];
                        answerArray.push(`${letter} ${answerText}`);
                    }
                    answers[currentQuestionNum.toString()] = answerArray;
                    currentQuestionNum++;
                }
            });
            const newBank = { name: bankName, description: description || '', basicInfoCount, startQuestionNum, answers };
            questionBanks[bankName] = newBank;
            if (isEditingBank && editingBankName !== bankName && questionBanks[editingBankName]) delete questionBanks[editingBankName];
            const success = saveBanksToStorage();
            if (success) {
                selectedBank = bankName;
                updateBankSelect();
                updateBankPreview();
                closeBankEditor();
                const totalQuestions = Object.keys(answers).length;
                log(`é¢˜åº“ "${bankName}" ä¿å­˜æˆåŠŸï¼ŒåŒ…å« ${totalQuestions} é“é¢˜ç›®`, 'success');
            } else {
                log('ä¿å­˜é¢˜åº“å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨å­˜å‚¨æƒé™', 'error');
            }
        }

        async function exportCurrentBank() {
            if (!selectedBank || !questionBanks[selectedBank]) { log('è¯·å…ˆé€‰æ‹©é¢˜åº“', 'warning'); return; }
            const bank = questionBanks[selectedBank];
            const answers = bank.answers || {};
            const totalQuestions = Object.keys(answers).length;
            if (totalQuestions === 0) { log('å½“å‰é¢˜åº“ä¸ºç©ºï¼Œæ— æ³•å¯¼å‡º', 'warning'); return; }
            log(`æ­£åœ¨å¯¼å‡ºé¢˜åº“: ${selectedBank}...`, 'info');
            try {
                const result = await window.electronAPI.exportBank({
                    name: bank.name || selectedBank,
                    description: bank.description || '',
                    basicInfoCount: bank.basicInfoCount || 2,
                    startQuestionNum: bank.startQuestionNum || 3,
                    answers: bank.answers,
                    exportInfo: { version: 'V8.0.2', exportedAt: new Date().toISOString(), totalQuestions, basicInfoCount: bank.basicInfoCount || 2 }
                });
                if (result.success) {
                    const sizeInKB = (result.size / 1024).toFixed(2);
                    log(`é¢˜åº“å¯¼å‡ºæˆåŠŸ: ${result.filePath} (${sizeInKB} KB, ${totalQuestions}é¢˜)`, 'success');
                    showNotification('å¯¼å‡ºæˆåŠŸ', `é¢˜åº“ "${selectedBank}" å·²æˆåŠŸå¯¼å‡ºä¸º ${result.format} æ ¼å¼æ–‡ä»¶`, 'success');
                } else {
                    log(`å¯¼å‡ºå¤±è´¥: ${result.error}`, 'error');
                }
            } catch (error) {
                log(`å¯¼å‡ºå‡ºé”™: ${error.message}`, 'error');
            }
        }

        // æ›´æ–°é¢˜ç›®åŒ¹é…å¤é€‰æ¡†çŠ¶æ€ï¼šæ— é¢˜åº“æ—¶ç¦ç”¨å¹¶å¼ºåˆ¶å…³é—­ï¼Œæœ‰é¢˜åº“æ—¶å¯ç”¨ä¸”æ¢å¤ç”¨æˆ·é€‰æ‹©ï¼ˆé»˜è®¤æœªå‹¾é€‰ï¼‰
        function updateMatchCheckboxState() {
            const cb = document.getElementById('enableQuestionMatch');
            if (!cb) return;
            const hasBanks = Object.keys(window.matchQuestionBanks).length > 0;
                
            if (!hasBanks) {
                cb.checked = false;
                cb.disabled = true;
                window.matchEnabled = false;
                // å¯é€‰çš„æ—¥å¿—æç¤ºï¼Œå–æ¶ˆæ³¨é‡Šä»¥å¯ç”¨
                // log('å½“å‰æ— é¢˜ç›®åŒ¹é…åº“ï¼Œå·²ç¦ç”¨é¢˜ç›®åŒ¹é…åŠŸèƒ½', 'info');
            } else {
                cb.disabled = false;
                // ä» localStorage æ¢å¤ç”¨æˆ·é€‰æ‹©ï¼ˆé»˜è®¤ falseï¼‰
                const saved = localStorage.getItem('matchEnabledState');
                cb.checked = saved === 'true' ? true : false;
                window.matchEnabled = cb.checked;
            }
        }

        // ==================== å¯¼å…¥é¢˜åº“ ====================
        async function importBank() {
            log('å‡†å¤‡å¯¼å…¥é¢˜åº“...', 'info');
            
            // åˆ›å»ºæ–‡ä»¶é€‰æ‹©å™¨
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json,application/json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(ev) {
                    try {
                        const bank = JSON.parse(ev.target.result);
                        
                        // éªŒè¯é¢˜åº“æ ¼å¼ï¼ˆå¿…é¡»åŒ…å« name å’Œ answersï¼‰
                        if (!bank.name || !bank.answers || typeof bank.answers !== 'object') {
                            alert('æ— æ•ˆçš„é¢˜åº“æ–‡ä»¶ï¼šç¼ºå°‘ name æˆ– answers å¯¹è±¡');
                            return;
                        }
                        
                        // å¤„ç†åŒåé¢˜åº“ï¼šè‡ªåŠ¨é‡å‘½å
                        let finalName = bank.name;
                        if (questionBanks[finalName]) {
                            let counter = 1;
                            while (questionBanks[`${finalName} (${counter})`]) counter++;
                            finalName = `${finalName} (${counter})`;
                        }
                        
                        // ä¿å­˜é¢˜åº“
                        questionBanks[finalName] = {
                            name: finalName,
                            description: bank.description || '',
                            basicInfoCount: bank.basicInfoCount || 2,
                            startQuestionNum: bank.startQuestionNum || 3,
                            answers: bank.answers || {}
                        };
                        
                        saveBanksToStorage();
                        updateBankSelect();
                        selectedBank = finalName;
                        document.getElementById('bankSelect').value = finalName;
                        updateBankPreview();
                        
                        log(`âœ… å¯¼å…¥é¢˜åº“: ${finalName} (${Object.keys(bank.answers).length}é¢˜)`, 'success');
                        showNotification('å¯¼å…¥æˆåŠŸ', `é¢˜åº“ "${finalName}" å·²å¯¼å…¥`, 'success');
                        updateMatchCheckboxState();
                        
                    } catch (ex) {
                        alert('è§£æå¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ˜¯å¦ä¸ºæœ‰æ•ˆçš„ JSON æ ¼å¼');
                        log(`âŒ å¯¼å…¥å¤±è´¥: ${ex.message}`, 'error');
                    }
                };
                reader.readAsText(file);
            };
            
            input.click();
        }

        async function batchImportBanks() {
            log('å‡†å¤‡æ‰¹é‡å¯¼å…¥é¢˜åº“...', 'info');
            try {
                const result = await window.electronAPI.importBanksFromFolder();
                if (result.success) {
                    if (result.importedBanks.length === 0) { log('æ–‡ä»¶å¤¹ä¸­æ²¡æœ‰æ‰¾åˆ°é¢˜åº“æ–‡ä»¶', 'warning'); return; }
                    showImportResults(result.importedBanks, result.successful, result.total);
                } else {
                    log(`æ‰¹é‡å¯¼å…¥å¤±è´¥: ${result.error}`, 'error');
                }
            } catch (error) {
                log(`æ‰¹é‡å¯¼å…¥å‡ºé”™: ${error.message}`, 'error');
            }
        }

        function showImportResults(importedBanks, successfulCount, totalCount) {
            const contentDiv = document.getElementById('importResultContent');
            let html = `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #8a8aff;">å¯¼å…¥ç»“æœ</h4>
                    <p>æˆåŠŸå¯¼å…¥: <span style="color: #4CAF50; font-weight: bold;">${successfulCount}</span> ä¸ªé¢˜åº“</p>
                    <p>æ€»è®¡: ${totalCount} ä¸ªæ–‡ä»¶</p>
                    ${successfulCount < totalCount ? `<p style="color: #FF9800;">${totalCount - successfulCount} ä¸ªæ–‡ä»¶å¯¼å…¥å¤±è´¥æˆ–æ ¼å¼æ— æ•ˆ</p>` : ''}
                </div>
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #8a8aff;">é¢˜åº“åˆ—è¡¨</h4>
                    <div style="max-height: 300px; overflow-y: auto;">
            `;
            const validBanks = importedBanks.filter(b => !b.error);
            if (validBanks.length > 0) {
                html += `<div style="margin-bottom: 15px;"><h5 style="color: #4CAF50;">âœ… å¯å¯¼å…¥çš„é¢˜åº“</h5>`;
                validBanks.forEach((bank, index) => {
                    const answers = bank.answers || {};
                    const totalQuestions = Object.keys(answers).length;
                    const basicInfoCount = bank.basicInfoCount || 0;
                    const validQuestions = Math.max(0, totalQuestions - basicInfoCount);
                    html += `
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <span style="font-weight: bold; font-size: 16px;">${bank.name}</span>
                                <span style="background: rgba(76, 175, 80, 0.2); color: #4CAF50; padding: 4px 8px; border-radius: 4px; font-size: 12px;">${totalQuestions}é¢˜</span>
                            </div>
                            <div style="color: #aaa; font-size: 13px; margin-bottom: 5px;">${bank.description || 'æš‚æ— æè¿°'}</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 12px; color: #888;">
                                <div>åŸºç¡€ä¿¡æ¯: ${basicInfoCount}é¢˜</div>
                                <div>æœ‰æ•ˆé¢˜ç›®: ${validQuestions}é¢˜</div>
                            </div>
                            <div style="margin-top: 10px; font-size: 11px; color: #666;">æ¥æº: ${path.basename(bank.originalPath || 'æœªçŸ¥')}</div>
                        </div>
                    `;
                });
                html += `</div>`;
            }
            const failedBanks = importedBanks.filter(b => b.error);
            if (failedBanks.length > 0) {
                html += `<div style="margin-bottom: 15px;"><h5 style="color: #f44336;">âŒ å¯¼å…¥å¤±è´¥</h5>`;
                failedBanks.forEach((bank, index) => {
                    html += `
                        <div style="background: rgba(244, 67, 54, 0.1); padding: 10px; border-radius: 6px; margin-bottom: 8px; border-left: 3px solid #f44336;">
                            <div style="color: #f44336; font-weight: bold; margin-bottom: 5px;">${path.basename(bank.path || 'æœªçŸ¥æ–‡ä»¶')}</div>
                            <div style="color: #FF9800; font-size: 13px;">${bank.error}</div>
                        </div>
                    `;
                });
                html += `</div>`;
            }
            html += `
                    </div>
                </div>
                <div style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 8px; margin-top: 20px;">
                    <h5 style="color: #8a8aff; margin-bottom: 10px;">å¯¼å…¥é€‰é¡¹</h5>
                    <div style="display: flex; gap: 15px; align-items: center;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="overwriteExisting" style="width: 18px; height: 18px;">
                            <span>è¦†ç›–åŒåé¢˜åº“</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="renameIfExists" checked style="width: 18px; height: 18px;">
                            <span>é‡å‘½ååŒåé¢˜åº“</span>
                        </label>
                    </div>
                </div>
            `;
            contentDiv.innerHTML = html;
            window._pendingImportBanks = validBanks;
            document.getElementById('importResultModal').style.display = 'flex';
        }

        function confirmImportBanks() {
            const pendingBanks = window._pendingImportBanks || [];
            const overwriteExisting = document.getElementById('overwriteExisting').checked;
            const renameIfExists = document.getElementById('renameIfExists').checked;
            let importedCount = 0, skippedCount = 0, renamedCount = 0, overwrittenCount = 0;
            pendingBanks.forEach(bank => {
                let bankName = bank.name;
                let finalName = bankName;
                if (questionBanks[bankName]) {
                    if (overwriteExisting) {
                        finalName = bankName;
                        overwrittenCount++;
                    } else if (renameIfExists) {
                        let newName = bankName;
                        let counter = 1;
                        while (questionBanks[newName]) newName = `${bankName} (${counter++})`;
                        finalName = newName;
                        renamedCount++;
                    } else {
                        log(`è·³è¿‡å·²å­˜åœ¨çš„é¢˜åº“: ${bankName}`, 'warning');
                        skippedCount++;
                        return;
                    }
                }
                questionBanks[finalName] = {
                    name: finalName,
                    description: bank.description || '',
                    basicInfoCount: bank.basicInfoCount || 2,
                    startQuestionNum: bank.startQuestionNum || 3,
                    answers: bank.answers || {}
                };
                importedCount++;
                log(`å¯¼å…¥é¢˜åº“: ${finalName} (${Object.keys(bank.answers || {}).length}é¢˜)`, 'success');
            });
            saveBanksToStorage();
            updateBankSelect();
            selectedBank = Object.keys(questionBanks)[Object.keys(questionBanks).length - 1];
            document.getElementById('bankSelect').value = selectedBank;
            updateBankPreview();
            let summary = `å¯¼å…¥å®Œæˆ: ${importedCount}ä¸ªé¢˜åº“`;
            if (skippedCount > 0) summary += `, è·³è¿‡${skippedCount}ä¸ª`;
            if (renamedCount > 0) summary += `, é‡å‘½å${renamedCount}ä¸ª`;
            if (overwrittenCount > 0) summary += `, è¦†ç›–${overwrittenCount}ä¸ª`;
            log(summary, 'success');
            showNotification('å¯¼å…¥å®Œæˆ', summary, 'success');
            document.getElementById('importResultModal').style.display = 'none';
            delete window._pendingImportBanks;
        }

        function showNotification(title, message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'rgba(76, 175, 80, 0.9)' : type === 'error' ? 'rgba(244, 67, 54, 0.9)' : 'rgba(33, 150, 243, 0.9)'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                z-index: 10000;
                font-size: 14px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                animation: slideInRight 0.3s ease, fadeOut 3s ease 2.7s;
                max-width: 400px;
                min-width: 300px;
            `;
            notification.innerHTML = `<div style="font-weight: bold; margin-bottom: 5px; font-size: 15px;">${title}</div><div style="font-size: 13px; opacity: 0.9;">${message}</div>`;
            document.body.appendChild(notification);
            setTimeout(() => { if (notification.parentNode) notification.parentNode.removeChild(notification); }, 3000);
        }

        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.shiftKey && e.key === 'E') { e.preventDefault(); exportCurrentBank(); }
            if (e.ctrlKey && e.shiftKey && e.key === 'I') { e.preventDefault(); importBank(); }
            if (e.ctrlKey && e.shiftKey && e.key === 'B') { e.preventDefault(); batchImportBanks(); }
        });
        
        // ==================== æ‰“å¼€é—®å·é¡µé¢ï¼ˆé›†æˆé¢˜ç›®åŒ¹é…é…ç½®ï¼‰====================
        async function openWjxPage() {
            if (!selectedSpeed) { log('è¯·å…ˆé€‰æ‹©ç­”é¢˜é€Ÿåº¦', 'warning'); return; }
            const urlSuffix = document.getElementById('urlSuffix').value.trim();
            if (!urlSuffix) { log('è¯·å¡«å†™é—®å·é“¾æ¥åç¼€', 'warning'); return; }
            if (!selectedBank || !questionBanks[selectedBank]) { log('è¯·é€‰æ‹©æœ‰æ•ˆçš„é¢˜åº“', 'warning'); return; }
            const bank = questionBanks[selectedBank];
            const answers = bank.answers || {};
            const totalQuestions = Object.keys(answers).length;
            const basicInfoCount = bank.basicInfoCount || 2;
            const validQuestions = Math.max(0, totalQuestions - basicInfoCount);
            if (validQuestions === 0) { log('è­¦å‘Š: é¢˜åº“ä¸­æ²¡æœ‰æœ‰æ•ˆé¢˜ç›®ï¼Œè¯·ç¼–è¾‘é¢˜åº“æ·»åŠ ç­”æ¡ˆ', 'warning'); return; }
            const isNewUrl = !urlHistory.some(h => h.suffix === urlSuffix);
            let urlTitle = '';
            if (isNewUrl) {
                try {
                    if (window.electronAPI && window.electronAPI.showInputDialog) {
                        const result = await window.electronAPI.showInputDialog({
                            title: 'è¾“å…¥é“¾æ¥æ ‡é¢˜',
                            message: 'è¯·è¾“å…¥æ­¤é—®å·é“¾æ¥çš„æ ‡é¢˜ï¼ˆç”¨äºå†å²è®°å½•è¯†åˆ«ï¼‰:',
                            defaultValue: `é—®å· ${urlHistory.length + 1}`
                        });
                        if (result && result.input) urlTitle = result.input.trim();
                        else log('ç”¨æˆ·å–æ¶ˆè¾“å…¥æ ‡é¢˜ï¼Œé“¾æ¥æœªä¿å­˜åˆ°å†å²è®°å½•', 'warning');
                    } else {
                        urlTitle = await showCustomInputDialog('é—®å·é“¾æ¥æ ‡é¢˜', 'è¯·è¾“å…¥æ­¤é—®å·é“¾æ¥çš„æ ‡é¢˜ï¼ˆç”¨äºå†å²è®°å½•è¯†åˆ«ï¼‰:', `é—®å· ${urlHistory.length + 1}`);
                    }
                } catch (error) {
                    console.error('è·å–æ ‡é¢˜æ—¶å‡ºé”™:', error);
                    urlTitle = `é—®å· ${urlHistory.length + 1}`;
                }
            }
            addUrlToHistory(urlSuffix, urlTitle);
            const neededCorrect = Math.ceil(validQuestions * accuracy / 100);
            const actualAccuracy = (neededCorrect / validQuestions * 100).toFixed(1);
            log(`æ­£åœ¨æ‰“å¼€é—®å·é¡µé¢ï¼Œé€Ÿåº¦: ${selectedSpeed.name}, æ­£ç¡®ç‡: ${accuracy}%, é¢˜åº“: ${selectedBank}...`, 'info');
            log(`é¢˜åº“ç»Ÿè®¡: æ€»${totalQuestions}é¢˜ï¼ŒåŸºç¡€ä¿¡æ¯${basicInfoCount}é¢˜ï¼Œæœ‰æ•ˆ${validQuestions}é¢˜ï¼Œéœ€è¦æ­£ç¡®${neededCorrect}é¢˜ï¼Œå®é™…æ­£ç¡®ç‡${actualAccuracy}%`, 'info');
            
            // ----- é¢˜ç›®åŒ¹é…é…ç½®-----
            // âœ… ä» window.matchEnabled è¯»å–çŠ¶æ€ï¼Œè¿™æ˜¯ç”± updateMatchCheckboxState å’Œç”¨æˆ·æ“ä½œåŒæ­¥
            const matchEnabled = window.matchEnabled === true;
            let matchBankData = null;
            if (matchEnabled) {
                const currentMatchBank = window.matchQuestionBanks?.[window.selectedMatchBank];
                if (currentMatchBank) {
                    matchBankData = {
                        name: currentMatchBank.name,
                        description: currentMatchBank.description || '',
                        basicInfoCount: currentMatchBank.basicInfoCount || 2,
                        startQuestionNum: currentMatchBank.startQuestionNum || 3,
                        answers: currentMatchBank.answers || {}
                    };
                    const total = Object.keys(matchBankData.answers).length;
                    const basic = matchBankData.basicInfoCount;
                    const valid = Math.max(0, total - basic);
                    log(`[é¢˜ç›®åŒ¹é…] å·²å¯ç”¨ï¼Œä½¿ç”¨é¢˜åº“: ${currentMatchBank.name} (æ€»${total}é¢˜, æœ‰æ•ˆ${valid}é¢˜, åŸºç¡€${basic}é¢˜)`, 'info');
                } else {
                    log('[é¢˜ç›®åŒ¹é…] å¯ç”¨ä½†æœªæ‰¾åˆ°é¢˜åº“ï¼Œå°†ä¸è¿›è¡Œé¢˜ç›®åŒ¹é…', 'warning');
                }
            } else {
                log('[é¢˜ç›®åŒ¹é…] åŠŸèƒ½æœªå¯ç”¨', 'info');
            }
            // ----- é¢˜ç›®åŒ¹é…é…ç½®ç»“æŸ -----

            try {
                const config = {
                    speedConfig: selectedSpeed,
                    accuracy: accuracy,
                    urlSuffix: urlSuffix,
                    selectedBank: selectedBank,
                    answers: answers,
                    basicInfoCount: basicInfoCount,
                    matchEnabled: matchEnabled,
                    matchBank: matchBankData
                };
                const result = await window.electronAPI.openWjxWindow(config);
                if (result.success) {
                    wjxWindowId = result.windowId;
                    log('é—®å·é¡µé¢å·²æ‰“å¼€ï¼Œè¯·ç­‰å¾…åŠ è½½...', 'success');
                    const btn = document.getElementById('btnStart');
                    const loading = btn.querySelector('.loading');
                    btn.disabled = true;
                    loading.style.display = 'inline-block';
                    btn.innerHTML = '<span class="loading"></span> ç­‰å¾…é¡µé¢åŠ è½½...';
                } else {
                    log('æ‰“å¼€é—®å·é¡µé¢å¤±è´¥', 'error');
                }
            } catch (error) {
                log(`æ‰“å¼€é¡µé¢å‡ºé”™: ${error.message}`, 'error');
            }
        }

        function showCustomInputDialog(title, message, defaultValue) {
            return new Promise((resolve) => {
                const modal = document.createElement('div');
                modal.className = 'modal';
                modal.style.display = 'flex';
                modal.style.zIndex = '2000';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 500px;">
                        <div class="modal-header">
                            <h3 style="color: #8a8aff;">${title}</h3>
                            <button class="close-modal" id="closeCustomDialog">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div style="color: #ccc; line-height: 1.6; margin-bottom: 20px;">${message}</div>
                            <input type="text" id="customInput" style="width: 100%; padding: 12px 15px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 16px;" value="${defaultValue || ''}">
                        </div>
                        <div class="modal-actions">
                            <button class="btn btn-open" id="cancelCustomDialog" style="flex: none; padding: 12px 25px;">å–æ¶ˆ</button>
                            <button class="btn btn-start" id="confirmCustomDialog" style="flex: none; padding: 12px 25px;">ç¡®å®š</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
                setTimeout(() => { const input = document.getElementById('customInput'); if (input) { input.focus(); input.select(); } }, 100);
                document.getElementById('closeCustomDialog').addEventListener('click', () => { document.body.removeChild(modal); resolve(null); });
                document.getElementById('cancelCustomDialog').addEventListener('click', () => { document.body.removeChild(modal); resolve(null); });
                document.getElementById('confirmCustomDialog').addEventListener('click', () => { const inputValue = document.getElementById('customInput').value.trim(); document.body.removeChild(modal); resolve(inputValue || defaultValue); });
                document.getElementById('customInput').addEventListener('keydown', (e) => { if (e.key === 'Enter') document.getElementById('confirmCustomDialog').click(); });
            });
        }
        
        async function startAutoAnswer() {
            log('æ­£åœ¨å¼€å§‹è‡ªåŠ¨ç­”é¢˜...', 'info');
            try {
                const result = await window.electronAPI.injectScript('if (window.startAutoAnswer) window.startAutoAnswer();');
                if (result.success) log('å·²è§¦å‘è‡ªåŠ¨ç­”é¢˜ï¼Œè¯·æŸ¥çœ‹é—®å·é¡µé¢', 'success');
                else log(`è§¦å‘ç­”é¢˜å¤±è´¥: ${result.error}`, 'error');
            } catch (error) {
                log(`å¯åŠ¨å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        function log(message, type = 'info') {
            const statusContent = document.getElementById('statusContent');
            const logDiv = document.createElement('div');
            logDiv.className = `log ${type}`;
            const timestamp = new Date().toLocaleTimeString();
            logDiv.textContent = `[${timestamp}] ${message}`;
            statusContent.appendChild(logDiv);
            statusContent.scrollTop = statusContent.scrollHeight;
        }
        
        window.clearLogs = function() { document.getElementById('statusContent').innerHTML = ''; log('æ—¥å¿—å·²æ¸…ç©º', 'info'); };

        // ==================== é¢˜ç›®åŒ¹é…ç‹¬ç«‹æ¨¡å—ï¼ˆV8.0.2æ–°å¢ï¼‰====================
        // å­˜å‚¨ç»“æ„ä¸ä¸»é¢˜åº“å®Œå…¨ä¸€è‡´ï¼š{ name, description, basicInfoCount, startQuestionNum, answers }
        (function(){
            'use strict';
            window.matchQuestionBanks = window.matchQuestionBanks || {};
            window.selectedMatchBank = null;
            window.matchEnabled = false;
            const DEFAULT_MATCH_BANK = {
                name: "2026ç†åŒ–ç”Ÿå®éªŒæ“ä½œæ¨¡æ‹Ÿè€ƒè¯•-åŒ–å­¦é¢˜ç›®",
                description: "æ±¤é€Šæ¹–åˆä¸­æ¨¡æ‹Ÿ",
                basicInfoCount: 2,
                startQuestionNum: 3,
                answers: {
                    "1": ["æ‚¨çš„å§“å"],
                    "2": ["æ‚¨çš„ç­çº§"],
                    "3": ["ä¸‹å›¾åŠ çƒ­é«˜ä¸‹åˆ—å›¾æ ‡ä¸ç”µè§£æ°´å®éªŒæ— å…³çš„æ˜¯"],
                    "4": ["ç”µè§£æ°´å®éªŒä¸éœ€è¦çš„ä»ªå™¨æ˜¯"],
                    "5": ["ç”µè§£æ°´å®éªŒä¸­ï¼Œåº”åœ¨ç”µè§£å™¨ä¸­åŠ æ°´è‡³"],
                    "6": ["ç”µè§£æ°´å®éªŒä¸­ï¼Œå¯è§‚å¯Ÿåˆ°"],
                    "7": ["ç”µè§£æ°´å®éªŒä¸­ï¼Œæ‰“å¼€ç”µæºå¼€å…³åç”µæé™„è¿‘æœ‰æ°”æ³¡äº§ç”Ÿï¼Œä¸‹åˆ—è¯´æ³•æ­£ç¡®çš„æ˜¯"],
                    "8": ["ç”µè§£æ°´ä¸€æ®µæ—¶é—´åå…³é—­ç”µæºï¼Œå¯è§‚å¯Ÿåˆ°"],
                    "9": ["ç‚¹ç‡ƒçº¯å‡€çš„æ°¢æ°”ï¼Œåœ¨ç«ç„°ä¸Šæ–¹ç½©ä¸€ä¸ªå¹²ç‡¥çš„çƒ§æ¯ï¼Œå¯è§‚å¯Ÿåˆ°"],
                    "10": ["ç”µè§£æ°´ä¸€æ®µæ—¶é—´åå…³é—­ç”µæºï¼Œaã€bç®¡å†…äº§ç”Ÿæ°”ä½“çš„ä½“ç§¯æ¯”çº¦ä¸º"],
                    "11": ["ç”µè§£æ°´ä¸€æ®µæ—¶é—´åå…³é—­ç”µæºï¼Œå°†ç‡ƒç€çš„æœ¨æ¡ä¼¸åˆ°ä¸ç”µæºæ­£æç›¸è¿çš„ç»ç’ƒç®¡å°–å˜´å£ï¼Œæ‰“å¼€æ´»å¡ï¼Œå¯è§‚å¯Ÿåˆ°"],
                    "12": ["è§‚çœ‹è§†é¢‘ï¼Œå…³äºè¯¥å®éªŒï¼Œä¸‹åˆ—è¯´æ³•é”™è¯¯çš„æ˜¯"],
                    "13": ["åˆ¶å–äºŒæ°§åŒ–ç¢³éœ€è¦ç”¨åˆ°ä¸‹å›¾æ‰€ç¤ºä»ªå™¨ã€‚è¯¥ä»ªå™¨çš„åç§°æ˜¯"],
                    "14": ["å–ç”¨å‡ å°å—çŸ³ç°çŸ³ï¼ˆæˆ–å¤§ç†çŸ³ï¼‰ï¼Œéœ€è¦ç”¨åˆ°çš„ä»ªå™¨æ˜¯"],
                    "15": ["å–ç”¨å‡ å°å—çŸ³ç°çŸ³ï¼ˆè‹¥è£…ç½®æ°”å¯†æ€§è‰¯å¥½ï¼Œå½“ç”¨æ‰‹ç´§æ¡è¯•ç®¡æ—¶ï¼Œå¯è§‚å¯Ÿåˆ°çš„ç°è±¡æ˜¯"],
                    "16": ["å®éªŒå®¤åˆ¶å–äºŒæ°§åŒ–ç¢³å¸¸ç”¨çš„è¯•å‰‚æ˜¯"],
                    "17": ["æ£€éªŒäºŒæ°§åŒ–ç¢³æ˜¯å¦é›†æ»¡çš„æ­£ç¡®æ“ä½œæ˜¯"],
                    "18": ["ä¸‹å›¾å®éªŒä¸èƒ½è¯´æ˜äºŒæ°§åŒ–ç¢³å…·æœ‰çš„æ€§è´¨æ˜¯"],
                    "19": ["å‘é›†æ»¡äºŒæ°§åŒ–ç¢³çš„å¡‘æ–™ç“¶ä¸­åŠ å…¥é€‚é‡çš„æ°´ï¼Œç«‹å³æ—‹ç´§ç“¶ç›–å¹¶æŒ¯è¡ï¼Œè§‚å¯Ÿåˆ°å¡‘æ–™ç“¶å˜ç˜ªï¼Œèƒ½å¾—å‡ºçš„ç»“è®ºæ˜¯"],
                    "20": ["å®éªŒå®¤åˆ¶å–äºŒæ°§åŒ–ç¢³ï¼Œå¯åœ¨ä¸‹å›¾ä¸­é€‰æ‹©çš„å‘ç”Ÿè£…ç½®å’Œæ”¶é›†è£…ç½®æ˜¯"],
                    "21": ["å–ä¸‰æœµç”¨çŸ³è•Šæº¶æ¶²æŸ“æˆç´«è‰²çš„å¹²ç‡¥çš„çº¸èŠ±ï¼Œåˆ†åˆ«è¿›è¡Œå¦‚å›¾æ‰€ç¤ºå®éªŒã€‚ä¸‹åˆ—è¯´æ³•æ­£ç¡®çš„æ˜¯"],
                    "22": ["ç‚¹å‡»è§‚çœ‹è§†é¢‘ã€‚æœ‰å…³äºŒæ°§åŒ–ç¢³çš„å®éªŒå®¤åˆ¶å–ä¸æ€§è´¨çš„å®éªŒï¼Œä¸‹åˆ—è¯´æ³•æ­£ç¡®çš„æ˜¯"],
                    "23": ["é€šè¿‡è§‚å¯Ÿé¢œè‰²å¯åŒºåˆ†ä¸€äº›é‡‘å±ï¼Œä¸‹å›¾ä¸­å¯èƒ½æ˜¯é‡‘å±é“œçš„æ˜¯"],
                    "24": ["é“å¯ä»¥å‹åˆ¶æˆåšåº¦ä¸º0.1ï½0.2 mmçš„é“ç®”ï¼Œè¯´æ˜é“å…·æœ‰è‰¯å¥½çš„"],
                    "25": ["ä¸‹å›¾å®éªŒèƒ½è¯´æ˜é“œæœ‰çš„æ€§è´¨æ˜¯"],
                    "26": ["ç¡¬é“ç‰‡å¯ä»¥åœ¨é“ç‰‡ä¸Šåˆ»ç”»å‡ºç—•è¿¹ï¼Œè¯´æ˜"],
                    "27": ["é•ä¸ç¨€ç›é…¸ååº”æœ‰æ°”ä½“äº§ç”Ÿã€‚å°†ç‡ƒç€çš„æœ¨æ¡æ”¾åœ¨è¯•ç®¡å£ï¼Œå¬åˆ°çˆ†é¸£å£°ï¼Œè¯´æ˜è¯¥æ°”ä½“å¯èƒ½æ˜¯"],
                    "28": ["åœ¨è£…æœ‰é“ã€é”Œã€é•ã€é“œçš„è¯•ç®¡ä¸­åˆ†åˆ«åŠ å…¥5 mLç¨€ç›é…¸ï¼Œä¸€æ®µæ—¶é—´åå®éªŒç°è±¡å¦‚å›¾æ‰€ç¤ºï¼Œâ‘¢å·è¯•ç®¡ä¸­è£…æœ‰çš„é‡‘å±æ˜¯"],
                    "29": ["é“œç‰‡åœ¨é…’ç²¾ç¯ä¸ŠåŠ çƒ­åè¡¨é¢å˜é»‘ï¼Œæ˜¯å› ä¸º"],
                    "30": ["å°†ä¸€æ ¹æ´å‡€çš„é“œä¸æµ¸å…¥ç¡é…¸é“¶æº¶æ¶²ä¸­ã€‚æœ‰å…³è¯¥å®éªŒè¯´æ³•é”™è¯¯çš„æ˜¯"],
                    "31": ["ä½¿ç”¨ä¸‹åˆ—å››ç§è¯•å‰‚è¿›è¡Œå®éªŒï¼Œä¸èƒ½å¾—å‡ºçš„é‡‘å±æ´»åŠ¨æ€§é¡ºåºæ˜¯"],
                    "32": ["å°†é“ä¸æ’å…¥ç¡«é…¸é“œæº¶æ¶²ä¸­ï¼Œç‚¹å‡»è§‚çœ‹è§†é¢‘ã€‚ä¸‹åˆ—è¯´æ³•ä¸­é”™è¯¯çš„æ˜¯"],
                    "33": ["æº¶è§£ç²—ç›æ—¶éœ€è¦ç”¨åˆ°ä¸‹å›¾æ‰€ç¤ºä»ªå™¨ã€‚è¯¥ä»ªå™¨çš„åç§°æ˜¯"],
                    "34": ["ç§°å–5.0 gç²—ç›ï¼Œéœ€è¦ç”¨åˆ°çš„ä»ªå™¨æ˜¯"],
                    "35": ["å°†ç²—ç›æº¶è§£äºæ°´ä¸­æ—¶ï¼Œç»ç’ƒæ£’çš„ä½œç”¨æ˜¯"],
                    "36": ["é‡å–10 mLæ°´æ—¶ï¼Œæ­£ç¡®çš„è¯»æ•°æ–¹å¼æ˜¯"],
                    "37": ["å¦‚ä¸‹å›¾æ‰€ç¤ºè¿›è¡Œè¿‡æ»¤æ“ä½œï¼Œç»ç’ƒæ£’çš„ä½œç”¨æ˜¯"],
                    "38": ["è’¸å‘é£Ÿç›æ°´æ—¶ï¼Œä¸éœ€è¦ç”¨åˆ°çš„ä»ªå™¨æ˜¯"],
                    "39": ["è¿‡æ»¤åæ‰€å¾—æ»¤æ¶²ä»ç„¶æµ‘æµŠï¼Œå¯èƒ½çš„åŸå› æ˜¯"],
                    "40": ["å…³äºè’¸å‘é£Ÿç›æ°´çš„æ“ä½œï¼Œä¸‹åˆ—è¯´æ³•æ­£ç¡®çš„æ˜¯"],
                    "41": ["æŒ‰ä¸‹å›¾å®éªŒæ“ä½œå¯ä»¥è¿›è¡Œåˆ†ç¦»çš„ä¸€ç»„ç‰©è´¨æ˜¯"],
                    "42": ["ç‚¹å‡»è§‚çœ‹è§†é¢‘ï¼Œâ€œç²—ç›ä¸­éš¾æº¶æ€§æ‚è´¨çš„å»é™¤â€å®éªŒç»“æŸåï¼Œè‹¥æ‰€å¾—ç²¾ç›çš„äº§ç‡åé«˜ï¼Œå¯èƒ½çš„åŸå› æ˜¯"]
                }
            };

            function loadMatchBanks() {
                try {
                    const saved = localStorage.getItem('matchQuestionBanksV7');
                    if (saved) {
                        window.matchQuestionBanks = JSON.parse(saved);
                    } else {
                        window.matchQuestionBanks = {};
                    }
                    
                    // å§‹ç»ˆç¡®ä¿é»˜è®¤é¢˜åº“å­˜åœ¨ï¼ˆå¦‚æœä¸å­˜åœ¨åˆ™æ·»åŠ ï¼‰
                    if (!window.matchQuestionBanks[DEFAULT_MATCH_BANK.name]) {
                        window.matchQuestionBanks[DEFAULT_MATCH_BANK.name] = JSON.parse(JSON.stringify(DEFAULT_MATCH_BANK));
                        log(`ğŸ“š å·²æ·»åŠ é»˜è®¤é¢˜åº“: ${DEFAULT_MATCH_BANK.name}`, 'info');
                    }
                    
                    const bankNames = Object.keys(window.matchQuestionBanks);
                    window.selectedMatchBank = bankNames.length > 0 ? bankNames[0] : null;
                } catch(e) {
                    console.warn('åŠ è½½é¢˜ç›®åŒ¹é…åº“å¤±è´¥', e);
                    window.matchQuestionBanks = {};
                    window.matchQuestionBanks[DEFAULT_MATCH_BANK.name] = JSON.parse(JSON.stringify(DEFAULT_MATCH_BANK));
                    window.selectedMatchBank = DEFAULT_MATCH_BANK.name;
                }
                updateMatchCheckboxState();
            }

            function saveMatchBanks() {
                try { 
                    localStorage.setItem('matchQuestionBanksV7', JSON.stringify(window.matchQuestionBanks)); 
                } catch(e) { 
                    console.error('ä¿å­˜é¢˜ç›®åŒ¹é…åº“å¤±è´¥', e); 
                }
            }

            function updateMatchBankSelect() {
                const select = document.getElementById('matchBankSelect');
                if (!select) return;
                select.innerHTML = '';
                Object.keys(window.matchQuestionBanks).forEach(name => {
                    const opt = document.createElement('option');
                    opt.value = name;
                    opt.textContent = name;
                    if (name === DEFAULT_MATCH_BANK.name) {
                        opt.textContent += ' (é»˜è®¤)';
                    }
                    select.appendChild(opt);
                });
                select.value = window.selectedMatchBank || Object.keys(window.matchQuestionBanks)[0];
                updateMatchCheckboxState();
            }

            function updateMatchBankPreview() {
                const bank = window.matchQuestionBanks?.[window.selectedMatchBank];
                const statsEl = document.getElementById('matchBankStats');
                const itemsEl = document.getElementById('matchBankItems');
                if (!bank || !statsEl || !itemsEl) {
                    if (statsEl) statsEl.innerHTML = 'é¢˜ç›®åŒ¹é…åº“: 0é¢˜ | æœ‰æ•ˆ: 0é¢˜ | åŸºç¡€ä¿¡æ¯: 0é¢˜';
                    if (itemsEl) itemsEl.innerHTML = '<div class="bank-item" style="border-left-color:#f44336;">æš‚æ— é¢˜åº“ï¼Œè¯·æ–°å»ºæˆ–å¯¼å…¥</div>';
                    return;
                }
                const answers = bank.answers || {};
                const total = Object.keys(answers).length;
                const basic = bank.basicInfoCount || 0;
                const valid = Math.max(0, total - basic);
                statsEl.innerHTML = `é¢˜ç›®åŒ¹é…åº“: ${total}é¢˜ | æœ‰æ•ˆ: ${valid}é¢˜ | åŸºç¡€ä¿¡æ¯: ${basic}é¢˜`;
                
                let html = '';
                const sortedKeys = Object.keys(answers).map(Number).filter(k => !isNaN(k)).sort((a,b)=>a-b);
                let count = 0;
                for (let key of sortedKeys) {
                    if (count >= 8) break;
                    if (answers[key] && answers[key].length) {
                        let qText = answers[key][0];
                        if (qText.length > 30) qText = qText.substr(0,27)+'â€¦';
                        html += `<div class="bank-item" title="${answers[key][0]}">ğŸ“Œ ç¬¬${key}é¢˜: ${qText}</div>`;
                        count++;
                    }
                }
                if (total === 0) html = '<div class="bank-item" style="border-left-color:#f44336;">æš‚æ— é¢˜ç›®ï¼Œè¯·ç¼–è¾‘æ·»åŠ </div>';
                else if (total > 8) html += `<div class="bank-item" style="border-left-color:#ff9800; font-style:italic;">...... ç­‰${total}æ¡</div>`;
                itemsEl.innerHTML = html;
            }

            function openMatchBankEditor(isEdit = false) {
                const modal = document.getElementById('matchBankEditorModal');
                const title = document.getElementById('matchModalTitle');
                const nameInput = document.getElementById('matchBankNameInput');
                const descInput = document.getElementById('matchBankDescription');
                const basicCountInput = document.getElementById('matchBasicInfoCount');
                const startNumInput = document.getElementById('matchStartQuestionNum');
                const contentTa = document.getElementById('matchBankContentTextarea');
                
                if (!isEdit) {
                    title.textContent = 'æ–°å»ºé¢˜ç›®åŒ¹é…åº“';
                    nameInput.value = '';
                    descInput.value = '';
                    basicCountInput.value = '2';
                    startNumInput.value = '3';
                    contentTa.value = '';
                    window.editingMatchBank = null;
                    document.getElementById('matchBasicInfoContainer').style.display = 'none';
                    document.getElementById('matchBasicInfoTextarea').value = '';
                } else {
                    const bank = window.matchQuestionBanks[window.selectedMatchBank];
                    if (!bank) return;
                    title.textContent = 'ç¼–è¾‘é¢˜ç›®åŒ¹é…åº“';
                    nameInput.value = bank.name || window.selectedMatchBank;
                    descInput.value = bank.description || '';
                    basicCountInput.value = bank.basicInfoCount || 2;
                    startNumInput.value = bank.startQuestionNum || 3;
                    const answers = bank.answers || {};
                    const sortedKeys = Object.keys(answers).map(Number).filter(k => !isNaN(k)).sort((a,b)=>a-b);
                    const lines = sortedKeys.map(k => answers[k][0] || '').join('\n');
                    contentTa.value = lines;
                    window.editingMatchBank = window.selectedMatchBank;
                    
                    let basicInfoText = '';
                    for (let i = 1; i <= bank.basicInfoCount; i++) {
                        if (bank.answers && bank.answers[i] && bank.answers[i].length > 0) {
                            basicInfoText += bank.answers[i][0] + '\n';
                        }
                    }
                    document.getElementById('matchBasicInfoTextarea').value = basicInfoText.trim();
                    const basicInfoContainer = document.getElementById('matchBasicInfoContainer');
                    basicInfoContainer.style.display = (bank.basicInfoCount > 0) ? 'block' : 'none';
                }
                updateMatchLineCount();
                modal.style.display = 'flex';
            }

            function updateMatchLineCount() {
                const ta = document.getElementById('matchBankContentTextarea');
                if (!ta) return;
                const lines = ta.value.split('\n').filter(l => l.trim() !== '').length;
                document.getElementById('matchCurrentLineCount').innerHTML = `${lines} è¡Œ`;
                document.getElementById('matchUsedLines').innerHTML = lines;
                const max = 1000;
                document.getElementById('matchRemainingLines').innerHTML = max - lines;
            }

            function saveMatchBank() {
                const name = document.getElementById('matchBankNameInput').value.trim();
                const desc = document.getElementById('matchBankDescription').value.trim();
                const basicInfoCount = parseInt(document.getElementById('matchBasicInfoCount').value) || 0;
                const startQuestionNum = parseInt(document.getElementById('matchStartQuestionNum').value) || 3;
                const basicInfoContent = document.getElementById('matchBasicInfoTextarea').value.trim();
                const content = document.getElementById('matchBankContentTextarea').value.trim();

                if (!name) { alert('é¢˜åº“åç§°ä¸èƒ½ä¸ºç©º'); return; }

                const answers = {};
                
                if (basicInfoCount > 0 && basicInfoContent) {
                    const basicInfoLines = basicInfoContent.split('\n').filter(line => line.trim() !== '');
                    for (let i = 1; i <= Math.min(basicInfoCount, basicInfoLines.length); i++) {
                        const answerText = basicInfoLines[i-1].trim();
                        if (answerText) answers[i.toString()] = [answerText];
                    }
                }

                const lines = content.split('\n').filter(l => l.trim() !== '');
                let curNum = startQuestionNum;
                lines.forEach((line, idx) => {
                    if (curNum > 1000) { 
                        log(`è­¦å‘Š: é¢˜ç›®æ•°é‡è¶…è¿‡1000æ¡é™åˆ¶ï¼Œç¬¬${idx+1}è¡Œä¹‹åå°†è¢«å¿½ç•¥`, 'warning'); 
                        return; 
                    }
                    const qText = line.trim();
                    if (qText) answers[curNum.toString()] = [qText];
                    curNum++;
                });

                const newBank = { name, description: desc, basicInfoCount, startQuestionNum, answers };
                if (window.editingMatchBank && window.editingMatchBank !== name) 
                    delete window.matchQuestionBanks[window.editingMatchBank];
                window.matchQuestionBanks[name] = newBank;
                saveMatchBanks();
                window.selectedMatchBank = name;
                updateMatchBankSelect();
                updateMatchBankPreview();
                document.getElementById('matchBankEditorModal').style.display = 'none';
                window.editingMatchBank = null;
                const total = Object.keys(answers).length;
                const valid = Math.max(0, total - basicInfoCount);
                log(`âœ… é¢˜ç›®åŒ¹é…åº“â€œ${name}â€ä¿å­˜æˆåŠŸï¼Œæ€»${total}é¢˜ï¼Œæœ‰æ•ˆ${valid}é¢˜ï¼ŒåŸºç¡€ä¿¡æ¯${basicInfoCount}é¢˜`, 'success');
                updateMatchCheckboxState();
            }

            // ----- ç›‘å¬åŸºç¡€ä¿¡æ¯é¢˜æ•°å˜åŒ– -----
            document.getElementById('matchBasicInfoCount')?.addEventListener('input', function() {
                const count = parseInt(this.value) || 0;
                const container = document.getElementById('matchBasicInfoContainer');
                if (container) container.style.display = count > 0 ? 'block' : 'none';
                if (count < 0) this.value = 0;
                if (count > 20) this.value = 20;
            });

            // ========== æ›´æ–°å¤é€‰æ¡†çŠ¶æ€ï¼ˆå®šä¹‰åœ¨ initMatchModule ä¹‹å‰ï¼‰==========
            function updateMatchCheckboxState() {
                const cb = document.getElementById('enableQuestionMatch');
                if (!cb) return;
                const hasBanks = Object.keys(window.matchQuestionBanks).length > 0;
                
                if (!hasBanks) {
                    cb.checked = false;
                    cb.disabled = true;
                    window.matchEnabled = false;  // âœ… åŒæ­¥çŠ¶æ€
                } else {
                    cb.disabled = false;
                    // ä» localStorage æ¢å¤ç”¨æˆ·é€‰æ‹©ï¼Œå¦‚æœæ²¡æœ‰è®°å½•åˆ™é»˜è®¤ä¸º false
                    const saved = localStorage.getItem('matchEnabledState');
                    cb.checked = saved === 'true' ? true : false;
                    window.matchEnabled = cb.checked;  // âœ… åŒæ­¥çŠ¶æ€
                }
            }
            // ========== updateMatchCheckboxState å®šä¹‰ç»“æŸ ==========

            function setupMatchDelete() {
                const delBtn = document.getElementById('deleteMatchBankBtn');
                if (!delBtn) return;
                
                delBtn.addEventListener('click', function(){
                    if (window.selectedMatchBank === DEFAULT_MATCH_BANK.name) {
                        log('é»˜è®¤é¢˜ç›®åŒ¹é…åº“ä¸èƒ½åˆ é™¤', 'error');
                        alert('é»˜è®¤é¢˜ç›®åŒ¹é…åº“ä¸èƒ½åˆ é™¤ï¼Œå¦‚éœ€åˆ é™¤è¯·å…ˆåˆ›å»ºå…¶ä»–é¢˜åº“ã€‚');
                        return;
                    }

                    const bankCount = Object.keys(window.matchQuestionBanks).length;
                    if (bankCount === 0) {
                        log('æ²¡æœ‰é¢˜ç›®åŒ¹é…åº“å¯åˆ é™¤', 'error');
                        alert('å½“å‰æ²¡æœ‰é¢˜ç›®åŒ¹é…åº“ï¼Œè¯·å…ˆåˆ›å»ºæˆ–å¯¼å…¥é¢˜åº“ã€‚');
                        return;
                    }
                    
                    if (bankCount <= 1) {
                        log('ä¸èƒ½åˆ é™¤æœ€åä¸€ä¸ªé¢˜ç›®åŒ¹é…åº“', 'warning');
                        alert('ä¸èƒ½åˆ é™¤æœ€åä¸€ä¸ªé¢˜ç›®åŒ¹é…åº“ï¼Œè¯·è‡³å°‘ä¿ç•™ä¸€ä¸ªé¢˜åº“ã€‚');
                        return;
                    }
                    
                    window.matchBankToDelete = window.selectedMatchBank;
                    document.getElementById('deleteMatchBankNameDisplay').textContent = window.matchBankToDelete;
                    document.getElementById('deleteMatchBankNameCopy').textContent = window.matchBankToDelete;
                    document.getElementById('confirmMatchDeleteInput').value = '';
                    document.getElementById('confirmMatchDeleteBtn').disabled = true;
                    document.getElementById('deleteMatchConfirmModal').style.display = 'flex';
                });
            }

            function exportMatchBank() {
                const bank = window.matchQuestionBanks[window.selectedMatchBank];
                if (!bank) return;
                const dataStr = JSON.stringify(bank, null, 2);
                const blob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${bank.name || 'match_bank'}.json`;
                a.click();
                URL.revokeObjectURL(url);
                log(`âœ… é¢˜ç›®åŒ¹é…åº“å·²å¯¼å‡º`, 'success');
            }

            function importMatchBank() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json,application/json';
                input.onchange = function(e) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = function(ev) {
                        try {
                            const bank = JSON.parse(ev.target.result);
                            if (bank.name && bank.answers && typeof bank.answers === 'object') {
                                window.matchQuestionBanks[bank.name] = bank;
                                saveMatchBanks();
                                window.selectedMatchBank = bank.name;
                                updateMatchBankSelect();
                                updateMatchBankPreview();
                                const total = Object.keys(bank.answers).length;
                                log(`ğŸ“¥ å¯¼å…¥é¢˜ç›®åŒ¹é…åº“: ${bank.name} (${total}é¢˜)`, 'success');
                                updateMatchCheckboxState();
                            } else {
                                alert('æ— æ•ˆçš„é¢˜åº“æ–‡ä»¶ï¼šç¼ºå°‘ name æˆ– answers å¯¹è±¡');
                            }
                        } catch(ex) {
                            alert('è§£æå¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶æ ¼å¼');
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            }

            function showMatchBankInfo() {
                const bank = window.matchQuestionBanks[window.selectedMatchBank];
                if (!bank) return;
                document.getElementById('infoMatchBankName').textContent = bank.name || window.selectedMatchBank;
                document.getElementById('infoMatchBankDescription').textContent = bank.description || 'æ— æè¿°';
                const total = Object.keys(bank.answers || {}).length;
                const basic = bank.basicInfoCount || 0;
                const valid = Math.max(0, total - basic);
                document.getElementById('infoMatchTotalQuestions').textContent = total;
                document.getElementById('infoMatchBasicQuestions').textContent = basic;
                document.getElementById('infoMatchValidQuestions').textContent = valid;
                document.getElementById('infoMatchStartNumber').textContent = bank.startQuestionNum || 3;
                document.getElementById('matchBankInfoModal').style.display = 'flex';
            }

            function initMatchModule() {
                loadMatchBanks();
                updateMatchBankSelect();
                updateMatchBankPreview();
                
                const cb = document.getElementById('enableQuestionMatch');
                if (cb) {
                    cb.addEventListener('change', function(){
                        if (this.disabled) return;
                        window.matchEnabled = this.checked;  // âœ… ç›´æ¥åŒæ­¥
                        localStorage.setItem('matchEnabledState', this.checked);
                        log(`é¢˜ç›®åŒ¹é…åŠŸèƒ½å·²${this.checked ? 'å¯ç”¨' : 'ç¦ç”¨'}`, 'info');
                    });
                }
                
                updateMatchCheckboxState();

                const closeInfoModalBtn = document.getElementById('closeMatchInfoModalBtn');
                if (closeInfoModalBtn) {
                    closeInfoModalBtn.addEventListener('click', () => {
                        document.getElementById('matchBankInfoModal').style.display = 'none';
                    });
                }
                const closeInfoBtn = document.getElementById('closeMatchInfoBtn');
                if (closeInfoBtn) {
                    closeInfoBtn.addEventListener('click', () => {
                        document.getElementById('matchBankInfoModal').style.display = 'none';
                    });
                }

                document.getElementById('addMatchBankBtn')?.addEventListener('click', () => openMatchBankEditor(false));
                document.getElementById('editMatchBankBtn')?.addEventListener('click', () => openMatchBankEditor(true));
                document.getElementById('saveMatchBankBtn')?.addEventListener('click', saveMatchBank);
                document.getElementById('closeMatchModalBtn')?.addEventListener('click', () => document.getElementById('matchBankEditorModal').style.display = 'none');
                document.getElementById('cancelMatchEditBtn')?.addEventListener('click', () => document.getElementById('matchBankEditorModal').style.display = 'none');
                document.getElementById('exportMatchBankBtn')?.addEventListener('click', exportMatchBank);
                document.getElementById('importMatchBankBtn')?.addEventListener('click', importMatchBank);
                document.getElementById('infoMatchBankBtn')?.addEventListener('click', showMatchBankInfo);
                document.getElementById('matchBankSelect')?.addEventListener('change', function(e) {
                    window.selectedMatchBank = e.target.value;
                    updateMatchBankPreview();
                });
                setupMatchDelete();
                document.getElementById('closeMatchDeleteModalBtn')?.addEventListener('click', () => document.getElementById('deleteMatchConfirmModal').style.display = 'none');
                document.getElementById('cancelMatchDeleteBtn')?.addEventListener('click', () => document.getElementById('deleteMatchConfirmModal').style.display = 'none');
                document.getElementById('confirmMatchDeleteBtn')?.addEventListener('click', function() {
                    const name = window.matchBankToDelete;
                    if (name && window.matchQuestionBanks[name]) {
                        delete window.matchQuestionBanks[name];
                        saveMatchBanks();
                        window.selectedMatchBank = Object.keys(window.matchQuestionBanks)[0] || null;
                        updateMatchBankSelect();
                        updateMatchBankPreview();
                        log(`ğŸ—‘ï¸ å·²åˆ é™¤é¢˜ç›®åŒ¹é…åº“: ${name}`, 'success');
                        updateMatchCheckboxState();
                    }
                    document.getElementById('deleteMatchConfirmModal').style.display = 'none';
                });
                document.getElementById('confirmMatchDeleteInput')?.addEventListener('input', function() {
                    const btn = document.getElementById('confirmMatchDeleteBtn');
                    btn.disabled = this.value.trim() !== window.matchBankToDelete;
                    btn.style.opacity = btn.disabled ? '0.5' : '1';
                    btn.style.cursor = btn.disabled ? 'not-allowed' : 'pointer';
                });
                document.getElementById('matchBankContentTextarea')?.addEventListener('input', updateMatchLineCount);
            }

            // å¯åŠ¨æ¨¡å—
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initMatchModule);
            } else {
                initMatchModule();
            }
        })();
        // ==================== é¢˜ç›®åŒ¹é…ç‹¬ç«‹æ¨¡å—ç»“æŸ ====================
    </script>
</body>
</html>